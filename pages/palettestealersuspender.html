<!DOCTYPE html>
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width" />

	<title>PalettestealerSuspender</title>

	<link rel="stylesheet" href="http://blog.macuyiko.com/theme/css/normalize.css" />
	<link rel="stylesheet" href="http://blog.macuyiko.com/theme/css/foundation.min.css" />
	<link rel="stylesheet" href="http://blog.macuyiko.com/theme/css/style.css" />
	<link rel="stylesheet" href="http://blog.macuyiko.com/theme/css/pygments.css" />	
	<script src="http://blog.macuyiko.com/theme/js/jquery-2.0.3.min.js"></script>
	<script src="http://blog.macuyiko.com/theme/js/custom.modernizr.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Roboto+Slab:400,700|Open+Sans|Source+Code+Pro:400,500' rel='stylesheet' type='text/css'>
	
	<script type="text/javascript">
	var waitForFinalEvent = (function () {
		var timers = {};
		return function (callback, ms, uniqueId) {
			if (!uniqueId) uniqueId = "_";
			if (timers[uniqueId]) clearTimeout (timers[uniqueId]);
			timers[uniqueId] = setTimeout(callback, ms);
		};
	})();
	var insertCaptions = function() {
		$('#articlecontainer .caption').remove();
		var width = $(window).width();
		var onmobile = width < 960; //>
		var capclass = onmobile ? 'caption-below' : 'caption-aside';
		$.each($('#articlecontainer img'), function(index, value) {
			if ($(value).attr('alt') != undefined) {
				var elem = $('<div class="caption '+capclass+'">'+$(value).attr('alt')+'</div>');
				if (onmobile) elem.insertAfter(value);
				else elem.insertBefore(value);
			}
		});
	};
	$(function() {
		$(window).resize(function () {
			waitForFinalEvent(function(){
				insertCaptions();
			}, 500, "window.resize");
		});
		insertCaptions();
	});
	</script>
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-60406-11']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>
</head>

<body>

<nav>
	<div class="top-bar large-12 columns">
		<h1><a href="http://blog.macuyiko.com/">Bed Against The Wall</a></h1>
	</div>
</nav>


<div class="row contentwrapper">
	<div class="row">
        
    <div style="margin-bottom: 0.5em;" class="article-title"><a href="http://blog.macuyiko.com/pages/palettestealersuspender.html" rel="bookmark"
		title="Permalink to PalettestealerSuspender">PalettestealerSuspender</a></div>
    <p>A tool to prevent color problems in old Directdraw games PalettestealerSuspender is a launcher tool which allows you to play Directdraw games in fullscreen on Windows Vista and Windows 7 without color&nbsp;problems.</p>
<p>See <a href="http://blog.macuyiko.com/post/2009/solving-color-problem-red-grass-purple-water-in-age-of-empires-2-age-of-kings-the-conquerors-and-others-too-on-vista-and-windows-7.html">this post</a> for a full description of the problem and&nbsp;solutions.</p>
<h2>Changelog</h2>
<ul>
<li>Update (15-Aug-2012): A new update for the PalettestealerSuspender program is up. This release tries to fix some common &#8220;black screen after game exit&#8221; and other problems people have reported. Updated version can be downloaded from normal link&nbsp;below.</li>
<li>Update (30-Jul-2011): A new update for the PalettestealerSuspender program is up. This release brings some significant <span class="caps">UI</span> changes. The tool now loads and saves settings and hides to the notification area so it can run and monitor games in the background. I&#8217;ve restructured theÂ accompanyingÂ blog post to move program instructions to a separate page (this&nbsp;one).</li>
<li>Update (24-Apr-2011): A new update for the PalettestealerSuspender program is up. This release fixes some bugs, and adds the ability to use the program in &#8220;batch/console&#8221;-mode. The readme contains usage&nbsp;details.</li>
<li>Update (08-Sep-2010): I&#8217;ve added explanation for the new registry method (see comment). Also added a link to Jari Komppa&#8217;s Ddraw&nbsp;implementation.</li>
<li>Update (18-Apr-2010): A new version of the program is up. This version includes the ability to wait for a game until it is started instead of starting the game itself. This is useful when using launchers or lobby programs like Garena which start the game for&nbsp;you.</li>
<li>Update (27-Mar-2010): I&#8217;ve added a new version of the program which fixes the &#8220;<span class="caps">CD</span> not found&#8221;-issue when using patch 1.0c for The Conquerors. Turns out the working directory for the executable should be set to &#8220;C:\Install Path\Age Of Empires 2&#8221; and not C:\Install Path\Age Of Empires&nbsp;2\age2_x1&#8221;.</li>
<li>Update (7-Feb-2010): I&#8217;ve added a new version of the program to fix a minor error which caused an exception to appear when starting the game in some rare cases. Download link still&nbsp;below.</li>
</ul>
<h2>Download</h2>
<ul>
<li><a href="http://static.macuyiko.com/files/palettestealersuspender/PalettestealerSuspender.zip">Download zipped binary</a> (Requires .<span class="caps">NET</span> 3.0 or higher. <strong>Last updated at 15-Aug-2012</strong>.)</li>
<li><a href="http://static.macuyiko.com/files/palettestealersuspender/PalettestealerSuspender_old.zip">Download zipped binary of old version</a> (For people preferring the old&nbsp;interface.)</li>
<li><a href="http://static.macuyiko.com/files/palettestealersuspender/PalettestealerSuspender_src.zip">Download source</a> (<span class="caps">VB</span>.<span class="caps">NET</span> 2010&nbsp;project)</li>
</ul>
<p>Works&nbsp;with:</p>
<ul>
<li>Worms&nbsp;Armageddon</li>
<li>Age Of Empires (and Rise Of&nbsp;Rome)</li>
<li>Age Of Empires 2: Age Of Kings (and The&nbsp;Conquerors)</li>
<li>Starcraft (and&nbsp;Broodwar)</li>
<li>Diablo 1 (and&nbsp;expansions)</li>
<li>Diable 2 (and expansions, note that Blizzard fixed the color issue in a recent&nbsp;patch)</li>
<li>Star Wars: Galactic Battlegrounds (fun fact: this game uses the same engine as the Age Of Empires&nbsp;series)</li>
<li>Fallout&nbsp;1</li>
<li>Fallout&nbsp;2</li>
<li>Others&#8230;&nbsp;(?)</li>
</ul>
<h2>Usage (<span class="caps">GUI</span>)</h2>
<h3>Startup</h3>
<p>After opening the program automatically places itself in your notification area and loads your saved settings. Settings are saved in &#8220;save.xml&#8221;; you may delete this file and start the program again to start with a blank slate if you desire to do so. Only one instance of the program can run at&nbsp;once.</p>
<p><img alt="" src="http://2.bp.blogspot.com/-VLzHv-X5Djc/TjQsXJneQdI/AAAAAAAASKU/cHYP61EQK9M/s1600/pss_jul11_01.png"></p>
<p>The program places itself in your Windows notification area after starting&nbsp;it.</p>
<h3>Right click menu Right clicking the notification area icon brings up a menu with the following&nbsp;options:</h3>
<ul>
<li>Games: this menu will subdivide itself into a list of games. When starting the program for the first time, no games will be present. For each game added, a (un)checkable entry will appear, together with an option to start a game&nbsp;manually.</li>
<li>Configure&#8230;: this menu item brings up the configuration screen, where you can add games and manage settings. Double clicking the icon has the same&nbsp;effect.</li>
<li>Quit: exits the program&nbsp;completely.</li>
</ul>
<p><img alt="" src="http://1.bp.blogspot.com/-JuRDOH6-_Vg/TjQsgcFDv0I/AAAAAAAASKY/bYoig7INtp0/s1600/pss_jul11_02.png"></p>
<p>Right-click menu after starting the program for the first&nbsp;time.</p>
<h3>The configuration&nbsp;screen</h3>
<p><img alt="" src="http://3.bp.blogspot.com/-id4e7jpkEp0/TjQsnAbQdwI/AAAAAAAASKc/rHJeTNJfZ8A/s1600/pss_jul11_03.png"></p>
<p>The &#8220;Games&#8221;-menu shows a list of added games. Entries can be checked from this menu to monitor&nbsp;them.</p>
<p>The configuration screen (brought up by choosing &#8220;Configuration&#8230;&#8221; in the right-click menu or double clicking the notification area icon) allows for the&nbsp;following:</p>
<p><img alt="" src="http://1.bp.blogspot.com/-It-L2z-HOkQ/TjQoiyM0D1I/AAAAAAAASKM/XdjrkkNadJk/s1600/pss_jul11_04.png"></p>
<ul>
<li>A list of games: you can add game executables here using the &#8220;Browse&#8230;&#8221; and &#8220;Add&#8221; buttons. Double clicking removes entries from the list. Checking an item denotes that you wish to monitor this particular game (remember that entries can also be checked from the right-click menu). Every change you make to this list will also be reflected in the right-click menu under&nbsp;&#8220;Games&#8221;.</li>
<li>A list of palette stealing processes: which should require no tampering in most cases. Palette stealing processes are automatically detected and added to the list while the configuration screen is active. If the program isn&#8217;t working correctly for you, you might want to leave the configuration screen open while running the game to let new entries appear in this list. By checking and unchecking items you can choose which processes you want to suspend. Note that it is impossible to check or uncheck some&nbsp;processes.</li>
<li>The method to suspend and resume palette stealing programs: in most cases, the recommended option should work well enough. Try the other options in case the program isn&#8217;t&nbsp;working.</li>
<li>Buttons: &#8220;Save and Hide&#8221; saves your settings to &#8220;save.xml&#8221; and hides the program back to the notification area. &#8220;Quit&#8221; completely exits the program and has the same effect as picking &#8220;Quit&#8221; from the right-click menu.Starting and playing&nbsp;games</li>
</ul>
<p>There are two ways to play your games. The first one is to &#8220;manually start&#8221; your games with the right-click menu. PalettestealerSuspender will automatically suspend all palette stealing programs and resume them when exiting the&nbsp;game.</p>
<p><img alt="" src="http://1.bp.blogspot.com/-w5XkFBJJIz8/TjQqMacplPI/AAAAAAAASKQ/wQdoE7ESr1g/s1600/pss_jul11_05.png"></p>
<p>The other way is to let PalettestealerSuspender monitor your list of running processes to see if a game has been started. To allow PalettestealerSuspender to monitor a particular game, check its entry in the configuration screen or through the right-click menu itself. This option provides the most flexibility, as you can just configure a list of games you want to monitor in the configuration screen, make sure they are checked, and then just hide PalettestealerSuspender and forget all about it. It will automatically react when you start a game, while still allowing to &#8220;manually start&#8221; games from the right-click menu as&nbsp;well.</p>
<h2>Usage&nbsp;(Console)</h2>
<p>As of April 2011, the program also contains a console mode, look in &#8220;readme.txt&#8221; for usage&nbsp;instructions.</p>
<h2>License and&nbsp;Disclaimer</h2>
<p>This work is licensed under a Creative Commons Attribution-Share Alike 2.0 Belgium License as stated at&nbsp;http://creativecommons.org/licenses/by-sa/2.0/be/.</p>
<p><span class="caps">THIS</span> <span class="caps">SOFTWARE</span> <span class="caps">IS</span> <span class="caps">PROVIDED</span> &#8220;<span class="caps">AS</span> <span class="caps">IS</span>&#8221; <span class="caps">AND</span> <span class="caps">ANY</span> <span class="caps">EXPRESSED</span> <span class="caps">OR</span> <span class="caps">IMPLIED</span> <span class="caps">WARRANTIES</span>, <span class="caps">INCLUDING</span>, <span class="caps">BUT</span> <span class="caps">NOT</span> <span class="caps">LIMITED</span> <span class="caps">TO</span>, <span class="caps">THE</span> <span class="caps">IMPLIED</span> <span class="caps">WARRANTIES</span> <span class="caps">OF</span> <span class="caps">MERCHANTABILITY</span> <span class="caps">AND</span> <span class="caps">FITNESS</span> <span class="caps">FOR</span> A <span class="caps">PARTICULAR</span> <span class="caps">PURPOSE</span> <span class="caps">ARE</span> <span class="caps">DISCLAIMED</span>. <span class="caps">IN</span> <span class="caps">NO</span> <span class="caps">EVENT</span> <span class="caps">SHALL</span> <span class="caps">THE</span> <span class="caps">REGENTS</span> <span class="caps">OR</span> <span class="caps">CONTRIBUTORS</span> <span class="caps">BE</span> <span class="caps">LIABLE</span> <span class="caps">FOR</span> <span class="caps">ANY</span> <span class="caps">DIRECT</span>, <span class="caps">INDIRECT</span>, <span class="caps">INCIDENTAL</span>, <span class="caps">SPECIAL</span>, <span class="caps">EXEMPLARY</span>, <span class="caps">OR</span> <span class="caps">CONSEQUENTIAL</span> <span class="caps">DAMAGES</span> (<span class="caps">INCLUDING</span>, <span class="caps">BUT</span> <span class="caps">NOT</span> <span class="caps">LIMITED</span> <span class="caps">TO</span>, <span class="caps">PROCUREMENT</span> <span class="caps">OF</span> <span class="caps">SUBSTITUTE</span> <span class="caps">GOODS</span> <span class="caps">OR</span> <span class="caps">SERVICES</span>; <span class="caps">LOSS</span> <span class="caps">OF</span> <span class="caps">USE</span>, <span class="caps">DATA</span>, <span class="caps">OR</span> <span class="caps">PROFITS</span>; <span class="caps">OR</span> <span class="caps">BUSINESS</span> <span class="caps">INTERRUPTION</span>)
<span class="caps">HOWEVER</span> <span class="caps">CAUSED</span> <span class="caps">AND</span> <span class="caps">ON</span> <span class="caps">ANY</span> <span class="caps">THEORY</span> <span class="caps">OF</span> <span class="caps">LIABILITY</span>, <span class="caps">WHETHER</span> <span class="caps">IN</span> <span class="caps">CONTRACT</span>, <span class="caps">STRICT</span> <span class="caps">LIABILITY</span>, <span class="caps">OR</span> <span class="caps">TORT</span> (<span class="caps">INCLUDING</span> <span class="caps">NEGLIGENCE</span> <span class="caps">OR</span> <span class="caps">OTHERWISE</span>) <span class="caps">ARISING</span> <span class="caps">IN</span> <span class="caps">ANY</span> <span class="caps">WAY</span> <span class="caps">OUT</span> <span class="caps">OF</span> <span class="caps">THE</span> <span class="caps">USE</span> <span class="caps">OF</span> <span class="caps">THIS</span> <span class="caps">SOFTWARE</span>, <span class="caps">EVEN</span> <span class="caps">IF</span> <span class="caps">ADVISED</span> <span class="caps">OF</span> <span class="caps">THE</span> <span class="caps">POSSIBILITY</span> <span class="caps">OF</span> <span class="caps">SUCH</span> <span class="caps">DAMAGE</span>.</p>
		
	</div>

	<footer class="row">
		<div class="large-12 columns">
			<hr />
			<div class="row">
				<p>Bed Against The Wall by Seppe "Macuyiko" vanden Broucke</p>
				<p><a href="http://creativecommons.org/licenses/by-sa/2.0/be/" rel="license"><img title="Creative Commons License" src="http://i.creativecommons.org/l/by-sa/2.0/be/88x31.png" /></a><br />
				Unless mentioned otherwise, this work is licensed under a <a href="http://creativecommons.org/licenses/by-sa/2.0/be/" rel="license">Creative Commons Attribution-Share Alike 2.0 Belgium License</a>.</p>
				<p>Static blog engine powered by <a href="http://getpelican.com">Pelican</a>.</p>
			</div>
		</div>
	</footer>
</div>
 