<!DOCTYPE html>
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width" />

	<title>Converting Plain Text References To BibTeX (or Endnote, or…)</title>

	<link rel="stylesheet" href="//blog.macuyiko.com/theme/css/normalize.css" />
	<link rel="stylesheet" href="//blog.macuyiko.com/theme/css/foundation.min.css" />
	<link rel="stylesheet" href="//blog.macuyiko.com/theme/css/style.css" />
	<link rel="stylesheet" href="//blog.macuyiko.com/theme/css/pygments.css" />	
	<script src="//blog.macuyiko.com/theme/js/jquery-3.4.1.min.js"></script>
	<link href="https://fonts.googleapis.com/css?family=Bitter:400,700|Source+Code+Pro&display=swap" rel="stylesheet">

	<script type="text/javascript">
	var waitForFinalEvent = (function () {
		var timers = {};
		return function (callback, ms, uniqueId) {
			if (!uniqueId) uniqueId = "_";
			if (timers[uniqueId]) clearTimeout (timers[uniqueId]);
			timers[uniqueId] = setTimeout(callback, ms);
		};
	})();
	var insertCaptions = function() {
		$('#articlecontainer .caption').remove();
		var width = $(window).width();
		var onmobile = width < 1400; //>
		var capclass = onmobile ? 'caption-below' : 'caption-aside';
		$.each($('#articlecontainer img'), function(index, value) {
			if ($(value).attr('alt') != undefined) {
				var elem = $('<div class="caption '+capclass+'">'+$(value).attr('alt')+'</div>');
				if (onmobile) elem.insertAfter(value);
				else elem.insertBefore(value);
			}
		});
	};
	$(function() {
		$(window).resize(function () {
			waitForFinalEvent(function(){
				insertCaptions();
			}, 500, "window.resize");
		});
		insertCaptions();
	});
	</script>
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-60406-11']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>
</head>

<body>

<nav>
	<div class="top-bar large-12 columns">
		<h1><a href="//blog.macuyiko.com/">Bed Against The Wall</a></h1>
	</div>
</nav>


<div class="row contentwrapper">
	<div class="row">
<div id="articlecontainer" class="large-9 columns large-centered">
	<article>
		<header>
			<div class="article-info">Wed 26 February 2014, by Seppe "Macuyiko" vanden Broucke</div>
			<div class="article-title"><a href="//blog.macuyiko.com/post/2014/converting-plain-text-references-to-bibtex-or-endnote-or.html" rel="bookmark"
			title="Permalink to Converting Plain Text References To BibTeX (or Endnote, or…)">Converting Plain Text References To BibTeX (or Endnote,&nbsp;or&#8230;)</a></div>
		</header>
	
	    <p><strong>Update:</strong> <a href="//blog.macuyiko.com/post/2016/converting-plain-text-references-to-bibtex-updated.html">new post and source code here</a>.</p>
<p>So last weekend, I&#8217;d almost finished editing a Word manuscript draft to submit to a particular journal, except for one final item on the todo list: converting the existing list of references (inserted and formatted as a plain text list) to another&nbsp;style.</p>
<p>I planned on using Word&#8217;s built-in reference manager to add all 40+ references to the bibliography, but even in Word&#8217;s latest incarnation, the &#8220;Here are 20 text boxes squished together, have fun!&#8221;-interface remains a pain to&nbsp;use.</p>
<p>So then, switching to BibTeX first. This involves hunting down BibTeX entries for all references, putting them in a tool like <a href="http://jabref.sourceforge.net/">Jabref</a>, and then exporting the list to a &#8212; properly formatted &#8212; plain text list, which can be pasted back into&nbsp;Word.</p>
<p>After doing this for three or so reference entries, feelings of boredom and frustration welled up inside me, and my mind drifted off pondering the greater questions of&nbsp;life&#8230;</p>
<blockquote>
<p>Are we alone in the universe?
&#8230;
Is there a god?
&#8230;
Why can&#8217;t I convert a list of plain text references to a BibTeX list&nbsp;automatically?</p>
</blockquote>
<p>The latter questions really isn&#8217;t that ridiculous. With sources like <span class="caps">DBLP</span> and Web of Science allowing plain text search, it shouldn&#8217;t be too hard to automagically get this task done,&nbsp;right?</p>
<p>So I had a look at Endnote. Quote <a href="http://kbportal.thomson.com/display/2/searchDirect/index.aspx?searchstring=TS_ENIMPORTFAQ8&amp;searchtype=8&amp;searchby=referenceword&amp;Catid=&amp;SubCatid=&amp;att=&amp;remotesite=&amp;search=">this page</a>:</p>
<blockquote>
<p>EndNote: Cannot import bibliography not created with EndNote
Unfortunately, EndNote was not designed to import information in a bibliography format. EndNote can import text files that are in a tagged data format, as well as tab-delimited files that are in the exact right format.
Some customers have had success at converting an existing text file into a tagged data file that can be imported into EndNote, however the process is difficult and may take more time than finding another source for the references, or even copying and pasting the text into new references by hand. More information on preparing text files for importing can be found in the &#8220;Importing Reference Data&#8221; section of the Help&nbsp;File.</p>
</blockquote>
<p>That&#8217;s just great. One of these &#8220;some customers&#8221; can be found at <a href="http://deborahfitchett.blogspot.be/2011/02/converting-plaintext-bibliography-to.html">this blog</a>&#8230; Ten steps, including a bunch of arcane editing and Linux commands&#8230; There has to be a better way. If Mendeley can parse information from a <span class="caps">PDF</span> (not perfect, but still), a plain text reference list should be convertable to a BibTeX entry,&nbsp;right?</p>
<p>So instead of spending two hours creating a BibTeX file manually, I spent two days coming up with some automatic&nbsp;way.</p>
<h2>Hour 1: Finding a&nbsp;Source</h2>
<p>The first hour of this experiment was spent finding a literature corpus source where I&#8217;d be able to download a structured reference file from. Web of Science looks like a good candidate, but their website is hellish to parse, requires juggling with cookies and viewstates, and going through my university&#8217;s proxy to gain access, something I&#8217;ve all experimented with in the past and didn&#8217;t want to go through&nbsp;again.</p>
<p>Next possibility: Google Scholar. A few test runs with some edited queries came up with the right articles alright, and Google Scholar allows to export Endnote, BibTeX and other files. Even though the quality of the entry is not always perfect, this seemed like a good starting&nbsp;point.</p>
<h2>Hours 2-3: Finding an <span class="caps">API</span></h2>
<p>First issue: Google Scholar does not provide an <span class="caps">API</span>. Luckily, there&#8217;s <code>scholar.py</code> on <a href="https://github.com/ckreibich/scholar.py">GitHub</a> which seems to be working fine (as long as you don&#8217;t hammer Google&#8217;s servers too&nbsp;much):</p>
<div class="highlight"><pre><span></span><span class="n">macuyiko$</span> <span class="n">python</span> <span class="n">scholar</span><span class="p">.</span><span class="n">py</span> <span class="o">-</span><span class="k">c</span> <span class="mi">3</span> <span class="c1">--author &quot;vanden broucke&quot; --txt &quot;artificial&quot;</span>
            <span class="n">ID</span> <span class="n">PktWS3Llix8J</span>
         <span class="n">Title</span> <span class="n">Improved</span> <span class="n">artificial</span> <span class="n">negative</span> <span class="n">event</span> <span class="n">generation</span> <span class="k">to</span> <span class="n">enhance</span> <span class="n">process</span> <span class="n">event</span> <span class="n">logs</span>
           <span class="n">URL</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">link</span><span class="p">.</span><span class="n">springer</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">chapter</span><span class="o">/</span><span class="mi">10</span><span class="p">.</span><span class="mi">1007</span><span class="o">/</span><span class="mi">978</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="mi">642</span><span class="o">-</span><span class="mi">31095</span><span class="o">-</span><span class="mi">9</span><span class="n">_17</span>
     <span class="n">Citations</span> <span class="mi">4</span>
      <span class="n">Versions</span> <span class="mi">5</span>
<span class="n">Citations</span> <span class="n">list</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">scholar</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">scholar</span><span class="o">?</span><span class="n">cites</span><span class="o">=</span><span class="mi">2273162715991526206</span><span class="o">&amp;</span><span class="n">as_sdt</span><span class="o">=</span><span class="mi">2005</span><span class="o">&amp;</span><span class="n">sciodt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="o">&amp;</span><span class="n">hl</span><span class="o">=</span><span class="n">en</span><span class="o">&amp;</span><span class="n">num</span><span class="o">=</span><span class="mi">3</span>
 <span class="n">Versions</span> <span class="n">list</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">scholar</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">scholar</span><span class="o">?</span><span class="k">cluster</span><span class="o">=</span><span class="mi">2273162715991526206</span><span class="o">&amp;</span><span class="n">hl</span><span class="o">=</span><span class="n">en</span><span class="o">&amp;</span><span class="n">num</span><span class="o">=</span><span class="mi">3</span><span class="o">&amp;</span><span class="n">as_sdt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span>
      <span class="n">Cite</span> <span class="n">URL</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">scholar</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">scholar</span><span class="o">?</span><span class="n">q</span><span class="o">=</span><span class="n">info</span><span class="p">:</span><span class="n">PktWS3Llix8J</span><span class="p">:</span><span class="n">scholar</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span><span class="o">/&amp;</span><span class="k">output</span><span class="o">=</span><span class="n">cite</span><span class="o">&amp;</span><span class="n">scirp</span><span class="o">=</span><span class="mi">0</span><span class="o">&amp;</span><span class="n">hl</span><span class="o">=</span><span class="n">en</span>
  <span class="n">Related</span> <span class="n">list</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">scholar</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">scholar</span><span class="o">?</span><span class="n">q</span><span class="o">=</span><span class="n">related</span><span class="p">:</span><span class="n">PktWS3Llix8J</span><span class="p">:</span><span class="n">scholar</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span><span class="o">/&amp;</span><span class="n">hl</span><span class="o">=</span><span class="n">en</span><span class="o">&amp;</span><span class="n">num</span><span class="o">=</span><span class="mi">3</span><span class="o">&amp;</span><span class="n">as_sdt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span>
          <span class="k">Year</span> <span class="mi">2012</span>

            <span class="n">ID</span> <span class="mi">1</span><span class="n">_9CU_</span><span class="o">-</span><span class="n">bcNEJ</span>
         <span class="n">Title</span> <span class="n">An</span> <span class="n">Improved</span> <span class="n">Process</span> <span class="n">Event</span> <span class="n">Log</span> <span class="n">Artificial</span> <span class="n">Negative</span> <span class="n">Event</span> <span class="n">Generator</span>
           <span class="n">URL</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">papers</span><span class="p">.</span><span class="n">ssrn</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">sol3</span><span class="o">/</span><span class="n">papers</span><span class="p">.</span><span class="n">cfm</span><span class="o">?</span><span class="n">abstract_id</span><span class="o">=</span><span class="mi">2165204</span>
     <span class="n">Citations</span> <span class="mi">0</span>
      <span class="n">Versions</span> <span class="mi">0</span>
<span class="n">Citations</span> <span class="n">list</span> <span class="k">None</span>
 <span class="n">Versions</span> <span class="n">list</span> <span class="k">None</span>
      <span class="n">Cite</span> <span class="n">URL</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">scholar</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">scholar</span><span class="o">?</span><span class="n">q</span><span class="o">=</span><span class="n">info</span><span class="p">:</span><span class="mi">1</span><span class="n">_9CU_</span><span class="o">-</span><span class="n">bcNEJ</span><span class="p">:</span><span class="n">scholar</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span><span class="o">/&amp;</span><span class="k">output</span><span class="o">=</span><span class="n">cite</span><span class="o">&amp;</span><span class="n">scirp</span><span class="o">=</span><span class="mi">0</span><span class="o">&amp;</span><span class="n">hl</span><span class="o">=</span><span class="n">en</span>
  <span class="n">Related</span> <span class="n">list</span> <span class="k">None</span>
          <span class="k">Year</span> <span class="mi">2012</span>

            <span class="n">ID</span> <span class="n">EE_4eP8NmncJ</span>
         <span class="n">Title</span> <span class="n">Third</span> <span class="n">International</span> <span class="n">Business</span> <span class="n">Process</span> <span class="n">Intelligence</span> <span class="n">Challenge</span> <span class="p">(</span><span class="n">BPIC</span><span class="err">&#39;</span><span class="mi">13</span><span class="p">):</span> <span class="n">Volvo</span> <span class="n">IT</span> <span class="n">Belgium</span> <span class="n">VINST</span>
           <span class="n">URL</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ceur</span><span class="o">-</span><span class="n">ws</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">Vol</span><span class="o">-</span><span class="mi">1052</span><span class="o">/</span><span class="n">paper3</span><span class="p">.</span><span class="n">pdf</span>
     <span class="n">Citations</span> <span class="mi">0</span>
      <span class="n">Versions</span> <span class="mi">0</span>
<span class="n">Citations</span> <span class="n">list</span> <span class="k">None</span>
 <span class="n">Versions</span> <span class="n">list</span> <span class="k">None</span>
      <span class="n">Cite</span> <span class="n">URL</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">scholar</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">scholar</span><span class="o">?</span><span class="n">q</span><span class="o">=</span><span class="n">info</span><span class="p">:</span><span class="n">EE_4eP8NmncJ</span><span class="p">:</span><span class="n">scholar</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span><span class="o">/&amp;</span><span class="k">output</span><span class="o">=</span><span class="n">cite</span><span class="o">&amp;</span><span class="n">scirp</span><span class="o">=</span><span class="mi">0</span><span class="o">&amp;</span><span class="n">hl</span><span class="o">=</span><span class="n">en</span>
  <span class="n">Related</span> <span class="n">list</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">scholar</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">scholar</span><span class="o">?</span><span class="n">q</span><span class="o">=</span><span class="n">related</span><span class="p">:</span><span class="n">EE_4eP8NmncJ</span><span class="p">:</span><span class="n">scholar</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span><span class="o">/&amp;</span><span class="n">hl</span><span class="o">=</span><span class="n">en</span><span class="o">&amp;</span><span class="n">num</span><span class="o">=</span><span class="mi">3</span><span class="o">&amp;</span><span class="n">as_sdt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span>
          <span class="k">Year</span> <span class="k">None</span>
</pre></div>


<h2>Hours 4-5: Getting Citation&nbsp;Results</h2>
<p>Second issue, <code>scholar.py</code> does not provide support to retrieve citation entries from Google Scholar (i.e. what you see when you click the &#8220;Cite&#8221; link under an&nbsp;article).</p>
<p>Getting this information is a little bit tricky, because we first have to retrieve the Google Scholar <span class="caps">ID</span> for the article, and then perform a second <span class="caps">HTTP</span> request using a unique token in the <span class="caps">URL</span>. I&#8217;ve modified <code>scholar.py</code> to look as follows (now also using the <code>requests</code> library instead of the whole <code>urllib</code> soup:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="c1"># Copyright 2010--2013 Christian Kreibich. All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are</span>
<span class="c1"># met:</span>
<span class="c1">#</span>
<span class="c1">#   1. Redistributions of source code must retain the above copyright</span>
<span class="c1">#      notice, this list of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1">#   2. Redistributions in binary form must reproduce the above</span>
<span class="c1">#      copyright notice, this list of conditions and the following</span>
<span class="c1">#      disclaimer in the documentation and/or other materials provided</span>
<span class="c1">#      with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED</span>
<span class="c1"># WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF</span>
<span class="c1"># MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE AUTHORS BE LIABLE FOR ANY DIRECT,</span>
<span class="c1"># INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span>
<span class="c1"># (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span>
<span class="c1"># HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,</span>
<span class="c1"># STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING</span>
<span class="c1"># IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</span>
<span class="c1"># POSSIBILITY OF SUCH DAMAGE.</span>

<span class="kn">import</span> <span class="nn">optparse</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">codecs</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">quote</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">quote</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="c1"># Import BeautifulSoup -- try 4 first, fall back to older</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">BeautifulSoup</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;We need BeautifulSoup, sorry...&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Support unicode in both Python 2 and 3. In Python 3, unicode is str.</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
    <span class="nb">unicode</span> <span class="o">=</span> <span class="nb">str</span> <span class="c1"># pylint: disable-msg=W0622</span>
    <span class="n">encode</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span> <span class="c1"># pylint: disable-msg=C0103</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">encode</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="c1"># pylint: disable-msg=C0103</span>

<span class="k">class</span> <span class="nc">CookieJar</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">COOKIE_JAR</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">class</span> <span class="nc">Article</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span>            <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;ID&#39;</span><span class="p">,</span>              <span class="mi">0</span><span class="p">],</span>
                      <span class="s1">&#39;title&#39;</span><span class="p">:</span>         <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;Title&#39;</span><span class="p">,</span>           <span class="mi">1</span><span class="p">],</span>
                      <span class="s1">&#39;url&#39;</span><span class="p">:</span>           <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;URL&#39;</span><span class="p">,</span>             <span class="mi">2</span><span class="p">],</span>
                      <span class="s1">&#39;num_citations&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span>    <span class="s1">&#39;Citations&#39;</span><span class="p">,</span>       <span class="mi">3</span><span class="p">],</span>
                      <span class="s1">&#39;num_versions&#39;</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span><span class="p">,</span>    <span class="s1">&#39;Versions&#39;</span><span class="p">,</span>        <span class="mi">4</span><span class="p">],</span>
                      <span class="s1">&#39;url_citations&#39;</span><span class="p">:</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;Citations list&#39;</span><span class="p">,</span>  <span class="mi">5</span><span class="p">],</span>
                      <span class="s1">&#39;url_versions&#39;</span><span class="p">:</span>  <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;Versions list&#39;</span><span class="p">,</span>   <span class="mi">6</span><span class="p">],</span>
                      <span class="s1">&#39;url_cite&#39;</span><span class="p">:</span>      <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;Cite URL&#39;</span><span class="p">,</span>        <span class="mi">7</span><span class="p">],</span>
                      <span class="s1">&#39;url_related&#39;</span><span class="p">:</span>   <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;Related list&#39;</span><span class="p">,</span>    <span class="mi">8</span><span class="p">],</span>
                      <span class="s1">&#39;year&#39;</span><span class="p">:</span>          <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span>            <span class="mi">9</span><span class="p">]}</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">)]</span>

    <span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">as_txt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Get items sorted in specified order:</span>
        <span class="n">items</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">item</span><span class="p">:</span> <span class="n">item</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="c1"># Find largest label length:</span>
        <span class="n">max_label_len</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">])</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%%%d</span><span class="s1">s </span><span class="si">%%</span><span class="s1">s&#39;</span> <span class="o">%</span> <span class="n">max_label_len</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">fmt</span> <span class="o">%</span> <span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">as_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;|&#39;</span><span class="p">):</span>
        <span class="c1"># Get keys sorted in specified order:</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> \
                <span class="nb">sorted</span><span class="p">([(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">())],</span>
                       <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">pair</span><span class="p">:</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">header</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">keys</span><span class="p">))</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">unicode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">]))</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ScholarParser</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">SCHOLAR_SITE</span> <span class="o">=</span> <span class="s1">&#39;http://scholar.google.com&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">soup</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">article</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">site</span> <span class="o">=</span> <span class="n">site</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">SCHOLAR_SITE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">year_re</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\b(?:20|19)\d{2}\b&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">handle_article</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">art</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        In this base class, the callback does nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method initiates parsing of HTML content.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">div</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">soup</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="n">ScholarParser</span><span class="o">.</span><span class="n">_tag_checker</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parse_article</span><span class="p">(</span><span class="n">div</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parse_article</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">div</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">article</span> <span class="o">=</span> <span class="n">Article</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">div</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">):</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">tag</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;div&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag_has_class</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="s1">&#39;gs_rt&#39;</span><span class="p">)</span> <span class="ow">and</span> \
                    <span class="n">tag</span><span class="o">.</span><span class="n">h3</span> <span class="ow">and</span> <span class="n">tag</span><span class="o">.</span><span class="n">h3</span><span class="o">.</span><span class="n">a</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">h3</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path2url</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">h3</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="s1">&#39;href&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">tag</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;font&#39;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">tag2</span> <span class="ow">in</span> <span class="n">tag</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tag2</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">):</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="n">tag2</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;span&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag_has_class</span><span class="p">(</span><span class="n">tag2</span><span class="p">,</span> <span class="s1">&#39;gs_fl&#39;</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_links</span><span class="p">(</span><span class="n">tag2</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handle_article</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parse_links</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">span</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">span</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">tag</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;a&#39;</span> <span class="ow">or</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;/scholar?cites&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">tag</span><span class="o">.</span><span class="n">string</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Cited by&#39;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;num_citations&#39;</span><span class="p">]</span> <span class="o">=</span> \
                        <span class="bp">self</span><span class="o">.</span><span class="n">_as_int</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;url_citations&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path2url</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;/scholar?cluster&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">tag</span><span class="o">.</span><span class="n">string</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;All &#39;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;num_versions&#39;</span><span class="p">]</span> <span class="o">=</span> \
                        <span class="bp">self</span><span class="o">.</span><span class="n">_as_int</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;url_versions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path2url</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_tag_has_class</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">klass</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This predicate function checks whether a BeatifulSoup Tag instance</span>
<span class="sd">        has a class attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
            <span class="c1"># BeautifulSoup 3 can return e.g. &#39;gs_md_wp gs_ttss&#39;,</span>
            <span class="c1"># so split -- conveniently produces a list in any case</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">klass</span> <span class="ow">in</span> <span class="n">res</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_tag_checker</span><span class="p">(</span><span class="n">tag</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tag</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;div&#39;</span> <span class="ow">and</span> <span class="n">ScholarParser</span><span class="o">.</span><span class="n">_tag_has_class</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="s1">&#39;gs_r&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_as_int</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">_path2url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;http://&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">path</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">path</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">site</span> <span class="o">+</span> <span class="n">path</span>


<span class="k">class</span> <span class="nc">ScholarParser120201</span><span class="p">(</span><span class="n">ScholarParser</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_parse_article</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">div</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">article</span> <span class="o">=</span> <span class="n">Article</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">div</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">):</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">tag</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;h3&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag_has_class</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="s1">&#39;gs_rt&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">tag</span><span class="o">.</span><span class="n">a</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path2url</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="s1">&#39;href&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">tag</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;div&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag_has_class</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="s1">&#39;gs_a&#39;</span><span class="p">):</span>
                <span class="n">year</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">year_re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">year</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">None</span>

            <span class="k">if</span> <span class="n">tag</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;div&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag_has_class</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="s1">&#39;gs_fl&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_parse_links</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handle_article</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">ScholarParser120726</span><span class="p">(</span><span class="n">ScholarParser</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_parse_article</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">div</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">article</span> <span class="o">=</span> <span class="n">Article</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">div</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">tag</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;div&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag_has_class</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="s1">&#39;gs_ri&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">tag</span><span class="o">.</span><span class="n">a</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path2url</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="s1">&#39;href&#39;</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">tag</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;gs_a&#39;</span><span class="p">}):</span>
                    <span class="n">year</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">year_re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;gs_a&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">year</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">None</span>

                <span class="k">if</span> <span class="n">tag</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;gs_fl&#39;</span><span class="p">}):</span>
                    <span class="n">ltag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;gs_fl&#39;</span><span class="p">})</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_parse_links</span><span class="p">(</span><span class="n">ltag</span><span class="p">)</span>

                    <span class="n">id_re</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;gs_ocit\(event,</span><span class="se">\&#39;</span><span class="s1">(.*?)</span><span class="se">\&#39;</span><span class="s1">,&#39;</span><span class="p">)</span>
                    <span class="nb">id</span> <span class="o">=</span> <span class="n">id_re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ltag</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">id</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">None</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;url_cite&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path2url</span><span class="p">(</span><span class="s1">&#39;/scholar?q=info:&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;:scholar.google.com/&amp;output=cite&amp;scirp=0&amp;hl=en&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handle_article</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parse_links</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">span</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">span</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">tag</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;a&#39;</span> <span class="ow">or</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;/scholar?q=related&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;url_related&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path2url</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;/scholar?cites&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">tag</span><span class="o">.</span><span class="n">string</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Cited by&#39;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;num_citations&#39;</span><span class="p">]</span> <span class="o">=</span> \
                        <span class="bp">self</span><span class="o">.</span><span class="n">_as_int</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;url_citations&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path2url</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;/scholar?cluster&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">tag</span><span class="o">.</span><span class="n">string</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;All &#39;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;num_versions&#39;</span><span class="p">]</span> <span class="o">=</span> \
                        <span class="bp">self</span><span class="o">.</span><span class="n">_as_int</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;url_versions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path2url</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">CiteParser</span><span class="p">(</span><span class="n">ScholarParser</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">site</span> <span class="o">=</span> <span class="n">site</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">SCHOLAR_SITE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">soup</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">export</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method initiates parsing of HTML content.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;gs_citt&quot;</span><span class="p">}))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_export</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;gs_citi&quot;</span><span class="p">}))</span>

    <span class="k">def</span> <span class="nf">_parse_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">div</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">div</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="n">tag</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;th&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">]</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

    <span class="k">def</span> <span class="nf">_parse_export</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">div</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">div</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">tag</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;a&#39;</span> <span class="ow">or</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;/scholar&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">tag</span><span class="o">.</span><span class="n">string</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Import into&#39;</span><span class="p">):</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">export</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path2url</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">ScholarQuerier</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">SCHOLAR_URL</span> <span class="o">=</span> <span class="s1">&#39;http://scholar.google.be/scholar?hl=en&amp;q=</span><span class="si">%(query)s</span><span class="s1">+author:</span><span class="si">%(author)s</span><span class="s1">&amp;btnG=Search&amp;as_subj=eng&amp;as_sdt=1,5&amp;as_ylo=&amp;as_vis=0&#39;</span>
    <span class="n">NOAUTH_URL</span> <span class="o">=</span> <span class="s1">&#39;http://scholar.google.be/scholar?hl=en&amp;q=</span><span class="si">%(query)s</span><span class="s1">&amp;btnG=Search&amp;as_subj=eng&amp;as_std=1,5&amp;as_ylo=&amp;as_vis=0&#39;</span>
    <span class="n">USER_AGENT</span> <span class="o">=</span> <span class="s1">&#39;Mozilla/5.0 (Windows NT 6.2; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/32.0.1667.0 Safari/537.36&#39;</span>

    <span class="k">class</span> <span class="nc">Parser</span><span class="p">(</span><span class="n">ScholarParser120726</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">querier</span><span class="p">):</span>
            <span class="n">ScholarParser120726</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">querier</span> <span class="o">=</span> <span class="n">querier</span>

        <span class="k">def</span> <span class="nf">handle_article</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">art</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">querier</span><span class="o">.</span><span class="n">add_article</span><span class="p">(</span><span class="n">art</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">scholar_url</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">articles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">author</span> <span class="o">=</span> <span class="n">author</span>
        <span class="c1"># Clip to 100, as Google doesn&#39;t support more anyway</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">author</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scholar_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NOAUTH_URL</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scholar_url</span> <span class="o">=</span> <span class="n">scholar_url</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">SCHOLAR_URL</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scholar_url</span> <span class="o">+=</span> <span class="s1">&#39;&amp;num=</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span>

    <span class="k">def</span> <span class="nf">query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">search</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_articles</span><span class="p">()</span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scholar_url</span> <span class="o">%</span> <span class="p">{</span><span class="s1">&#39;query&#39;</span><span class="p">:</span> <span class="n">quote</span><span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="n">search</span><span class="p">)),</span> <span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="n">quote</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">author</span><span class="p">)}</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">USER_AGENT</span><span class="p">},</span> <span class="n">cookies</span><span class="o">=</span><span class="n">CookieJar</span><span class="o">.</span><span class="n">COOKIE_JAR</span><span class="p">)</span>
        <span class="n">CookieJar</span><span class="o">.</span><span class="n">COOKIE_JAR</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">cookies</span>
        <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">print</span> <span class="s2">&quot;*** Google is throttling&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">):</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Parser</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_article</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">art</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">articles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">art</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">clear_articles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">articles</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">class</span> <span class="nc">CiteQuerier</span><span class="p">(</span><span class="n">ScholarQuerier</span><span class="p">):</span>
    <span class="n">CITE_URL</span> <span class="o">=</span> <span class="s1">&#39;http://scholar.google.com/scholar?q=info:</span><span class="si">%(id)s</span><span class="s1">:scholar.google.com/&amp;output=cite&amp;scirp=0&amp;hl=en&#39;</span>

    <span class="k">class</span> <span class="nc">Parser</span><span class="p">(</span><span class="n">CiteParser</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">querier</span><span class="p">):</span>
            <span class="n">CiteParser</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">querier</span> <span class="o">=</span> <span class="n">querier</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Parser</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">query</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">url_cite</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CITE_URL</span> <span class="o">%</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">quote</span><span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">))}</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url_cite</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">USER_AGENT</span><span class="p">},</span> <span class="n">cookies</span><span class="o">=</span><span class="n">CookieJar</span><span class="o">.</span><span class="n">COOKIE_JAR</span><span class="p">)</span>
        <span class="n">CookieJar</span><span class="o">.</span><span class="n">COOKIE_JAR</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">cookies</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">cite</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>
    <span class="n">querier</span> <span class="o">=</span> <span class="n">CiteQuerier</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">querier</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">export</span><span class="p">[</span><span class="s1">&#39;EndNote&#39;</span><span class="p">],</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">querier</span><span class="o">.</span><span class="n">USER_AGENT</span><span class="p">},</span> <span class="n">cookies</span><span class="o">=</span><span class="n">CookieJar</span><span class="o">.</span><span class="n">COOKIE_JAR</span><span class="p">)</span>
    <span class="n">myFile</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;end.enw&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
    <span class="n">myFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    <span class="n">myFile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">articles</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">author</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
    <span class="n">querier</span> <span class="o">=</span> <span class="n">ScholarQuerier</span><span class="p">(</span><span class="n">author</span><span class="o">=</span><span class="n">author</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">count</span><span class="p">)</span>
    <span class="n">querier</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="n">articles</span> <span class="o">=</span> <span class="n">querier</span><span class="o">.</span><span class="n">articles</span>
    <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">articles</span> <span class="o">=</span> <span class="n">articles</span><span class="p">[:</span><span class="n">count</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">articles</span>

<span class="k">def</span> <span class="nf">txt</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">author</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
    <span class="n">querier</span> <span class="o">=</span> <span class="n">ScholarQuerier</span><span class="p">(</span><span class="n">author</span><span class="o">=</span><span class="n">author</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">count</span><span class="p">)</span>
    <span class="n">querier</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="n">articles</span> <span class="o">=</span> <span class="n">querier</span><span class="o">.</span><span class="n">articles</span>
    <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">articles</span> <span class="o">=</span> <span class="n">articles</span><span class="p">[:</span><span class="n">count</span><span class="p">]</span>
    <span class="n">c</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">art</span> <span class="ow">in</span> <span class="n">articles</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;------------&#39;</span> <span class="o">+</span> <span class="s1">&#39;Article #&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="s1">&#39;------------&#39;</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">print</span><span class="p">(</span><span class="n">art</span><span class="o">.</span><span class="n">as_txt</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">articles</span>

<span class="k">def</span> <span class="nf">csv</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">author</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;|&#39;</span><span class="p">):</span>
    <span class="n">querier</span> <span class="o">=</span> <span class="n">ScholarQuerier</span><span class="p">(</span><span class="n">author</span><span class="o">=</span><span class="n">author</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">count</span><span class="p">)</span>
    <span class="n">querier</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="n">articles</span> <span class="o">=</span> <span class="n">querier</span><span class="o">.</span><span class="n">articles</span>
    <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">articles</span> <span class="o">=</span> <span class="n">articles</span><span class="p">[:</span><span class="n">count</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">art</span> <span class="ow">in</span> <span class="n">articles</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">art</span><span class="o">.</span><span class="n">as_csv</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
        <span class="n">header</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="n">articles</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">usage</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;scholar.py [options] &lt;query string&gt;</span>
<span class="s2">A command-line interface to Google Scholar.</span>

<span class="s2">Example: scholar.py -c 1 --txt --author einstein quantum&quot;&quot;&quot;</span>

    <span class="n">fmt</span> <span class="o">=</span> <span class="n">optparse</span><span class="o">.</span><span class="n">IndentedHelpFormatter</span><span class="p">(</span><span class="n">max_help_position</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">optparse</span><span class="o">.</span><span class="n">OptionParser</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="n">usage</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-a&#39;</span><span class="p">,</span> <span class="s1">&#39;--author&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Author name&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;--csv&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Print article data in CSV form (separator is &quot;|&quot;)&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;--csv-header&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Like --csv, but print header with column names&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;--txt&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Print article data in text format&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;--cite&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Cite article&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-c&#39;</span><span class="p">,</span> <span class="s1">&#39;--count&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Maximum number of results&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">options</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="c1"># Show help if we have neither keyword search nor author name</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">options</span><span class="o">.</span><span class="n">author</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">print_help</span><span class="p">()</span>
        <span class="k">return</span> <span class="mi">1</span>

    <span class="n">query</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">csv</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">csv</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">author</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">options</span><span class="o">.</span><span class="n">csv_header</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">csv</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">author</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">count</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">options</span><span class="o">.</span><span class="n">txt</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">txt</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">author</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">options</span><span class="o">.</span><span class="n">cite</span><span class="p">:</span>
        <span class="n">cite</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">cite</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">cite</span><span class="p">:</span>
        <span class="n">cite</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">cite</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="mi">0</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</pre></div>
</td></tr></table>

<p>So now, we are able to get&nbsp;this:</p>
<div class="highlight"><pre><span></span><span class="s s-Atom">macuyiko$</span> <span class="s s-Atom">python</span> <span class="s s-Atom">scholar</span><span class="p">.</span><span class="s s-Atom">py</span> <span class="o">-</span><span class="s s-Atom">c</span> <span class="mi">1</span> <span class="s s-Atom">--cite</span> <span class="mi">1</span> <span class="s s-Atom">--author</span> <span class="s2">&quot;vanden broucke&quot;</span> <span class="s s-Atom">--txt</span> <span class="s2">&quot;artificial&quot;</span> <span class="s s-Atom">&amp;&amp;</span> <span class="s s-Atom">cat</span> <span class="s s-Atom">end</span><span class="p">.</span><span class="s s-Atom">enw</span>
<span class="s s-Atom">------------</span><span class="nv">Article</span> <span class="s s-Atom">#</span><span class="mi">1</span><span class="p">:-</span><span class="s s-Atom">-----------</span>
            <span class="nv">ID</span> <span class="nv">PktWS3Llix8J</span>
         <span class="nv">Title</span> <span class="nv">Improved</span> <span class="s s-Atom">artificial</span> <span class="s s-Atom">negative</span> <span class="s s-Atom">event</span> <span class="s s-Atom">generation</span> <span class="s s-Atom">to</span> <span class="s s-Atom">enhance</span> <span class="s s-Atom">process</span> <span class="s s-Atom">event</span> <span class="s s-Atom">logs</span>
           <span class="nv">URL</span> <span class="nn">http</span><span class="p">:</span><span class="o">//</span><span class="s s-Atom">link</span><span class="p">.</span><span class="s s-Atom">springer</span><span class="p">.</span><span class="s s-Atom">com</span><span class="o">/</span><span class="s s-Atom">chapter</span><span class="o">/</span><span class="mf">10.1007</span><span class="o">/</span><span class="mi">978</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="mi">642</span><span class="o">-</span><span class="mi">31095</span><span class="o">-</span><span class="mi">9</span><span class="k">_</span><span class="mi">17</span>
     <span class="nv">Citations</span> <span class="mi">4</span>
      <span class="nv">Versions</span> <span class="mi">5</span>
<span class="nv">Citations</span> <span class="s s-Atom">list</span> <span class="nn">http</span><span class="p">:</span><span class="o">//</span><span class="s s-Atom">scholar</span><span class="p">.</span><span class="s s-Atom">google</span><span class="p">.</span><span class="s s-Atom">com</span><span class="o">/</span><span class="s s-Atom">scholar?cites</span><span class="o">=</span><span class="mi">2273162715991526206</span><span class="s s-Atom">&amp;as_sdt</span><span class="o">=</span><span class="mi">2005</span><span class="s s-Atom">&amp;sciodt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="s s-Atom">&amp;hl</span><span class="o">=</span><span class="s s-Atom">en&amp;num</span><span class="o">=</span><span class="mi">1</span>
 <span class="nv">Versions</span> <span class="s s-Atom">list</span> <span class="nn">http</span><span class="p">:</span><span class="o">//</span><span class="s s-Atom">scholar</span><span class="p">.</span><span class="s s-Atom">google</span><span class="p">.</span><span class="s s-Atom">com</span><span class="o">/</span><span class="s s-Atom">scholar?cluster</span><span class="o">=</span><span class="mi">2273162715991526206</span><span class="s s-Atom">&amp;hl</span><span class="o">=</span><span class="s s-Atom">en&amp;num</span><span class="o">=</span><span class="mi">1</span><span class="s s-Atom">&amp;as_sdt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span>
      <span class="nv">Cite</span> <span class="nv">URL</span> <span class="nn">http</span><span class="p">:</span><span class="o">//</span><span class="s s-Atom">scholar</span><span class="p">.</span><span class="s s-Atom">google</span><span class="p">.</span><span class="s s-Atom">com</span><span class="o">/</span><span class="s s-Atom">scholar?q</span><span class="o">=</span><span class="nn">info</span><span class="p">:</span><span class="nv">PktWS3Llix8J</span><span class="s s-Atom">:scholar</span><span class="p">.</span><span class="s s-Atom">google</span><span class="p">.</span><span class="s s-Atom">com/&amp;output</span><span class="o">=</span><span class="s s-Atom">cite&amp;scirp</span><span class="o">=</span><span class="mi">0</span><span class="s s-Atom">&amp;hl</span><span class="o">=</span><span class="s s-Atom">en</span>
  <span class="nv">Related</span> <span class="s s-Atom">list</span> <span class="nn">http</span><span class="p">:</span><span class="o">//</span><span class="s s-Atom">scholar</span><span class="p">.</span><span class="s s-Atom">google</span><span class="p">.</span><span class="s s-Atom">com</span><span class="o">/</span><span class="s s-Atom">scholar?q</span><span class="o">=</span><span class="nn">related</span><span class="p">:</span><span class="nv">PktWS3Llix8J</span><span class="s s-Atom">:scholar</span><span class="p">.</span><span class="s s-Atom">google</span><span class="p">.</span><span class="s s-Atom">com/&amp;hl</span><span class="o">=</span><span class="s s-Atom">en&amp;num</span><span class="o">=</span><span class="mi">1</span><span class="s s-Atom">&amp;as_sdt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span>
          <span class="nv">Year</span> <span class="mi">2012</span>

<span class="c1">%0 Conference Proceedings</span>
<span class="c1">%T Improved artificial negative event generation to enhance process event logs</span>
<span class="c1">%A vanden Broucke, Seppe KLM</span>
<span class="c1">%A De Weerdt, Jochen</span>
<span class="c1">%A Baesens, Bart</span>
<span class="c1">%A Vanthienen, Jan</span>
<span class="c1">%B Advanced Information Systems Engineering</span>
<span class="c1">%P 254-269</span>
<span class="c1">%@ 364231094X</span>
<span class="c1">%D 2012</span>
<span class="c1">%I Springer</span>
</pre></div>


<h2>Hours 6-11: Wasting Time with Google&#8217;s&nbsp;Appengine</h2>
<p>Almost done. The final part which remains is to automate iterating through the plain references list, finding a way to extract a good search query for each entry, and getting out the Endnote (or BibTeX from Google&nbsp;Scholar).</p>
<p>In an impulse, I decided to try to whip up a Google Appengine page to provide this great service to the world. After creating a basic <code>index.html</code> with some jQuery on top off it I created a quick <code>Flask</code> app with the &#8220;magic&#8221; part looking something like this (disclaimer: not really that&nbsp;magical):</p>
<div class="highlight"><pre><span></span>@<span class="nv">app</span>.<span class="nv">route</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">/guess</span><span class="s1">&#39;</span>, <span class="nv">methods</span><span class="o">=</span>[<span class="s1">&#39;</span><span class="s">POST</span><span class="s1">&#39;</span>]<span class="ss">)</span>
<span class="nv">def</span> <span class="nv">guess</span><span class="ss">()</span>:
    <span class="nv">f</span> <span class="o">=</span> <span class="nv">string</span>.<span class="nv">ascii_lowercase</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="s"> </span><span class="s1">&#39;</span>
    <span class="nv">q</span> <span class="o">=</span> <span class="nv">request</span>.<span class="nv">form</span>[<span class="s1">&#39;</span><span class="s">t</span><span class="s1">&#39;</span>]
    <span class="nv">q</span> <span class="o">=</span> <span class="nv">q</span>.<span class="nv">lower</span><span class="ss">()</span>
    <span class="nv">q</span> <span class="o">=</span> <span class="nv">q</span>.<span class="nv">replace</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">-</span><span class="s1">&#39;</span>, <span class="s1">&#39;</span><span class="s"> </span><span class="s1">&#39;</span><span class="ss">)</span>
    <span class="nv">q</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>.<span class="nv">join</span><span class="ss">(</span><span class="nv">c</span> <span class="k">for</span> <span class="nv">c</span> <span class="nv">in</span> <span class="nv">q</span> <span class="k">if</span> <span class="nv">c</span> <span class="nv">in</span> <span class="nv">f</span><span class="ss">)</span>
    <span class="nv">q</span> <span class="o">=</span> <span class="nv">q</span>.<span class="nv">split</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s"> </span><span class="s1">&#39;</span><span class="ss">)</span>
    <span class="nv">q</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s"> </span><span class="s1">&#39;</span>.<span class="nv">join</span><span class="ss">(</span><span class="nv">c</span> <span class="k">for</span> <span class="nv">c</span> <span class="nv">in</span> <span class="nv">q</span> <span class="k">if</span> <span class="nv">len</span><span class="ss">(</span><span class="nv">c</span><span class="ss">)</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="ss">)</span>
    # <span class="nv">Use</span> <span class="nv">q</span> <span class="nv">as</span> <span class="nv">the</span> <span class="nv">Google</span> <span class="nv">Scholar</span> <span class="nv">search</span> <span class="nv">query</span>
</pre></div>


<p>Really simple: convert to lowercase, leave only text and spaces, filter out all words smaller then three characters. This approached seemed to work well in initial&nbsp;tests.</p>
<p>What didn&#8217;t work well, however, was getting <code>scholar.py</code> to work on Google Appengine. The library works fine, but Google Scholar is very picky towards handling requests coming from Google Appengine, due to reasons which are actually pretty&nbsp;obvious.</p>
<h2>Hour 12: Let&#8217;s Just Finish&nbsp;This</h2>
<p>After contemplating whether I should host this on my own server, I just decided to move on and built a quick and dirty script to do the work, as the likelihood of me getting popular/rich/famous/insert-attribute-here by a service like this one is small anyway, especially since Google&#8217;s banhammer would strike&nbsp;quickly.</p>
<p>So the final &#8220;convertor&#8221; script looks like&nbsp;this:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">import</span> <span class="nn">scholar</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">codecs</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">references</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Bang-Jensen, J., &amp; Gutin, G. (2010) Diagraphs: theory, algorithms and applications. Springer-Verlag.</span>
<span class="s2">Chandy, K., &amp; Schulte, W. (2010) Event Processing - Designing IT Systems for Agile Companies, McGraw-Hill.</span>
<span class="s2">&lt;OTHER REFERENCES&gt;&quot;&quot;&quot;</span>

<span class="k">def</span> <span class="nf">make_query</span><span class="p">(</span><span class="n">reference</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">3</span><span class="p">):</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">reference</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="n">q</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">q</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">f</span><span class="p">)</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="n">q</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">q</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">l</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">q</span>

<span class="k">def</span> <span class="nf">make_query_year</span><span class="p">(</span><span class="n">reference</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">3</span><span class="p">):</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">reference</span>
    <span class="n">id_re</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(\d\d\d\d)&#39;</span><span class="p">)</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">id_re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
    <span class="n">year</span> <span class="o">=</span> <span class="nb">id</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;(&#39;</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">q</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="n">q</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">q</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">f</span><span class="p">)</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="n">q</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">q</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">l</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">year</span> <span class="o">!=</span> <span class="s1">&#39;(&#39;</span><span class="p">:</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">year</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">q</span>
    <span class="k">return</span> <span class="n">q</span>

<span class="n">myFile</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;bibliography.bib&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">reference</span> <span class="ow">in</span> <span class="n">references</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">):</span>
    <span class="n">reference</span> <span class="o">=</span> <span class="n">reference</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">print</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">---------------------------------------------------------&quot;</span>
    <span class="k">print</span> <span class="s2">&quot;Doing reference:&quot;</span><span class="p">,</span> <span class="n">reference</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>

    <span class="n">q</span> <span class="o">=</span> <span class="n">make_query</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>
    <span class="k">print</span> <span class="s2">&quot;Query used:&quot;</span><span class="p">,</span> <span class="n">q</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">scholar</span><span class="o">.</span><span class="n">articles</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">make_query_year</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>
        <span class="k">print</span> <span class="s2">&quot;Trying again with:&quot;</span><span class="p">,</span> <span class="n">q</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">scholar</span><span class="o">.</span><span class="n">articles</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">print</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">as_txt</span><span class="p">(),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">querier</span> <span class="o">=</span> <span class="n">scholar</span><span class="o">.</span><span class="n">CiteQuerier</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
    <span class="n">req</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">querier</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">export</span><span class="p">[</span><span class="s1">&#39;BibTeX&#39;</span><span class="p">],</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">querier</span><span class="o">.</span><span class="n">USER_AGENT</span><span class="p">},</span> <span class="n">cookies</span><span class="o">=</span><span class="n">scholar</span><span class="o">.</span><span class="n">CookieJar</span><span class="o">.</span><span class="n">COOKIE_JAR</span><span class="p">)</span>
    <span class="n">myFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="si">%%</span><span class="s1">% &#39;</span><span class="o">+</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;  &#39;</span><span class="o">+</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">myFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

<span class="n">myFile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>


<p>Note that I had to include two querying strategies: <code>make_query</code> and <code>make_query_year</code>. The latter combines the year with the title but leaves out authors, this is to retrieve some problematic articles where the author name was formatted differently in Google Scholar than in my list. A hacky approach which could be improved, but it gets the point&nbsp;across.</p>
<p>Anyway, running this script returns a BibTeX list like&nbsp;this:</p>
<div class="highlight"><pre><span></span><span class="nv">macuyiko</span>$ <span class="nv">cat</span> .<span class="o">/</span><span class="nv">bibliography</span>.<span class="nv">bib</span>

<span class="o">%%%</span> <span class="nv">mr4JHn2auF8J</span>  <span class="nv">Theory</span>, <span class="nv">algorithms</span> <span class="nv">and</span> <span class="nv">applications</span>
@<span class="nv">article</span>{<span class="nv">bang2007theory</span>,
  <span class="nv">title</span><span class="o">=</span>{<span class="nv">Theory</span>, <span class="nv">algorithms</span> <span class="nv">and</span> <span class="nv">applications</span>},
  <span class="nv">author</span><span class="o">=</span>{<span class="nv">Bang</span><span class="o">-</span><span class="nv">Jensen</span>, <span class="nv">J</span>{\<span class="nv">o</span>}<span class="nv">rgen</span> <span class="nv">and</span> <span class="nv">Gutin</span>, <span class="nv">Gregory</span>},
  <span class="nv">journal</span><span class="o">=</span>{<span class="nv">Springer</span> <span class="nv">Monographs</span> <span class="nv">in</span> <span class="nv">Mathematics</span>, <span class="nv">Springer</span><span class="o">-</span><span class="nv">Verlag</span> <span class="nv">London</span> <span class="nv">Ltd</span>., <span class="nv">London</span>},
  <span class="nv">year</span><span class="o">=</span>{<span class="mi">2007</span>},
  <span class="nv">publisher</span><span class="o">=</span>{<span class="nv">Springer</span>}
}

<span class="o">%%%</span> <span class="nv">Odfz1prcWxEJ</span>  <span class="nv">Event</span> <span class="nv">Processing</span>: <span class="nv">Designing</span> <span class="nv">IT</span> <span class="nv">Systems</span> <span class="k">for</span> <span class="nv">Agile</span> <span class="nv">Companies</span>
@<span class="nv">book</span>{<span class="nv">chandy2009event</span>,
  <span class="nv">title</span><span class="o">=</span>{<span class="nv">Event</span> <span class="nv">Processing</span>: <span class="nv">Designing</span> <span class="nv">IT</span> <span class="nv">Systems</span> <span class="k">for</span> <span class="nv">Agile</span> <span class="nv">Companies</span>},
  <span class="nv">author</span><span class="o">=</span>{<span class="nv">Chandy</span>, <span class="nv">K</span> <span class="nv">and</span> <span class="nv">Schulte</span>, <span class="nv">W</span>},
  <span class="nv">year</span><span class="o">=</span>{<span class="mi">2009</span>},
  <span class="nv">publisher</span><span class="o">=</span>{<span class="nv">McGraw</span><span class="o">-</span><span class="nv">Hill</span>, <span class="nv">Inc</span>.}
}
</pre></div>


<p>Which is sufficient to import in a reference manager and edit/correct the remaining issues without much&nbsp;hassle.</p>
<h2>By the&nbsp;Way&#8230;</h2>
<p>I realize I might be an idiot and there might exist some free or expensive reference management software providing this functionality already. If you know about such magnificent tool, feel free to point this out in the comments or <a href="http://www.twitter.com/macuyiko">on Twitter</a> (both the software name, not the fact that I&#8217;m an idiot,&nbsp;please).</p>
<p>Anyway, I hope this proves to be useful to anyone encountering the same problem. Also, fellow researchers, can we agree on the fact that the functionality offered by reference management software and scholarly websites is still pretty much utter crap? We live in the future, this should not be painful&nbsp;anymore.</p>
	</article>
</div>
		
	</div>

	<footer class="row">
		<div class="large-12 columns">
			<hr />
			<div class="row">
				<p>Bed Against The Wall by Seppe "Macuyiko" vanden Broucke<br>
				Unless mentioned otherwise, this work is licensed under a <a href="http://creativecommons.org/licenses/by-sa/2.0/be/" rel="license">Creative Commons Attribution-Share Alike 2.0 Belgium License</a>.<br>
				Static blog engine powered by <a href="http://getpelican.com">Pelican</a>.</p>
			</div>
		</div>
	</footer>
</div>
 